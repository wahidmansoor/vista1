{"version":3,"file":"module-opd-0xQ-JYRh.js","sources":["../../src/components/ui/tooltip.tsx","../../src/components/ui/toast.tsx","../../src/components/ui/toaster.tsx","../../src/modules/opd/cards/EvaluationCard.tsx","../../src/modules/opd/cards/PathwayCard.tsx","../../src/modules/opd/cards/ScreeningCard.tsx","../../src/modules/opd/cards/ReferralCard.tsx","../../src/modules/opd/cards/FollowUpCard.tsx","../../src/modules/opd/components/AISummary.tsx","../../src/modules/opd/patient-evaluation/PatientEvaluation.tsx","../../src/data/cancer-pathways/breast.ts","../../src/data/cancer-pathways/prostate.ts","../../src/data/cancer-pathways/lung.ts","../../src/data/cancer-pathways/ovarian.ts","../../src/data/cancer-pathways/gastric.ts","../../src/data/cancer-pathways/head-neck.ts","../../src/data/cancer-pathways/pancreatic.ts","../../src/data/cancer-pathways/bladder.ts","../../src/data/cancer-pathways/index.ts","../../src/modules/opd/components/RedFlagAlert.tsx","../../src/modules/opd/components/PathwaySummaryCard.tsx","../../src/modules/opd/diagnostic-pathways/DecisionTree.tsx","../../src/modules/opd/diagnostic-pathways/DiagnosticPathways.tsx","../../src/lib/gemini.ts","../../src/lib/api/aiAgentAPI.ts","../../src/modules/opd/cancer-screening/CancerScreening.tsx","../../src/modules/opd/referral-guidelines/ReferralCard.tsx","../../src/modules/opd/referral-guidelines/ReferralForm.tsx","../../src/modules/opd/referral-guidelines/TriageResult.tsx","../../src/modules/opd/referral-guidelines/data/referralTemplates.ts","../../src/modules/opd/referral-guidelines/logic/triageEngine.ts","../../src/modules/opd/referral-guidelines/ReferralGuidelines.tsx","../../src/modules/opd/follow-up-oncology/components/CancerSelector.tsx","../../src/modules/opd/follow-up-oncology/components/DiagnosticTimeline.tsx","../../src/modules/opd/follow-up-oncology/components/PerformanceScoreChart.tsx","../../src/modules/opd/follow-up-oncology/components/SmartFollowUpSummary.tsx","../../src/modules/opd/follow-up-oncology/data/followUpData.ts","../../src/modules/opd/follow-up-oncology/data/followUpTemplates.ts","../../src/modules/opd/follow-up-oncology/utils/templateValidation.ts","../../src/modules/opd/follow-up-oncology/logic/generateFollowUpPlan.ts","../../src/services/aiAssistant.ts","../../src/modules/opd/follow-up-oncology/components/AIFollowUpAssistant.tsx","../../src/modules/opd/follow-up-oncology/FollowUpOncology.tsx","../../src/modules/opd/components/OPDModule.tsx","../../src/modules/opd/layout/OPDLayout.tsx","../../src/modules/opd/components/EvaluationSummary.tsx","../../src/modules/opd/data/evaluationTemplates.ts","../../src/modules/opd/components/FormField.tsx","../../src/modules/opd/components/Button.tsx","../../src/modules/opd/context/EvaluationContext.tsx","../../src/services/patientEvaluationService.ts","../../src/modules/opd/components/ProgressStepper.tsx","../../src/modules/opd/components/AISidebar.tsx","../../src/modules/opd/components/staging/TNMStaging.tsx","../../src/modules/opd/components/staging/ECOGSelector.tsx","../../src/modules/opd/components/staging/KarnofskySlider.tsx","../../src/modules/opd/patient-evaluation/PatientEvaluationForm.tsx","../../src/modules/opd/OPD.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst TooltipProvider = TooltipPrimitive.Provider\r\nconst Tooltip = TooltipPrimitive.Root\r\nconst TooltipTrigger = TooltipPrimitive.Trigger\r\n\r\nconst TooltipContent = React.forwardRef<\r\n  React.ElementRef<typeof TooltipPrimitive.Content>,\r\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\r\n>(({ className, sideOffset = 4, ...props }, ref) => (\r\n  <TooltipPrimitive.Content\r\n    ref={ref}\r\n    sideOffset={sideOffset}\r\n    className={cn(\r\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\r\n\r\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\r\n","import * as React from \"react\"\r\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\nimport { X } from \"lucide-react\"\r\n\r\nconst ToastProvider = ToastPrimitives.Provider\r\n\r\nconst ToastViewport = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\r\n>(({ className, ...props }, ref) => (\r\n  <ToastPrimitives.Viewport\r\n    ref={ref}\r\n    className=\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\"\r\n    {...props}\r\n  />\r\n))\r\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\r\n\r\nconst toastVariants = cva(\r\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"border bg-background\",\r\n        destructive:\r\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Toast = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Root>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\r\n    VariantProps<typeof toastVariants>\r\n>(({ className, variant, ...props }, ref) => {\r\n  return (\r\n    <ToastPrimitives.Root\r\n      ref={ref}\r\n      className={toastVariants({ variant })}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nToast.displayName = ToastPrimitives.Root.displayName\r\n\r\nconst ToastAction = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Action>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\r\n>(({ className, ...props }, ref) => (\r\n  <ToastPrimitives.Action\r\n    ref={ref}\r\n    className=\"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\"\r\n    {...props}\r\n  />\r\n))\r\nToastAction.displayName = ToastPrimitives.Action.displayName\r\n\r\nconst ToastClose = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Close>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\r\n>(({ className, ...props }, ref) => (\r\n  <ToastPrimitives.Close\r\n    ref={ref}\r\n    className=\"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\"\r\n    toast-close=\"\"\r\n    {...props}\r\n  >\r\n    <X className=\"h-4 w-4\" />\r\n  </ToastPrimitives.Close>\r\n))\r\nToastClose.displayName = ToastPrimitives.Close.displayName\r\n\r\nconst ToastTitle = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Title>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\r\n>(({ className, ...props }, ref) => (\r\n  <ToastPrimitives.Title\r\n    ref={ref}\r\n    className=\"text-sm font-semibold\"\r\n    {...props}\r\n  />\r\n))\r\nToastTitle.displayName = ToastPrimitives.Title.displayName\r\n\r\nconst ToastDescription = React.forwardRef<\r\n  React.ElementRef<typeof ToastPrimitives.Description>,\r\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\r\n>(({ className, ...props }, ref) => (\r\n  <ToastPrimitives.Description\r\n    ref={ref}\r\n    className=\"text-sm opacity-90\"\r\n    {...props}\r\n  />\r\n))\r\nToastDescription.displayName = ToastPrimitives.Description.displayName\r\n\r\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\r\n\r\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\r\n\r\nexport {\r\n  type ToastProps,\r\n  type ToastActionElement,\r\n  ToastProvider,\r\n  ToastViewport,\r\n  Toast,\r\n  ToastTitle,\r\n  ToastDescription,\r\n  ToastClose,\r\n  ToastAction,\r\n}\r\n","import {\r\n  Toast,\r\n  ToastClose,\r\n  ToastDescription,\r\n  ToastProvider,\r\n  ToastTitle,\r\n  ToastViewport,\r\n} from \"@/components/ui/toast\"\r\nimport { useToast } from \"@/components/ui/use-toast\"\r\n\r\nexport function Toaster() {\r\n  const { toasts } = useToast()\r\n\r\n  return (\r\n    <ToastProvider>\r\n      {toasts.map(function ({ id, title, description, action, ...props }) {\r\n        return (\r\n          <Toast key={id} {...props}>\r\n            <div className=\"grid gap-1\">\r\n              {title && <ToastTitle>{title}</ToastTitle>}\r\n              {description && (\r\n                <ToastDescription>{description}</ToastDescription>\r\n              )}\r\n            </div>\r\n            {action}\r\n            <ToastClose />\r\n          </Toast>\r\n        )\r\n      })}\r\n      <ToastViewport />\r\n    </ToastProvider>\r\n  )\r\n}","import React from 'react';\r\n\r\ninterface EvaluationCardProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst EvaluationCard: React.FC<EvaluationCardProps> = ({ children }) => {\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg\">\r\n      <div className=\"p-6\">\r\n        <div className=\"space-y-6\">\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EvaluationCard;\r\n","import React from 'react';\r\n\r\nconst PathwayCard: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PathwayCard;\r\n","import React from 'react';\r\n\r\ninterface ScreeningCardProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst ScreeningCard: React.FC<ScreeningCardProps> = ({ children }) => {\r\n  return (\r\n    <div className=\"opd-card\">\r\n      <div className=\"opd-card-content\">\r\n        <div className=\"space-y-6\">\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScreeningCard;\r\n","import React from 'react';\r\n\r\nconst ReferralCard: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReferralCard;\r\n","import React from 'react';\r\n\r\nconst FollowUpCard: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FollowUpCard;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { AlertCircle, Check, Loader2 } from 'lucide-react';\r\n\r\ninterface AISummaryProps {\r\n  patientData?: Record<string, any>;\r\n  isEnabled?: boolean;\r\n}\r\n\r\nconst AISummary: React.FC<AISummaryProps> = ({ \r\n  patientData,\r\n  isEnabled = process.env.NODE_ENV === 'production' \r\n}) => {\r\n  const [summaryState, setSummaryState] = useState<'loading' | 'generated' | 'error' | 'disabled'>('loading');\r\n  const [summary, setSummary] = useState<string | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!isEnabled) {\r\n      setSummaryState('disabled');\r\n      return;\r\n    }\r\n\r\n    if (!patientData) {\r\n      setSummaryState('disabled');\r\n      setSummary('No patient data available to generate a summary.');\r\n      return;\r\n    }\r\n\r\n    // Simulating an API call for the AI summary\r\n    const generateSummary = async () => {\r\n      try {\r\n        setSummaryState('loading');\r\n        \r\n        // In real implementation, this would be an API call\r\n        // await fetch('/api/generate-summary', { ... })\r\n        \r\n        // Simulating API delay\r\n        await new Promise(resolve => setTimeout(resolve, 1500));\r\n        \r\n        // Mock summary generation based on available data\r\n        const mockSummary = generateMockSummary(patientData);\r\n        \r\n        setSummary(mockSummary);\r\n        setSummaryState('generated');\r\n      } catch (err) {\r\n        console.error('Failed to generate AI summary:', err);\r\n        setError('Failed to generate summary. Please try again later.');\r\n        setSummaryState('error');\r\n      }\r\n    };\r\n\r\n    generateSummary();\r\n  }, [patientData, isEnabled]);\r\n\r\n  // Function to generate a mock summary based on patient data\r\n  const generateMockSummary = (data: Record<string, any>): string => {\r\n    // This would be replaced by actual AI-generated content\r\n    return `This 58-year-old patient presents with symptoms suggestive of possible oncological condition. Based on the available data, recommend further investigation including appropriate imaging and possibly tissue diagnosis. Consider referral to specialized oncology service for comprehensive evaluation.`;\r\n  };\r\n\r\n  if (summaryState === 'disabled' && !summary) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200\">\r\n      <div className=\"flex items-center space-x-3 mb-4\">\r\n        <svg\r\n          className=\"w-6 h-6 text-blue-500\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\"\r\n          />\r\n        </svg>\r\n        <h3 className=\"text-lg font-semibold text-blue-800\">AI Summary</h3>\r\n      </div>\r\n      \r\n      {summaryState === 'loading' && (\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center text-blue-600\">\r\n            <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\r\n            <span>Generating clinical summary...</span>\r\n          </div>\r\n          <div className=\"h-4 bg-blue-100 rounded animate-pulse\"></div>\r\n          <div className=\"h-4 bg-blue-100 rounded animate-pulse w-5/6\"></div>\r\n          <div className=\"h-4 bg-blue-100 rounded animate-pulse w-4/6\"></div>\r\n        </div>\r\n      )}\r\n\r\n      {summaryState === 'generated' && summary && (\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center text-green-600 mb-2\">\r\n            <Check className=\"w-5 h-5 mr-2\" />\r\n            <span>Summary generated</span>\r\n          </div>\r\n          <p className=\"text-gray-700\">{summary}</p>\r\n        </div>\r\n      )}\r\n\r\n      {summaryState === 'error' && (\r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex items-center text-red-600\">\r\n            <AlertCircle className=\"w-5 h-5 mr-2\" />\r\n            <span>{error || 'Failed to generate summary'}</span>\r\n          </div>\r\n          <button \r\n            className=\"text-sm bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 mt-2\"\r\n            onClick={() => {\r\n              if (patientData) {\r\n                setSummaryState('loading');\r\n                // In real implementation, retry logic would go here\r\n                setTimeout(() => {\r\n                  setSummary(generateMockSummary(patientData));\r\n                  setSummaryState('generated');\r\n                }, 1500);\r\n              }\r\n            }}\r\n          >\r\n            Try Again\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {summaryState === 'disabled' && summary && (\r\n        <div className=\"text-sm text-gray-500\">\r\n          {summary}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AISummary; ","import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst PatientEvaluation: React.FC = () => {\r\n  const navigate = useNavigate();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h2 className=\"text-2xl font-bold text-indigo-800\">ðŸŽ¯ Patient Evaluation Overview</h2>\r\n      <p className=\"text-gray-700 max-w-3xl\">\r\n        This module guides oncologists through a complete and structured patient evaluation during outpatient visits. It is not an EHR but a clinical decision support tool meant to ensure no critical detail is missed during your assessment.\r\n      </p>\r\n\r\n      <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-100 space-y-4\">\r\n        <h2 className=\"text-xl font-semibold text-gray-800\">Key Features</h2>\r\n        <ul className=\"list-disc list-inside text-gray-700 space-y-1\">\r\n          <li>Structured History Taking: CC, HOPC, PMH, Family & Social History</li>\r\n          <li>Oncology-Focused Physical Examination & Red Flags</li>\r\n          <li>Initial Diagnostic Planning and Performance Status</li>\r\n          <li>Non-EHR format with clinical flexibility</li>\r\n        </ul>\r\n\r\n        <div className=\"pt-4\">\r\n          <button\r\n            onClick={() => navigate('/opd/patient-evaluation-form')}\r\n            className=\"bg-indigo-600 hover:bg-indigo-700 text-white text-sm px-5 py-2 rounded-md shadow\"\r\n          >\r\n            ðŸš€ Start Patient Evaluation\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientEvaluation;\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const breastCancerPathway: StepBasedPathway = {\r\n  id: \"breast\",\r\n  name: \"Breast Cancer Diagnostic Pathway\",\r\n  description: \"Systematic approach to breast cancer diagnosis and staging, aligned with NCCN 2024 and ASCO guidelines.\",\r\n  recommendedTimeframe: \"1-2 weeks for diagnosis, 2-4 weeks for full staging and treatment plan\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Presentation & Clinical Assessment\",\r\n      description: \"Patient presents with breast symptoms (e.g., lump, skin changes, nipple discharge) or abnormal screening mammogram. Detailed history (including risk factors like family history, prior breast conditions, hormonal exposures, genetic predisposition) and clinical breast exam (CBE).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN BC-1 2024, ASCO Guideline on Breast Cancer Diagnosis 2021\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain the importance of evaluating symptoms/findings. Discuss the next steps, likely diagnostic imaging. Address anxiety and provide reassurance. Offer information on risk factors.\",\r\n      pitfalls: [\"Dismissing patient concerns, especially in younger women or those with dense breasts.\", \"Incomplete CBE or inadequate documentation.\", \"Delay in scheduling diagnostic imaging for suspicious findings (BI-RADS 0 on screening, palpable mass).\"],\r\n      options: [\r\n        {\r\n          text: \"Abnormal screening mammogram (e.g., BI-RADS 0, or new BI-RADS 3, 4, 5 finding)\",\r\n          next: \"diagnostic_imaging_mammogram_callback\"\r\n        },\r\n        {\r\n          text: \"Palpable mass, focal persistent pain, suspicious nipple discharge (bloody, unilateral, spontaneous), skin changes (dimpling, erythema, peau d'orange), or axillary adenopathy\",\r\n          next: \"diagnostic_imaging_symptomatic\",\r\n          triggers: [\"suspicious_clinical_finding\"]\r\n        },\r\n        {\r\n          text: \"Non-suspicious symptoms (e.g., cyclical bilateral pain, non-bloody bilateral discharge), no palpable mass, normal screening history\",\r\n          next: \"risk_assessment_reassurance_low_suspicion\"\r\n        },\r\n        {\r\n          text: \"High risk patient (e.g. known BRCA mutation, strong family history, prior chest RT) for screening/surveillance\",\r\n          next: \"high_risk_surveillance_protocol\" // May involve MRI\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"suspicious_clinical_finding\",\r\n          condition: \"Palpable dominant hard mass, peau d'orange, skin ulceration, nipple retraction/inversion (new), fixed axillary nodes, or signs of inflammatory breast cancer (diffuse erythema, edema, warmth).\",\r\n          message: \"High suspicion for locally advanced or inflammatory breast cancer. Requires urgent evaluation.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent diagnostic mammogram (if >30 yrs) and targeted ultrasound within 24-72 hours.\",\r\n            \"Consider early surgical/breast oncology consultation (same day or next day).\",\r\n            \"Document detailed findings, including size, location, and characteristics of mass and any skin/nodal changes.\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Urgent Imaging & Specialist Consultation\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"diagnostic_imaging_mammogram_callback\", // For screening callbacks\r\n      title: \"Diagnostic Mammography & Ultrasound (Screening Callback)\",\r\n      description: \"Perform diagnostic mammography (additional views, magnification, tomosynthesis as needed) and targeted breast ultrasound for any abnormality seen on screening mammogram. Correlate with prior imaging.\",\r\n      expectedDuration: \"1-3 days\",\r\n      tooltip: \"Resolve screening findings. Assign final BI-RADS category.\",\r\n      guidelineSource: \"ACR Practice Parameter for Breast Imaging 2023, NCCN BC-2 2024\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain that additional views are common after screening. Describe procedures. Discuss BI-RADS outcome.\",\r\n      pitfalls: [\"Not performing ultrasound for all relevant mammographic findings.\", \"Inadequate views leading to missed lesions.\"],\r\n      options: [\r\n        {\r\n          text: \"BI-RADS 4 or 5 (Suspicious or Highly Suspicious)\",\r\n          next: \"image_guided_biopsy\",\r\n          triggers: [\"high_birads_finding\"]\r\n        },\r\n        {\r\n          text: \"BI-RADS 3 (Probably Benign) - typically short-interval (6-month) follow-up or biopsy based on risk/patient/radiologist preference\",\r\n          next: \"birads3_management_protocol\"\r\n        },\r\n        {\r\n          text: \"BI-RADS 1 or 2 (Negative or Benign) - resolved screening finding\",\r\n          next: \"return_to_routine_screening\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"high_birads_finding\",\r\n          condition: \"BI-RADS 4 or 5 lesion identified on diagnostic workup.\",\r\n          message: \"High suspicion for malignancy. Tissue diagnosis is required promptly.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Schedule image-guided core needle biopsy (CNB) within 3-5 business days.\",\r\n            \"Clearly communicate need for biopsy to patient and referring physician.\",\r\n            \"Determine optimal biopsy modality (ultrasound-guided preferred if visible, stereotactic for calcs, MRI-guided if only seen on MRI).\"\r\n          ],\r\n          urgency: \"Routine\", // For biopsy scheduling\r\n          actionType: \"Biopsy Scheduling & Communication\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"diagnostic_imaging_symptomatic\", // For symptomatic patients\r\n      title: \"Diagnostic Mammography & Ultrasound (Symptomatic Patient)\",\r\n      description: \"For palpable mass or other symptoms: if age >40, diagnostic mammogram and targeted ultrasound. If age 30-39, ultrasound first, then mammogram if suspicious/inconclusive. If <30, ultrasound first, mammogram rarely needed. Breast MRI for specific indications (e.g., occult primary with axillary mets, extent of disease in dense breasts with known cancer).\",\r\n      expectedDuration: \"1-3 days\",\r\n      guidelineSource: \"ACR Appropriateness Criteria 2022, NCCN BC-1 & BC-2 2024\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain imaging based on age/symptoms. Discuss BI-RADS outcome.\",\r\n      pitfalls: [\"Not using ultrasound as primary modality in young women (<30).\", \"Delaying mammography in symptomatic women >30 if ultrasound appears benign but mass persists.\"],\r\n      options: [\r\n        // Same options as diagnostic_imaging_mammogram_callback\r\n        {\r\n          text: \"BI-RADS 4 or 5 (Suspicious or Highly Suspicious)\",\r\n          next: \"image_guided_biopsy\",\r\n          triggers: [\"high_birads_finding\"] // Re-uses red flag from above\r\n        },\r\n        {\r\n          text: \"BI-RADS 3 (Probably Benign)\",\r\n          next: \"birads3_management_protocol\"\r\n        },\r\n        {\r\n          text: \"BI-RADS 1 or 2 (Negative or Benign) but symptoms persist or clinical concern remains\",\r\n          next: \"clinical_radiologic_discordance_review\"\r\n        },\r\n        {\r\n          text: \"BI-RADS 1 or 2 (Negative or Benign), symptoms resolve or concordant benign explanation\",\r\n          next: \"routine_followup_if_indicated\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"image_guided_biopsy\",\r\n      title: \"Image-Guided Core Needle Biopsy (CNB)\",\r\n      description: \"Perform CNB of BI-RADS 4/5 lesion(s) using appropriate imaging guidance. Obtain multiple cores (typically 4-6). Place biopsy marker clip. Send tissue for histology, ER/PR/HER2 (for invasive cancer and DCIS). Ki-67 optional but often done. Consider tissue for genomic assays if invasive cancer likely.\",\r\n      expectedDuration: \"1-3 days (procedure + initial pathology report)\",\r\n      tooltip: \"CNB is standard. Ensure radiologic-pathologic concordance. Document clip placement.\",\r\n      guidelineSource: \"NCCN BC-3 2024, ASCO/CAP ER/PR/HER2 Testing Guidelines 2020/2023\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true, // For radiologic-pathologic concordance review\r\n      patientInfo: \"Explain CNB procedure, purpose (diagnosis), risks (bruising, bleeding, infection, pain, rare pneumothorax for deep lesions), benefits. Obtain informed consent. Post-biopsy care.\",\r\n      pitfalls: [\"Insufficient sample for all required tests (ER/PR/HER2, genomics).\", \"Biopsy of non-representative area or sampling error.\", \"Radiologic-pathologic discordance not identified or addressed.\", \"Marker clip not placed, misplaced, or migrates.\", \"Performing FNA instead of CNB for initial diagnosis of solid mass (FNA insufficient for receptor status or distinguishing in-situ from invasive).\"],\r\n      options: [\r\n        {\r\n          text: \"Malignancy confirmed (Invasive Carcinoma or Ductal Carcinoma In Situ - DCIS)\",\r\n          next: \"post_biopsy_consult_pathology_review\",\r\n          triggers: [\"breast_cancer_diagnosis_biopsy\"]\r\n        },\r\n        {\r\n          text: \"High-risk lesion (e.g., Atypical Ductal Hyperplasia (ADH), Lobular Carcinoma In Situ (LCIS), Flat Epithelial Atypia (FEA), Papilloma with atypia)\",\r\n          next: \"high_risk_lesion_management_discussion\"\r\n        },\r\n        {\r\n          text: \"Benign pathology, concordant with imaging findings\",\r\n          next: \"benign_concordant_pathology_followup\"\r\n        },\r\n        {\r\n          text: \"Pathology discordant with imaging, or insufficient for diagnosis (e.g. atypia of undetermined significance - AUS)\",\r\n          next: \"discordant_insufficient_pathology_review_repeat_biopsy\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"breast_cancer_diagnosis_biopsy\",\r\n          condition: \"Biopsy confirms invasive breast cancer or DCIS.\",\r\n          message: \"Breast cancer diagnosed. Requires prompt communication with patient, staging, and multidisciplinary discussion.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Pathologist to ensure ER/PR/HER2 (with reflex ISH if HER2 IHC 2+) results are processed promptly.\",\r\n            \"Schedule follow-up with surgeon/breast specialist within 1 week to discuss results and plan.\",\r\n            \"Initiate staging workup as indicated by tumor type/size/grade (NCCN BC-4).\",\r\n            \"Refer for genetic counseling if criteria met (NCCN BC-6).\",\r\n            \"Prepare for presentation at multidisciplinary tumor board (MDT).\"\r\n          ],\r\n          urgency: \"Routine\", // For scheduling next steps\r\n          actionType: \"Pathology Processing, Consultation & Staging Initiation\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"post_biopsy_consult_pathology_review\",\r\n      title: \"Post-Biopsy Consultation, Full Pathology Review & Staging\",\r\n      description: \"Consultation to discuss confirmed cancer diagnosis. Review final pathology: histologic type, grade, size (if excisional), ER/PR status, HER2 status (IHC and ISH if done), Ki-67. Clinical staging (TNM) based on exam, imaging, biopsy. Systemic staging (CT C/A/P, bone scan, or PET-CT) for clinical stage IIB (T2N1, T3N0) or higher, or symptomatic patients, or inflammatory BC (NCCN BC-4). Brain MRI if neurological symptoms or specific subtypes (e.g. HER2+, triple negative with high burden).\",\r\n      expectedDuration: \"3-7 days for full pathology and initial staging plan\",\r\n      guidelineSource: \"NCCN BC-4 & BC-5 2024, AJCC 8th Ed. Breast Cancer Staging\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Provide clear explanation of diagnosis, pathology report (ER/PR/HER2 meaning), and cancer stage. Discuss need for further staging tests. Offer emotional support and resources. Discuss MDT process. Genetic counseling referral if indicated.\",\r\n      pitfalls: [\"Incomplete or delayed ER/PR/HER2/Ki-67 results.\", \"Under-staging (missing metastases) or over-staging.\", \"Delay in MDT presentation or specialist consultations.\", \"Not offering genetic counseling according to guidelines (e.g., age <50, triple negative, male breast cancer, specific family history - NCCN BC-6).\"],\r\n      options: [\r\n        {\r\n          text: \"Early stage (Stage I-IIA, selected IIB based on biology) potentially suitable for primary surgery\",\r\n          next: \"mdt_treatment_planning_early_stage_breast\"\r\n        },\r\n        {\r\n          text: \"Locally advanced (some Stage IIB, Stage III) or inflammatory breast cancer - typically requires neoadjuvant therapy\",\r\n          next: \"mdt_treatment_planning_locally_advanced_breast\"\r\n        },\r\n        {\r\n          text: \"Metastatic disease (Stage IV) identified on staging workup\",\r\n          next: \"mdt_treatment_planning_metastatic_breast\",\r\n          triggers: [\"metastatic_breast_cancer_staging\"]\r\n        },\r\n        {\r\n          text: \"DCIS without invasion\",\r\n          next: \"mdt_treatment_planning_dcis\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"metastatic_breast_cancer_staging\",\r\n          condition: \"Metastatic disease (Stage IV) confirmed by staging investigations.\",\r\n          message: \"Stage IV breast cancer. Treatment is primarily systemic with palliative intent for most; some oligometastatic cases may have different approaches. Requires urgent multidisciplinary input.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent medical oncology consultation (within days).\",\r\n            \"Biopsy of a metastatic site if feasible and not previously done (especially if discordance in receptors suspected or for research protocols).\",\r\n            \"Early palliative care referral for symptom management, psychosocial support, and goals of care discussion.\",\r\n            \"Discuss prognosis, treatment goals, and advanced care planning with patient and family.\",\r\n            \"Consider clinical trials.\"\r\n          ],\r\n          urgency: \"Same-day\", // For oncology referral\r\n          actionType: \"Urgent Oncology Referral & Palliative Care Integration\"\r\n        },\r\n        {\r\n          id: \"inflammatory_breast_cancer_confirmed\",\r\n          condition: \"Clinical diagnosis of inflammatory breast cancer (IBC) confirmed or highly suspected post-imaging/biopsy.\",\r\n          message: \"IBC is an aggressive form of breast cancer. Requires urgent, coordinated trimodality therapy, starting with neoadjuvant systemic therapy.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent medical oncology, surgical oncology, and radiation oncology consultations (within days).\",\r\n            \"Skin punch biopsy if not already done and diagnosis uncertain, to confirm dermal lymphatic invasion.\",\r\n            \"Complete staging workup immediately (PET-CT highly recommended for IBC).\",\r\n            \"Do NOT proceed with upfront surgery.\"\r\n          ],\r\n          urgency: \"Immediate\", // For specialist consultations and start of planning\r\n          actionType: \"Urgent Multidisciplinary Consultation & Neoadjuvant Planning\"\r\n        }\r\n      ]\r\n    }\r\n    // Further steps for MDT treatment planning (early, locally advanced, metastatic, DCIS), high-risk lesion management, benign follow-up, genetic counseling details, survivorship etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const prostateCancerPathway: StepBasedPathway = {\r\n  id: \"prostate\",\r\n  name: \"Prostate Cancer Diagnostic Pathway\",\r\n  description: \"Evidence-based approach to prostate cancer diagnosis, risk stratification, and initial staging, aligned with NCCN 2024 and EAU 2024 guidelines.\",\r\n  recommendedTimeframe: \"2-4 weeks from suspicion to diagnostic biopsy result; further 2-4 weeks for full staging and MDT discussion if cancer confirmed.\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Assessment & PSA/DRE Evaluation\",\r\n      description: \"Patient presents with elevated Prostate-Specific Antigen (PSA), abnormal Digital Rectal Exam (DRE), strong family history, or known genetic predisposition (e.g., BRCA1/2). Assess urinary symptoms (IPSS score) and rule out benign causes of PSA elevation (UTI, prostatitis, recent ejaculation/instrumentation, catheter).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN PROS-1 2024, EAU Guidelines on Prostate Cancer 2024\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Discuss PSA/DRE findings, the concept of risk stratification, and the diagnostic pathway. Address anxiety. Explain that not all elevated PSAs mean cancer and benign causes need to be excluded.\",\r\n      pitfalls: [\"Not repeating an initial elevated PSA after addressing potential benign causes.\", \"Ignoring abnormal DRE even with normal PSA.\", \"Failure to consider and rule out UTI or recent ejaculation/instrumentation/catheterization that could transiently elevate PSA before proceeding.\"],\r\n      options: [\r\n        {\r\n          text: \"Elevated PSA (> age-specific range or >4 ng/mL generally, or >3 ng/mL for men with BRCA2 or >40yrs with BRCA1) and/or suspicious DRE (nodule, induration, asymmetry)\",\r\n          next: \"psa_confirmation_risk_assessment\"\r\n        },\r\n        {\r\n          text: \"Strong family history (e.g., 1st degree relative <65yrs, multiple relatives) or known genetic predisposition (BRCA1/2, Lynch Syndrome, HOXB13) - consider earlier screening / lower PSA threshold\",\r\n          next: \"psa_confirmation_risk_assessment\" // Lower threshold for investigation\r\n        },\r\n        {\r\n          text: \"PSA normal, DRE normal, no significant risk factors\",\r\n          next: \"routine_screening_surveillance_prostate\"\r\n        },\r\n        {\r\n          text: \"Symptoms of UTI/prostatitis present\",\r\n          next: \"treat_uti_recheck_psa\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"prostate_very_high_psa_symptoms\",\r\n          condition: \"PSA > 20 ng/mL with new onset significant bone pain, or PSA > 50 ng/mL. Any PSA level with neurological symptoms concerning for spinal cord compression (e.g., new leg weakness, saddle anesthesia, bowel/bladder incontinence).\",\r\n          message: \"High suspicion for metastatic disease or locally advanced disease with complications. Requires urgent evaluation and management.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent urology/oncology consultation (within 24-48 hours).\",\r\n            \"Immediate bone scan and CT Chest/Abdomen/Pelvis (or PSMA PET-CT if available and indicated for high-risk staging).\",\r\n            \"If cord compression suspected: urgent MRI spine (same day), neurosurgical/radiation oncology consult, consider immediate high-dose corticosteroids.\"\r\n          ],\r\n          urgency: \"Immediate\",\r\n          actionType: \"Urgent Staging, Specialist Consultation & Symptom Management\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"psa_confirmation_risk_assessment\",\r\n      title: \"PSA Confirmation, Risk Assessment & Shared Decision-Making\",\r\n      description: \"Confirm persistent PSA elevation (repeat test 4-8 weeks after initial, ensuring no interfering factors). Calculate PSA density (PSAD = PSA / prostate volume from TRUS/MRI) and PSA velocity if prior values available. Assess risk factors (age, race, family hx of prostate/breast/ovarian/pancreatic cancer, genetic mutations). Use validated risk calculators (e.g., ERSPC, PCPT, Stockholm3, 4Kscore, SelectMDx, MyProstateScore) to estimate probability of clinically significant cancer. Discuss pros/cons of biopsy.\",\r\n      expectedDuration: \"1-2 weeks (allowing for repeat test and calculator use)\",\r\n      tooltip: \"PSAD > 0.15 ng/mL/cc is concerning. Risk calculators and biomarkers can help refine biopsy decisions and avoid overdiagnosis.\",\r\n      guidelineSource: \"NCCN PROS-2 2024, AUA/SUO Guidelines 2023, EAU Guidelines 2024\",\r\n      evidenceLevel: \"II\",\r\n      patientInfo: \"Explain rationale for confirming PSA, role of PSAD, risk calculators, and biomarkers in guiding decisions. Discuss the balance between detecting significant cancer and risks of biopsy/overtreatment. Shared decision-making is key.\",\r\n      pitfalls: [\"Proceeding to biopsy based on a single elevated PSA without confirmation or comprehensive risk assessment.\", \"Not using or misinterpreting risk calculators/biomarkers.\", \"Insufficient discussion of biopsy risks/benefits leading to uninformed patient choice.\"],\r\n      options: [\r\n        {\r\n          text: \"Persistent elevated PSA / high-risk profile on calculators / suspicious DRE / patient preference for diagnostic clarity after discussion\",\r\n          next: \"pre_biopsy_prostate_mri\"\r\n        },\r\n        {\r\n          text: \"PSA normalized or low risk profile after assessment / patient preference against biopsy after discussion\",\r\n          next: \"active_monitoring_psa_dre_risk_reassessment\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"pre_biopsy_prostate_mri\",\r\n      title: \"Pre-biopsy Multiparametric Prostate MRI (mpMRI)\",\r\n      description: \"Perform high-quality mpMRI (3T preferred) prior to initial biopsy if available and PSA/risk warrants. Report using PI-RADS v2.1. For patients with prior negative biopsy but ongoing suspicion, mpMRI is also strongly recommended.\",\r\n      expectedDuration: \"1-2 weeks (scheduling and reporting)\",\r\n      tooltip: \"mpMRI improves detection of clinically significant (Grade Group >=2) prostate cancer and can guide targeted biopsies, potentially reducing detection of insignificant cancers.\",\r\n      guidelineSource: \"NCCN PROS-3 2024, EAU Guidelines 2024, PRECISION Trial, MRI-FIRST Trial\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain mpMRI procedure, its benefits in identifying suspicious areas for targeted biopsy, and how results (PI-RADS score) will inform the biopsy plan. Mention it may help avoid biopsy if no suspicious lesions are found in some low-risk men.\",\r\n      pitfalls: [\"Poor quality mpMRI scan or inexperienced interpretation leading to false positives/negatives.\", \"Not performing MRI before biopsy if indicated and available, leading to potentially missed targets.\", \"Over-reliance on PI-RADS 3 lesions without considering other risk factors (PSAD is critical for PI-RADS 3).\"],\r\n      options: [\r\n        {\r\n          text: \"PI-RADS 4 or 5 lesion (High or Very High suspicion)\",\r\n          next: \"mri_targeted_plus_systematic_biopsy\",\r\n          triggers: [\"prostate_high_pirads\"]\r\n        },\r\n        {\r\n          text: \"PI-RADS 3 lesion (Equivocal) - decision to biopsy based on PSAD, risk profile, biomarkers, patient preference\",\r\n          next: \"pirads3_lesion_management_discussion\"\r\n        },\r\n        {\r\n          text: \"PI-RADS 1 or 2 lesion (Low or Very Low suspicion) AND low overall clinical risk (e.g. low PSAD)\",\r\n          next: \"continue_monitoring_consider_no_biopsy\"\r\n        },\r\n        {\r\n          text: \"PI-RADS 1 or 2 lesion BUT high clinical risk (e.g. high PSAD, strong family hx) or patient preference\",\r\n          next: \"systematic_biopsy_consider_no_target\"\r\n        },\r\n        {\r\n          text: \"No mpMRI performed or available, but clinical suspicion remains high enough to warrant biopsy\",\r\n          next: \"systematic_prostate_biopsy_only\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"prostate_high_pirads\",\r\n          condition: \"PI-RADS 4 or 5 lesion identified on mpMRI.\",\r\n          message: \"High or very high suspicion for clinically significant prostate cancer. MRI-targeted biopsy of the lesion plus systematic biopsies are strongly recommended.\",\r\n          severity: \"critical\", // Critical for decision making\r\n          recommendations: [\r\n            \"Schedule MRI-guided or MRI-ultrasound fusion targeted biopsy of the index lesion(s) + standard systematic template biopsies (typically 10-12 cores) within 2-3 weeks.\",\r\n            \"Discuss findings and biopsy plan clearly with the patient.\"\r\n          ],\r\n          urgency: \"Routine\", // For biopsy scheduling\r\n          actionType: \"Targeted & Systematic Biopsy Scheduling\"\r\n        },\r\n        {\r\n          id: \"prostate_extracapsular_extension_mri\",\r\n          condition: \"Clear evidence of extracapsular extension (ECE), seminal vesicle invasion (SVI), or direct bladder/rectal invasion on mpMRI.\",\r\n          message: \"Findings suggest locally advanced disease (at least T3). This is critical for staging and impacts treatment planning significantly. Biopsy should confirm.\",\r\n          severity: \"warning\", // Warning for staging implications\r\n          recommendations: [\r\n            \"Ensure biopsy plan adequately samples areas near suspected ECE/SVI if safe and feasible.\",\r\n            \"Flag for urology/MDT discussion regarding neoadjuvant approaches or more extensive surgical planning if cancer is confirmed and resectable.\",\r\n            \"Consider PSMA PET-CT for staging if high-risk features are present on MRI, once cancer confirmed.\"\r\n          ],\r\n          urgency: \"Routine\",\r\n          actionType: \"Biopsy Planning Adjustment & MDT Alert for Advanced Disease Features\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"mri_targeted_plus_systematic_biopsy\",\r\n      title: \"MRI-Targeted and Systematic Prostate Biopsy\",\r\n      description: \"Perform MRI-targeted biopsies (cognitive, software fusion, or in-bore) of PI-RADS 3-5 lesions (typically 2-4 cores per target), PLUS systematic template biopsies (e.g., 10-12 cores, transrectal or transperineal approach). Prophylactic antibiotics tailored to local resistance patterns. Consider periprostatic block for pain.\",\r\n      expectedDuration: \"1-3 days (procedure + initial pathology report)\",\r\n      tooltip: \"Combination of targeted and systematic biopsy maximizes detection of clinically significant cancer. Transperineal approach has lower infection risk. Discuss risks: bleeding, infection (sepsis is rare but serious), pain, hematuria, hematospermia, temporary urinary retention.\",\r\n      guidelineSource: \"NCCN PROS-4 2024, AUA/SUO Guidelines 2023, EAU Guidelines 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true, // For pathology review, concordance, and subsequent treatment planning\r\n      patientInfo: \"Explain the biopsy procedure (targeted + systematic), chosen approach (transrectal vs transperineal), specific risks, and post-procedure care (e.g., antibiotic completion, signs of infection). Obtain informed consent.\",\r\n      pitfalls: [\"Targeting error during fusion biopsy leading to false negative in targeted cores.\", \"Insufficient cores from targeted or systematic component.\", \"Post-biopsy infection/sepsis, especially with TRUS biopsy if prophylaxis is inadequate or resistance occurs.\", \"Underestimation of cancer grade/volume if sampling is suboptimal.\"],\r\n      options: [\r\n        {\r\n          text: \"Prostate cancer confirmed (Gleason score and Grade Group available)\",\r\n          next: \"pathology_review_risk_stratification_mdt\",\r\n          triggers: [\"prostate_cancer_confirmed_biopsy\"]\r\n        },\r\n        {\r\n          text: \"Biopsy negative for cancer, despite suspicious MRI/PSA (MRI-pathology discordance)\",\r\n          next: \"negative_biopsy_discordant_high_suspicion_review\"\r\n        },\r\n        {\r\n          text: \"Atypical findings (e.g., ASAP - Atypical Small Acinar Proliferation) or HGPIN (High-Grade Prostatic Intraepithelial Neoplasia)\",\r\n          next: \"atypical_hgpin_biopsy_management\"\r\n        },\r\n        {\r\n          text: \"Clinically insignificant cancer found (e.g., very low volume Gleason 3+3=6), concordant with low risk MRI/profile\",\r\n          next: \"discussion_active_surveillance_low_risk\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"prostate_cancer_confirmed_biopsy\",\r\n          condition: \"Prostate cancer (adenocarcinoma) confirmed on biopsy.\",\r\n          message: \"Histological confirmation of prostate cancer. Proceed to detailed risk stratification, staging, and multidisciplinary discussion.\",\r\n          severity: \"critical\", // Critical for diagnosis\r\n          recommendations: [\r\n            \"Ensure full pathology report includes Gleason score, ISUP Grade Group, number of positive cores, percentage of core involvement for each positive core, presence of intraductal carcinoma (IDC-P), perineural invasion (PNI).\",\r\n            \"Schedule for risk stratification using NCCN or EAU criteria and staging investigations as indicated (NCCN PROS-5).\",\r\n            \"Arrange urology/oncology consultation to discuss results and comprehensive treatment options.\"\r\n          ],\r\n          urgency: \"Routine\", // For next steps in planning\r\n          actionType: \"Detailed Pathology Review, Risk Stratification & Staging Initiation\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"pathology_review_risk_stratification_mdt\",\r\n      title: \"Pathology Review, Risk Stratification, Staging & MDT Discussion\",\r\n      description: \"Detailed review of biopsy pathology. Risk stratify using NCCN criteria (Very Low to Very High Risk) or EAU risk groups (Low, Intermediate, High). Staging investigations: Bone scan and CT Abdomen/Pelvis for unfavorable intermediate-risk with >cT2b or GG >2, or high-risk localized. PSMA PET-CT (if available) is preferred over conventional imaging for initial staging of unfavorable intermediate, high, and very high-risk disease, or any suspected metastatic disease (NCCN PROS-5, EAU 2024). Discuss germline (for all high/very high risk, metastatic, +ve family hx, IDC-P) and somatic testing (for metastatic/recurrent, or regional considering treatment implications). Present at MDT.\",\r\n      expectedDuration: \"1-2 weeks (for staging and MDT)\",\r\n      guidelineSource: \"NCCN PROS-5, PROS-6, PROS-7 2024, AJCC 8th Ed., EAU Guidelines 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain Gleason score, Grade Group, full risk category, and implications for treatment options/prognosis. Discuss need and type of staging scans. Explain genetic testing rationale if indicated. Describe MDT role in recommending optimal treatment.\",\r\n      pitfalls: [\"Incorrect Gleason grading or incomplete pathology reporting.\", \"Under-staging due to inappropriate imaging modality or missed metastatic disease.\", \"Not offering germline/somatic testing as per evolving guidelines, missing actionable mutations.\", \"Delay in MDT discussion impacting timely treatment initiation for aggressive cancers.\"],\r\n      options: [\r\n        {\r\n          text: \"Localized disease: Very Low, Low, or Favorable Intermediate Risk (NCCN)\",\r\n          next: \"treatment_options_discussion_low_favorable_intermediate_risk_prostate\"\r\n        },\r\n        {\r\n          text: \"Localized disease: Unfavorable Intermediate, High, or Very High Risk (NCCN)\",\r\n          next: \"treatment_options_discussion_unfavorable_intermediate_high_risk_prostate\"\r\n        },\r\n        {\r\n          text: \"Regional lymph node involvement (N1) identified on staging\",\r\n          next: \"treatment_planning_n1_prostate_cancer\",\r\n          triggers: [\"prostate_n1_disease_staging\"]\r\n        },\r\n        {\r\n          text: \"Metastatic (M1) disease identified on staging\",\r\n          next: \"treatment_planning_m1_prostate_cancer\",\r\n          triggers: [\"prostate_m1_disease_staging\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"prostate_n1_disease_staging\",\r\n          condition: \"Regional lymph node (N1) disease confirmed on staging investigations.\",\r\n          message: \"Pelvic lymph node positive (N1) prostate cancer. Treatment typically involves multimodal therapy.\",\r\n          severity: \"critical\", // For treatment planning\r\n          recommendations: [\r\n            \"Medical oncology / Urologic oncology / Radiation oncology consultation for multimodal therapy planning (e.g., EBRT + ADT, possibly with abiraterone; or radical prostatectomy + ePLND followed by adjuvant/salvage therapy).\",\r\n            \"Ensure comprehensive somatic/germline testing.\",\r\n            \"Discuss prognosis, goals of care, and clinical trial options.\"\r\n          ],\r\n          urgency: \"Routine\", // For specialist consults\r\n          actionType: \"Multidisciplinary Consultation for N1 Disease\"\r\n        },\r\n        {\r\n          id: \"prostate_m1_disease_staging\",\r\n          condition: \"Metastatic (M1) disease confirmed on staging investigations (bone, distant lymph nodes, visceral).\",\r\n          message: \"Metastatic prostate cancer. Systemic therapy is the cornerstone of management. Assess for oligometastatic vs widespread disease.\",\r\n          severity: \"critical\", // For treatment planning\r\n          recommendations: [\r\n            \"Urgent medical oncology/urologic oncology consultation.\",\r\n            \"Initiate Androgen Deprivation Therapy (ADT) promptly. Consider combination therapy (e.g., ADT + ARPI, ADT + docetaxel, or triplet therapy for high volume/de novo metastatic HSPC).\",\r\n            \"Ensure comprehensive somatic/germline testing (e.g. BRCA, HRR mutations, MSI/dMMR).\",\r\n            \"Discuss prognosis, goals of care, palliative care involvement, and clinical trial options.\",\r\n            \"Address bone health (calcium, Vit D, bone protective agents).\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Urgent Oncology Consultation & Systemic Therapy Initiation for M1 Disease\"\r\n        }\r\n      ]\r\n    }\r\n    // Further steps for treatment options (active surveillance, surgery, radiation, hormonal therapy, chemotherapy), management of recurrence, castrate-resistant disease, survivorship etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const lungCancerPathway: StepBasedPathway = {\r\n  id: \"lung\",\r\n  name: \"Lung Cancer Diagnostic Pathway\",\r\n  description: \"Systematic approach to lung cancer evaluation and staging, compliant with NCCN 2024 and ESMO 2023 guidelines.\",\r\n  recommendedTimeframe: \"2-3 weeks\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Presentation & Risk Assessment\",\r\n      description: \"Patient presents with symptoms (e.g., persistent cough, dyspnea, hemoptysis) or incidental imaging finding concerning for lung cancer. Assess risk factors (smoking history, family history, occupational exposure).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN LU-1 2024\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Discuss the importance of evaluating symptoms and the plan for initial imaging if indicated. Counsel on smoking cessation.\",\r\n      pitfalls: [\"Dismissing symptoms as benign without investigation in high-risk patients.\", \"Delay in ordering initial imaging.\"],\r\n      options: [\r\n        {\r\n          text: \"Suspicious chest imaging findings (e.g., nodule >8mm)\",\r\n          next: \"imaging\",\r\n          triggers: [\"suspicious_imaging\"]\r\n        },\r\n        {\r\n          text: \"Symptoms suggestive of lung cancer (e.g., hemoptysis, new persistent cough >3 weeks)\",\r\n          next: \"symptoms\",\r\n          triggers: [\"concerning_symptoms\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"suspicious_imaging\",\r\n          condition: \"Suspicious chest imaging (e.g., solid nodule >8mm, part-solid nodule, GGO with solid component)\",\r\n          message: \"Imaging findings concerning for malignancy. Refer to NCCN LU-2 for nodule management.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Expedite dedicated CT chest with contrast (unless contraindicated).\",\r\n            \"Early pulmonology/thoracic surgery consultation within 1 week.\",\r\n            \"Review smoking history and occupational exposures in detail.\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Referral and Imaging\"\r\n        },\r\n        {\r\n          id: \"concerning_symptoms\",\r\n          condition: \"High-risk symptoms (e.g., hemoptysis, unexplained weight loss, new hoarseness)\",\r\n          message: \"Symptoms concerning for lung cancer warrant prompt investigation.\",\r\n          severity: \"warning\",\r\n          recommendations: [\r\n            \"Chest imaging (CXR or CT) within 1 week as per NICE NG12.\",\r\n            \"Document duration, severity, and progression of symptoms.\",\r\n            \"Assess for other red flag symptoms (e.g., superior vena cava syndrome).\"\r\n          ],\r\n          urgency: \"Routine\",\r\n          actionType: \"Investigation\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"imaging\",\r\n      title: \"Diagnostic Imaging Studies\",\r\n      description: \"Perform high-quality CT chest with IV contrast to characterize lesion(s) and assess for mediastinal/hilar adenopathy and distant metastases. PET-CT for staging if appropriate (NCCN LU-3).\",\r\n      expectedDuration: \"3-5 days\",\r\n      tooltip: \"CT features: size, morphology (solid, subsolid), spiculation, pleural retraction. PET-CT for FDG-avidity. Ensure renal function adequate for contrast.\",\r\n      guidelineSource: \"NCCN LU-3 2024, ESMO LG-2023\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain the purpose of CT/PET-CT, what to expect during the scan, and potential findings. Discuss contrast allergy risks.\",\r\n      pitfalls: [\"Inadequate CT slice thickness for small nodule characterization.\", \"Misinterpretation of inflammatory vs. malignant FDG uptake on PET.\", \"Not performing PET-CT prior to invasive staging in potentially resectable disease.\"],\r\n      options: [\r\n        {\r\n          text: \"Definitive lesion on CT Chest requiring characterization\",\r\n          next: \"characterize\",\r\n          triggers: [\"significant_findings\"]\r\n        },\r\n        {\r\n          text: \"Suspected Stage III/IV or indeterminate findings, proceed to PET/CT\",\r\n          next: \"staging\",\r\n          triggers: [\"metastatic_suspicion\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"significant_findings\",\r\n          condition: \"CT findings highly suspicious for malignancy (e.g., spiculated mass, large nodule with growth)\",\r\n          message: \"Features highly suspicious for malignancy. Requires tissue diagnosis.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Expedite tissue diagnosis (biopsy/bronchoscopy).\",\r\n            \"Consider PET/CT for staging if not already done (NCCN LU-4).\",\r\n            \"Early thoracic MDT discussion planning (within 1-2 weeks).\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Biopsy and Staging\"\r\n        },\r\n        {\r\n          id: \"metastatic_suspicion\",\r\n          condition: \"Suspected metastatic disease on CT or PET-CT (e.g., adrenal, liver, bone lesions)\",\r\n          message: \"Features concerning for advanced/metastatic disease. Biopsy of metastatic site may be preferred.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Complete staging workup (e.g., brain MRI).\",\r\n            \"Early medical oncology consultation.\",\r\n            \"Plan for molecular testing on diagnostic tissue (NCCN LU-5).\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Referral and Staging\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"characterize\",\r\n      title: \"Lesion Characterization & Biopsy Planning\",\r\n      description: \"Determine optimal biopsy strategy based on lesion location, size, and patient fitness. Peripheral lesions often amenable to CT-guided biopsy; central lesions may require bronchoscopy (EBUS/Navigational).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"ACCP Lung Cancer Guidelines 2013, BTS 2023\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Discuss biopsy options, risks (pneumothorax, bleeding), benefits, and alternatives. Obtain informed consent.\",\r\n      pitfalls: [\"Choosing a suboptimal biopsy technique leading to non-diagnostic sample.\", \"Delay in biopsy scheduling.\", \"Not obtaining sufficient tissue for molecular testing.\"],\r\n      options: [\r\n        {\r\n          text: \"Peripheral lesion accessible to percutaneous biopsy\",\r\n          next: \"biopsy\"\r\n        },\r\n        {\r\n          text: \"Central lesion or mediastinal nodes requiring bronchoscopy/EBUS\",\r\n          next: \"bronchoscopy\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"biopsy\",\r\n      title: \"Tissue Biopsy (Percutaneous)\",\r\n      description: \"Perform image-guided (typically CT) core needle biopsy for peripheral lung lesions. Ensure adequate sample for histology and molecular testing (NCCN LU-5).\",\r\n      expectedDuration: \"2-5 days\",\r\n      tooltip: \"Core biopsy preferred over FNA for architectural assessment and molecular studies. Risks: pneumothorax (15-25%), bleeding. Post-procedure CXR.\",\r\n      guidelineSource: \"NCCN LU-4 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Discuss risks (pneumothorax, bleeding, pain) and benefits of CT-guided biopsy. Obtain informed consent. Provide post-procedure instructions.\",\r\n      pitfalls: [\"Non-diagnostic sample due to poor targeting or insufficient tissue.\", \"Delay in pathology reporting.\", \"Not sending tissue for molecular markers if adenocarcinoma suspected.\"],\r\n      options: [\r\n        { text: \"Malignancy confirmed (e.g., NSCLC, SCLC)\", next: \"staging_post_biopsy\" },\r\n        { text: \"Non-diagnostic or benign pathology\", next: \"mdt_review_indeterminate\" }\r\n      ]\r\n    },\r\n    {\r\n      id: \"bronchoscopy\",\r\n      title: \"Bronchoscopy & Endobronchial Ultrasound (EBUS)\",\r\n      description: \"For central lesions or mediastinal/hilar lymph node staging. EBUS-TBNA for lymph node sampling. Navigational bronchoscopy for peripheral lesions not suitable for CT-biopsy.\",\r\n      expectedDuration: \"2-5 days\",\r\n      tooltip: \"EBUS-TBNA is crucial for mediastinal staging (NCCN LU-4). Risks: bleeding, infection, pneumothorax (rare).\",\r\n      guidelineSource: \"NCCN LU-4 2024, ERS/ESTS Guidelines\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain procedure, sedation, potential discomfort, and risks. Obtain informed consent. NPO instructions.\",\r\n      pitfalls: [\"Inadequate nodal staging if EBUS not performed systematically.\", \"Complications in patients with severe COPD.\", \"Insufficient material from FNA for all molecular tests.\"],\r\n      options: [\r\n        { text: \"Malignancy confirmed, staging complete or needs PET\", next: \"staging_post_biopsy\" },\r\n        { text: \"Non-diagnostic or benign pathology\", next: \"mdt_review_indeterminate\" }\r\n      ]\r\n    },\r\n    {\r\n      id: \"staging_post_biopsy\",\r\n      title: \"Post-Biopsy Staging & MDT Review\",\r\n      description: \"Integrate histological diagnosis with PET-CT and other imaging (e.g., Brain MRI for NSCLC as per NCCN LU-6) to establish definitive TNM stage. All cases to be discussed at MDT.\",\r\n      expectedDuration: \"5-7 days\",\r\n      guidelineSource: \"NCCN LU-6/LU-7 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain the staging results and their implications for treatment options. Outline the role of the MDT.\",\r\n      pitfalls: [\"Incomplete staging (e.g., omitting brain MRI in non-metastatic NSCLC).\", \"Delay in MDT discussion.\", \"Not performing molecular testing for NSCLC adenocarcinoma (EGFR, ALK, ROS1, BRAF, PD-L1 etc. - NCCN LU-5).\"],\r\n      options: [\r\n        {\r\n          text: \"Localized disease (Stage I-II, selected III)\",\r\n          next: \"treatment_planning_curative\"\r\n        },\r\n        {\r\n          text: \"Locally advanced disease (Stage III)\",\r\n          next: \"treatment_planning_multimodal\"\r\n        },\r\n        {\r\n          text: \"Metastatic disease (Stage IV)\",\r\n          next: \"palliative\",\r\n          triggers: [\"metastatic_confirmed\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"metastatic_confirmed\",\r\n          condition: \"Confirmed metastatic disease (Stage IV)\",\r\n          message: \"Stage IV disease identified. Focus on systemic therapy and palliative care.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent medical oncology consultation (within 1 week).\",\r\n            \"Ensure comprehensive molecular testing is performed/pending (NCCN LU-9).\",\r\n            \"Early palliative care involvement for symptom management and goals of care discussion.\",\r\n            \"Discuss prognosis and treatment goals with patient and family.\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Referral and Systemic Therapy Planning\"\r\n        }\r\n      ]\r\n    }\r\n    // Add further steps for treatment planning, palliative care, MDT review of indeterminate findings etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const ovarianCancerPathway: StepBasedPathway = {\r\n  id: \"ovarian\",\r\n  name: \"Ovarian Cancer Diagnostic Pathway\",\r\n  description: \"Evidence-based approach to ovarian cancer diagnosis and staging, aligned with NCCN 2024, ESGO-ESTRO-ESP 2023, and SGO guidelines.\",\r\n  recommendedTimeframe: \"1-2 weeks for diagnosis; 2-4 weeks for full staging and surgical planning.\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Assessment & Symptom Evaluation\",\r\n      description: \"Patient presents with symptoms (e.g., bloating, pelvic/abdominal pain, early satiety, urinary urgency/frequency - often persistent and new-onset) or incidental adnexal mass on imaging. Detailed history, including family history of ovarian/breast cancer (BRCA).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN OV-1 2024, ACOG Committee Opinion No. 716\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain that symptoms can be vague and the importance of thorough evaluation. Discuss family history and potential genetic predisposition. Address anxiety.\",\r\n      pitfalls: [\"Dismissing vague symptoms as benign, especially in premenopausal women.\", \"Not taking a detailed family history.\", \"Delay in referral to gynecologic oncology for suspicious findings.\"],\r\n      options: [\r\n        {\r\n          text: \"Suspicious pelvic mass on prior imaging or exam, or persistent concerning symptoms\",\r\n          next: \"pelvic_exam_ultrasound\"\r\n        },\r\n        {\r\n          text: \"Incidental adnexal finding, low suspicion symptoms\",\r\n          next: \"initial_workup_low_risk\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"acute_symptoms_high_risk\",\r\n          condition: \"Acute abdominal/pelvic pain with adnexal mass, signs of torsion, rupture, or bowel obstruction.\",\r\n          message: \"Potential oncologic emergency or acute gynecologic condition. Requires urgent evaluation.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent gynecologic/surgical consultation (within 24 hours).\",\r\n            \"Immediate imaging (pelvic ultrasound, CT if indicated).\",\r\n            \"Assess for hemodynamic instability.\"\r\n          ],\r\n          urgency: \"Immediate\",\r\n          actionType: \"Urgent Specialist Consultation & Imaging\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"pelvic_exam_ultrasound\",\r\n      title: \"Pelvic Examination & Transvaginal Ultrasound (TVUS)\",\r\n      description: \"Perform comprehensive pelvic examination (bimanual and rectovaginal). Perform TVUS to characterize adnexal mass(es) - size, morphology (solid components, septations, papillary projections, laterality), and assess for ascites/peritoneal disease. Use IOTA ADNEX model or RMI if available.\",\r\n      expectedDuration: \"1 day\",\r\n      tooltip: \"Document mass characteristics meticulously. TVUS is the primary imaging modality. Consider CA-125 concurrently.\",\r\n      guidelineSource: \"NCCN OV-1 2024, ISUOG Consensus Statement 2017\",\r\n      evidenceLevel: \"I\",\r\n      calculatorId: \"IOTA_ADNEX_model\", // Example\r\n      patientInfo: \"Explain the pelvic exam and TVUS procedure. Discuss how ultrasound helps characterize the mass. Reassure patient during exam.\",\r\n      pitfalls: [\"Incomplete pelvic exam.\", \"Suboptimal ultrasound technique or interpretation.\", \"Not recognizing high-risk ultrasound features.\"],\r\n      options: [\r\n        {\r\n          text: \"High suspicion of malignancy on exam/TVUS (e.g., solid/complex mass, ascites, peritoneal nodules, IOTA ADNEX high risk)\",\r\n          next: \"tumor_markers_ct_staging\",\r\n          triggers: [\"suspicious_mass_imaging\"]\r\n        },\r\n        {\r\n          text: \"Indeterminate findings on TVUS\",\r\n          next: \"tumor_markers_ct_staging\" // Usually proceed with further workup\r\n        },\r\n        {\r\n          text: \"Clearly benign simple cyst on TVUS (e.g., <10cm, unilocular, anechoic)\",\r\n          next: \"benign_cyst_management\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"suspicious_mass_imaging\",\r\n          condition: \"Adnexal mass with ultrasound features suspicious for malignancy (e.g., solid component, papillary projections, ascites, high vascularity).\",\r\n          message: \"Findings highly concerning for ovarian malignancy. Requires prompt referral to Gynecologic Oncologist.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Refer to Gynecologic Oncologist within 1 week (NCCN OV-2).\",\r\n            \"Obtain CA-125, HE4 (if available, for ROMA score), and other markers (CEA, CA19-9, AFP, hCG, LDH if suspicious for non-epithelial tumor).\",\r\n            \"Proceed to CT Chest/Abdomen/Pelvis with contrast for staging.\"\r\n          ],\r\n          urgency: \"Same-day\", // For referral initiation and test ordering\r\n          actionType: \"Referral & Staging Workup\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"tumor_markers_ct_staging\",\r\n      title: \"Tumor Markers & CT Staging\",\r\n      description: \"Measure serum CA-125. In premenopausal women with complex mass, also consider AFP, hCG, LDH. For postmenopausal women with adnexal mass, CA-125 and HE4 (for ROMA score) can aid risk assessment. Perform CT Chest/Abdomen/Pelvis with contrast for staging (assess peritoneal carcinomatosis, lymphadenopathy, distant mets).\",\r\n      expectedDuration: \"3-5 days\",\r\n      tooltip: \"CA-125 can be elevated in benign conditions. Interpret with imaging. CT helps determine resectability and guides surgical planning.\",\r\n      guidelineSource: \"NCCN OV-1 & OV-2 2024, SGO Guidelines\",\r\n      evidenceLevel: \"I\",\r\n      calculatorId: \"ROMA_score\", // Example\r\n      patientInfo: \"Explain blood tests for tumor markers and CT scan for staging. Discuss that CA-125 is not diagnostic alone but part of overall assessment.\",\r\n      pitfalls: [\"Relying solely on CA-125 for diagnosis.\", \"Not ordering appropriate markers for suspected germ cell or stromal tumors in younger patients.\", \"Inadequate CT protocol or interpretation for peritoneal disease.\"],\r\n      options: [\r\n        {\r\n          text: \"High suspicion based on imaging, elevated markers (e.g., CA-125 >200 U/mL in postmenopausal, or high ROMA/ADNEX score), and/or CT findings of metastatic disease\",\r\n          next: \"gyn_onc_consult_surgical_planning\",\r\n          triggers: [\"confirmed_high_risk_oc\"]\r\n        },\r\n        {\r\n          text: \"Indeterminate findings, further assessment needed (e.g. MRI Pelvis, GI consult if primary GI cancer suspected)\",\r\n          next: \"mdt_review_further_investigation\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"confirmed_high_risk_oc\",\r\n          condition: \"Combination of suspicious imaging, significantly elevated tumor markers, and/or CT evidence of advanced disease.\",\r\n          message: \"High probability of ovarian cancer. Management by Gynecologic Oncologist is mandatory.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Ensure Gynecologic Oncologist is leading management.\",\r\n            \"Discuss goals of care, including fertility preservation if applicable and feasible.\",\r\n            \"Plan for surgical staging/debulking or neoadjuvant chemotherapy based on resectability assessment (NCCN OV-3/OV-4).\",\r\n            \"Offer genetic counseling (BRCA, Lynch syndrome) - NCCN OV-1.\"\r\n          ],\r\n          urgency: \"Routine\", // Assuming referral already made\r\n          actionType: \"Definitive Management Planning\"\r\n        },\r\n        {\r\n          id: \"bowel_ureteric_obstruction\",\r\n          condition: \"Evidence of bowel or ureteric obstruction on CT scan.\",\r\n          message: \"Significant complication requiring urgent intervention or planning.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent surgical/urologic/GI consultation as appropriate.\",\r\n            \"Consider stenting or diversion if symptomatic or impending renal failure.\",\r\n            \"Incorporate into overall surgical/treatment plan.\"\r\n          ],\r\n          urgency: \"Same-day\",\r\n          actionType: \"Intervention & Specialist Consultation\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"gyn_onc_consult_surgical_planning\",\r\n      title: \"Gynecologic Oncology Consultation & Surgical/Treatment Planning\",\r\n      description: \"Comprehensive consultation with Gynecologic Oncologist. Review all data, discuss prognosis, treatment options (primary debulking surgery (PDS) vs. neoadjuvant chemotherapy (NACT) followed by interval debulking surgery). Biopsy may be obtained via laparoscopy or image-guided if PDS not planned initially or diagnosis uncertain.\",\r\n      expectedDuration: \"3-7 days\",\r\n      guidelineSource: \"NCCN OV-3 & OV-4 2024, ESGO Guidelines\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Detailed discussion of diagnosis, stage, treatment goals (curative/palliative), surgical procedures (TAH-BSO, omentectomy, lymphadenectomy, peritonectomy), chemotherapy, side effects, and expected recovery. Importance of MDT input. Clinical trial options.\",\r\n      pitfalls: [\"Inadequate preoperative assessment of resectability leading to suboptimal surgery.\", \"Delay in starting NACT for unresectable disease.\", \"Not performing germline/somatic BRCA testing and HRD testing on tumor tissue (NCCN OV-5).\"],\r\n      options: [\r\n        {\r\n          text: \"Proceed with Primary Debulking Surgery (PDS)\",\r\n          next: \"primary_debulking_surgery\"\r\n        },\r\n        {\r\n          text: \"Candidate for Neoadjuvant Chemotherapy (NACT) due to extensive disease or comorbidities\",\r\n          next: \"neoadjuvant_chemotherapy_planning\"\r\n        },\r\n        {\r\n          text: \"Diagnosis uncertain or requires tissue confirmation before major surgery/NACT\",\r\n          next: \"diagnostic_laparoscopy_biopsy\"\r\n        }\r\n      ]\r\n      // Red flags for this step would relate to rapid deterioration or specific surgical contraindications arising.\r\n    }\r\n    // Further steps for surgical outcomes, adjuvant therapy, NACT response, benign cyst management, MDT reviews etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const gastricCancerPathway: StepBasedPathway = {\r\n  id: \"gastric\",\r\n  name: \"Gastric Cancer Diagnostic Pathway\",\r\n  description: \"Systematic approach to gastric cancer diagnosis and staging, aligned with NCCN 2024, ESMO 2023, and Japanese Gastric Cancer Association (JGCA) guidelines.\",\r\n  recommendedTimeframe: \"1-2 weeks for endoscopy and biopsy results; 2-3 weeks for full staging and MDT discussion if cancer confirmed.\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Assessment & Symptom Evaluation\",\r\n      description: \"Patient presents with dyspepsia, epigastric pain, weight loss, dysphagia, early satiety, or signs of GI bleeding (melena, hematemesis). Assess for alarm features (NCCN GC-1). Evaluate H. pylori risk factors.\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN GC-1 2024, ESMO Clinical Practice Guidelines 2023\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain the importance of evaluating persistent GI symptoms. Discuss alarm features and the need for endoscopy if present. Address anxiety.\",\r\n      pitfalls: [\"Attributing symptoms to GERD without investigating further in at-risk patients.\", \"Delaying endoscopy in patients with alarm features.\", \"Not considering H. pylori testing in dyspeptic patients without alarm features (age <60).\"],\r\n      options: [\r\n        {\r\n          text: \"Alarm features present (e.g., weight loss, dysphagia, persistent vomiting, GI bleed, palpable mass, iron deficiency anemia) OR age >60 with new onset dyspepsia (NCCN GC-1)\",\r\n          next: \"urgent_endoscopy_biopsy\",\r\n          triggers: [\"alarm_symptoms_gc\"]\r\n        },\r\n        {\r\n          text: \"No alarm features, age <60: Test for H. pylori (urea breath test or stool antigen). If positive, treat.\",\r\n          next: \"hp_testing_management\"\r\n        },\r\n        {\r\n          text: \"No alarm features, H. pylori negative or treated but symptoms persist >4-8 weeks\",\r\n          next: \"endoscopy_biopsy_non_urgent\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"alarm_symptoms_gc\",\r\n          condition: \"Presence of alarm features (e.g., significant weight loss, progressive dysphagia, overt GI bleeding, palpable mass).\",\r\n          message: \"High suspicion for malignancy. Requires prompt endoscopic evaluation.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Schedule upper GI endoscopy (EGD) within 2 weeks (NCCN GC-1).\",\r\n            \"Obtain CBC, iron studies, LFTs, albumin.\",\r\n            \"If active severe bleeding, manage as GI emergency (see GI Bleed Pathway).\"\r\n          ],\r\n          urgency: \"Routine\", // For endoscopy scheduling, unless active emergency\r\n          actionType: \"Endoscopy Scheduling & Lab Workup\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"urgent_endoscopy_biopsy\",\r\n      title: \"Upper GI Endoscopy (EGD) & Biopsy\",\r\n      description: \"Perform EGD with high-definition white light and chromoendoscopy/NBI if available. Document lesion morphology (Paris classification), location, and extent. Obtain multiple biopsies (at least 6-8) from suspicious lesions for histology. Biopsy normal-appearing mucosa if linitis plastica suspected.\",\r\n      expectedDuration: \"1-3 days (procedure to initial findings)\",\r\n      tooltip: \"Systematic biopsy protocol is crucial. Photograph lesions. Consider EUS at same session if deep invasion suspected and expertise available.\",\r\n      guidelineSource: \"NCCN GC-1 2024, ESGE Guideline 2022\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain EGD procedure, sedation, risks (bleeding, perforation, aspiration), and purpose of biopsies. Obtain informed consent.\",\r\n      pitfalls: [\"Insufficient number or quality of biopsies.\", \"Missing early or flat lesions.\", \"Not documenting precise location for surgical planning.\", \"Failure to biopsy suspicious regional nodes if seen on EUS.\"],\r\n      options: [\r\n        {\r\n          text: \"Gastric malignancy suspected/confirmed on EGD/biopsy (adenocarcinoma, lymphoma, GIST, NET)\",\r\n          next: \"pathology_review_molecular_testing\",\r\n          triggers: [\"gastric_cancer_diagnosis\"]\r\n        },\r\n        {\r\n          text: \"High-grade dysplasia found\",\r\n          next: \"hgd_management\"\r\n        },\r\n        {\r\n          text: \"Benign findings (e.g., gastritis, ulcer) or low-grade dysplasia\",\r\n          next: \"benign_lgd_management\"\r\n        },\r\n        {\r\n          text: \"Non-diagnostic EGD/biopsy but high clinical suspicion persists\",\r\n          next: \"repeat_egd_alternative_imaging\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"gastric_cancer_diagnosis\",\r\n          condition: \"Histopathological confirmation of gastric malignancy.\",\r\n          message: \"Gastric cancer diagnosed. Proceed with comprehensive staging and MDT discussion.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Ensure pathology report includes histologic type, grade, Lauren classification (intestinal/diffuse/mixed), HER2 IHC, PD-L1 CPS, and MSI status (NCCN GC-2).\",\r\n            \"Schedule staging CT Chest/Abdomen/Pelvis with oral and IV contrast.\",\r\n            \"Refer to multidisciplinary team (surgeon, medical oncologist, radiation oncologist, pathologist, radiologist).\"\r\n          ],\r\n          urgency: \"Routine\",\r\n          actionType: \"Staging & MDT Referral\"\r\n        },\r\n        {\r\n          id: \"linitis_plastica_suspicion\",\r\n          condition: \"Endoscopic suspicion of linitis plastica (diffusely infiltrated, rigid stomach wall).\",\r\n          message: \"High suspicion for aggressive diffuse-type adenocarcinoma. Often underdiagnosed on biopsy.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Take multiple deep biopsies or jumbo biopsies from different areas.\",\r\n            \"Consider EUS with FNA of thickened wall.\",\r\n            \"CT scan may show characteristic wall thickening. PET-CT can be helpful.\",\r\n            \"Early surgical consultation is critical due to poor prognosis.\"\r\n          ],\r\n          urgency: \"Same-day\", // For planning further immediate diagnostics\r\n          actionType: \"Enhanced Biopsy & Imaging, Urgent Consult\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"pathology_review_molecular_testing\",\r\n      title: \"Pathology Review & Molecular Testing\",\r\n      description: \"Confirm histologic type (adenocarcinoma most common). For adenocarcinoma: assess grade, Lauren classification. Perform HER2 IHC (reflex FISH if IHC 2+). Test for MSI (IHC or PCR) and PD-L1 (CPS score, e.g., 22C3 or 28-8 pharmDx). Consider NTRK fusion testing for advanced disease.\",\r\n      expectedDuration: \"5-10 days (for full molecular results)\",\r\n      tooltip: \"Molecular testing is crucial for guiding systemic therapy in advanced/metastatic disease. Ensure adequate tissue for all tests.\",\r\n      guidelineSource: \"NCCN GC-2 & GC-F 2024, CAP Guideline 2022\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain that detailed tumor analysis helps determine the best treatment options, including targeted therapies or immunotherapy.\",\r\n      pitfalls: [\"Insufficient tissue for all molecular tests.\", \"Delay in obtaining molecular results impacting treatment decisions.\", \"Misinterpretation of HER2 or PD-L1 scoring.\"],\r\n      options: [\r\n        {\r\n          text: \"Pathology and molecular results available\",\r\n          next: \"staging_workup_gastric\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"staging_workup_gastric\",\r\n      title: \"Comprehensive Staging Workup\",\r\n      description: \"CT Chest/Abdomen/Pelvis with oral and IV contrast. EUS for T and N staging of non-metastatic disease (NCCN GC-3). PET-CT if potentially resectable M0 disease to rule out occult mets (especially for GEJ or bulky tumors) or if CT equivocal. Diagnostic laparoscopy with peritoneal washings for all potentially resectable (cT1b or higher) gastric cancers before neoadjuvant/adjuvant therapy or surgery (NCCN GC-3). Assess nutritional status (albumin, prealbumin, weight loss %).\",\r\n      expectedDuration: \"1-2 weeks\",\r\n      guidelineSource: \"NCCN GC-3 & GC-4 2024, ESMO Guidelines 2023\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain the purpose of each staging test (CT, EUS, PET, laparoscopy) in determining the extent of cancer and guiding treatment. Discuss nutritional support if needed.\",\r\n      pitfalls: [\"Omitting diagnostic laparoscopy for potentially resectable cases, leading to unexpected positive cytology or peritoneal mets at surgery.\", \"Underutilization of EUS for local staging.\", \"Not addressing malnutrition preoperatively.\"],\r\n      options: [\r\n        {\r\n          text: \"Resectable disease (cT1-T4a, N0-N3, M0, no positive cytology) - candidate for perioperative/neoadjuvant therapy or upfront surgery based on stage/MDT\",\r\n          next: \"mdt_treatment_planning_resectable\"\r\n        },\r\n        {\r\n          text: \"Unresectable locally advanced disease (T4b, bulky N3, encasement of major vessels) OR Oligometastatic disease potentially convertible\",\r\n          next: \"mdt_treatment_planning_unresectable_locally_advanced\"\r\n        },\r\n        {\r\n          text: \"Widely metastatic disease (M1) or positive peritoneal cytology\",\r\n          next: \"mdt_treatment_planning_metastatic\",\r\n          triggers: [\"metastatic_gastric_cancer\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"metastatic_gastric_cancer\",\r\n          condition: \"Metastatic disease (M1) confirmed by imaging or positive peritoneal cytology.\",\r\n          message: \"Stage IV gastric cancer. Treatment is primarily systemic with palliative intent.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Medical oncology consultation for systemic therapy (chemotherapy +/- HER2-targeted therapy +/- immunotherapy based on biomarkers).\",\r\n            \"Early palliative care referral for symptom management and goals of care discussion.\",\r\n            \"Nutritional support, management of ascites/obstruction as needed.\",\r\n            \"Consider clinical trials.\"\r\n          ],\r\n          urgency: \"Same-day\", // For oncology referral and palliative care\r\n          actionType: \"Systemic Therapy Planning & Supportive Care\"\r\n        }\r\n      ]\r\n    }\r\n    // Further steps for MDT planning for resectable, unresectable, metastatic; surgical details; adjuvant/palliative treatments etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const headNeckCancerPathway: StepBasedPathway = {\r\n  id: \"head_neck\",\r\n  name: \"Head & Neck Cancer Diagnostic Pathway\",\r\n  description: \"Structured approach to head and neck cancer diagnosis, staging, and initial management, aligned with NCCN 2024 and ESMO 2023 guidelines.\",\r\n  recommendedTimeframe: \"1-2 weeks for diagnosis; 2-3 weeks for full staging and MDT discussion.\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Presentation & Symptom Assessment\",\r\n      description: \"Patient presents with symptoms such as persistent sore throat, dysphagia, odynophagia, hoarseness, neck mass, oral lesion, unexplained otalgia, or cranial neuropathies. Assess risk factors (tobacco, alcohol, HPV).\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN HN-1 2024, ESMO H&N Guidelines 2023\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain the importance of evaluating persistent symptoms. Discuss risk factors. Address anxiety and the diagnostic plan, likely involving ENT specialist referral.\",\r\n      pitfalls: [\"Delaying referral for persistent symptoms (>2-4 weeks).\", \"Not performing a thorough cranial nerve exam.\", \"Underestimating significance of unilateral otalgia or serous otitis media in adults (nasopharyngeal cancer risk).\"],\r\n      options: [\r\n        {\r\n          text: \"Red flag symptoms: Stridor, airway compromise, significant bleeding, rapidly enlarging neck mass, cranial neuropathy\",\r\n          next: \"emergency_assessment_ent\",\r\n          triggers: [\"hn_emergency_symptoms\"]\r\n        },\r\n        {\r\n          text: \"Suspicious neck mass, persistent hoarseness >2-4 wks, non-healing oral ulcer >2-4 wks, dysphagia/odynophagia, or other concerning symptoms\",\r\n          next: \"ent_referral_exam\"\r\n        },\r\n        {\r\n          text: \"Low suspicion symptoms, no clear red flags\",\r\n          next: \"primary_care_monitoring_reassess\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"hn_emergency_symptoms\",\r\n          condition: \"Stridor, airway compromise, active hemorrhage from tumor site, rapidly progressive cranial neuropathy.\",\r\n          message: \"Potential life-threatening situation. Requires immediate specialist assessment and possible intervention.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Immediate referral to ENT/Emergency Department.\",\r\n            \"Secure airway if compromised (prepare for intubation/tracheostomy).\",\r\n            \"Control hemorrhage.\",\r\n            \"Urgent imaging (CT Head/Neck with contrast) may be needed.\"\r\n          ],\r\n          urgency: \"Immediate\",\r\n          actionType: \"Emergency Referral & Airway/Hemorrhage Management\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"ent_referral_exam\",\r\n      title: \"ENT Specialist Examination & Endoscopy\",\r\n      description: \"Comprehensive head and neck examination by ENT specialist, including palpation of neck nodes, oral cavity, and cranial nerve assessment. Perform flexible nasopharyngolaryngoscopy. Examination under anesthesia (EUA) with direct laryngoscopy, esophagoscopy, bronchoscopy (panendoscopy) may be indicated, especially for unknown primary or synchronous primary suspicion.\",\r\n      expectedDuration: \"1-3 days\",\r\n      tooltip: \"Document all subsites. Biopsy suspicious lesions during endoscopy/EUA. Consider HPV testing for oropharyngeal tumors (p16 IHC).\",\r\n      guidelineSource: \"NCCN HN-1 & HN-2 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true, // For planning biopsy/EUA and subsequent steps\r\n      patientInfo: \"Explain the specialist exam, including flexible scope. If EUA needed, explain procedure, anesthesia, and purpose of biopsies.\",\r\n      pitfalls: [\"Incomplete endoscopic examination missing a primary site.\", \"Not biopsying all suspicious areas.\", \"Failure to perform p16 testing on oropharyngeal SCC biopsies.\"],\r\n      options: [\r\n        {\r\n          text: \"Visible lesion identified, biopsy taken/planned\",\r\n          next: \"pathology_review_hn\"\r\n        },\r\n        {\r\n          text: \"Neck mass, primary unknown after initial endoscopy. Plan for EUA, imaging, possible FNA of neck node.\",\r\n          next: \"unknown_primary_workup_hn\"\r\n        },\r\n        {\r\n          text: \"No lesion found, symptoms persist or high suspicion\",\r\n          next: \"imaging_hn_initial\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"pathology_review_hn\",\r\n      title: \"Pathology Review & HPV Testing\",\r\n      description: \"Histopathological confirmation of malignancy (usually Squamous Cell Carcinoma). For oropharyngeal SCC, p16 IHC testing is mandatory (NCCN HN-3). For nasopharyngeal carcinoma, EBV (EBER) testing. Note histologic grade and features like PNI, LVI.\",\r\n      expectedDuration: \"3-7 days\",\r\n      tooltip: \"p16 status significantly impacts staging and prognosis for oropharyngeal cancer. Ensure adequate tissue for all necessary tests.\",\r\n      guidelineSource: \"NCCN HN-3 2024, CAP H&N Cancer Reporting Protocols\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain the biopsy results, including cancer type and HPV/EBV status if relevant. Discuss how this information guides staging and treatment.\",\r\n      pitfalls: [\"p16 testing not performed or misinterpreted for oropharyngeal SCC.\", \"Insufficient biopsy material for complete diagnosis and molecular testing.\", \"Delay in pathology reporting.\"],\r\n      options: [\r\n        {\r\n          text: \"Malignancy confirmed (e.g., SCC, NPC, salivary gland tumor)\",\r\n          next: \"staging_workup_hn\",\r\n          triggers: [\"hn_cancer_confirmed\"]\r\n        },\r\n        {\r\n          text: \"Dysplasia or pre-malignant lesion found\",\r\n          next: \"premalignant_lesion_management_hn\"\r\n        },\r\n        {\r\n          text: \"Biopsy benign or non-diagnostic, but high clinical suspicion remains\",\r\n          next: \"repeat_biopsy_further_investigation_hn\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"hn_cancer_confirmed\",\r\n          condition: \"Histopathological confirmation of head and neck malignancy.\",\r\n          message: \"Head and neck cancer diagnosed. Proceed with comprehensive staging and multidisciplinary team discussion.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Schedule staging imaging (CT Neck with contrast, CT Chest, PET-CT as per NCCN HN-4).\",\r\n            \"Refer to multidisciplinary H&N oncology team (ENT surgeon, radiation oncologist, medical oncologist, pathologist, radiologist, speech pathologist, dietitian, dentist).\",\r\n            \"Dental assessment prior to radiation therapy.\",\r\n            \"Speech and swallow evaluation.\",\r\n            \"Nutritional assessment and support.\"\r\n          ],\r\n          urgency: \"Routine\",\r\n          actionType: \"Staging, MDT Referral & Supportive Care Planning\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"staging_workup_hn\",\r\n      title: \"Comprehensive Staging Workup\",\r\n      description: \"CT Neck with IV contrast (from skull base to clavicles). CT Chest (with or without contrast). PET-CT (skull base to mid-thigh) for stage III/IV disease, unknown primary, or aggressive histology (NCCN HN-4). MRI for specific sites (e.g., nasopharynx, paranasal sinus, skull base, salivary glands, PNI assessment). Dental evaluation and speech/swallow function assessment.\",\r\n      expectedDuration: \"1-2 weeks\",\r\n      guidelineSource: \"NCCN HN-4 & HN-5 2024, AJCC 8th Ed. Staging Manual\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain the purpose of staging scans (CT, PET-CT, MRI) to determine cancer extent. Discuss importance of dental, speech, and swallow evaluations before treatment.\",\r\n      pitfalls: [\"Incomplete staging (e.g., omitting chest imaging).\", \"Not performing PET-CT when indicated, potentially missing distant mets or unknown primary.\", \"Delay in dental clearance impacting start of radiation.\", \"Underestimation of tumor extent, especially perineural invasion, without appropriate MRI.\"],\r\n      options: [\r\n        {\r\n          text: \"Localized disease (Stage I-II) or selected Stage III/IVA (e.g. HPV+ oropharynx)\",\r\n          next: \"mdt_treatment_planning_early_hn\"\r\n        },\r\n        {\r\n          text: \"Locally/regionally advanced disease (Stage III-IVB, excluding M1)\",\r\n          next: \"mdt_treatment_planning_advanced_hn\"\r\n        },\r\n        {\r\n          text: \"Metastatic disease (Stage IVC / M1) identified\",\r\n          next: \"mdt_treatment_planning_metastatic_hn\",\r\n          triggers: [\"metastatic_hn_cancer\"]\r\n        },\r\n        {\r\n          text: \"Cancer of Unknown Primary (CUP) with neck node mets\",\r\n          next: \"unknown_primary_management_hn\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"metastatic_hn_cancer\",\r\n          condition: \"Metastatic disease (M1) confirmed by staging investigations.\",\r\n          message: \"Stage IVC (metastatic) head and neck cancer. Treatment intent is primarily palliative.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Medical oncology consultation for systemic therapy (chemotherapy, immunotherapy, targeted therapy).\",\r\n            \"Early palliative care referral for symptom control and goals of care discussion.\",\r\n            \"Address nutritional support, pain management, and potential airway issues.\",\r\n            \"Consider clinical trials.\"\r\n          ],\r\n          urgency: \"Same-day\", // For oncology and palliative care referrals\r\n          actionType: \"Systemic Therapy & Palliative Care Planning\"\r\n        }\r\n      ]\r\n    }\r\n    // Further steps for MDT planning based on stage/site, treatment execution (surgery, RT, CRT), unknown primary management, surveillance etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const pancreaticCancerPathway: StepBasedPathway = {\r\n  id: \"pancreatic\",\r\n  name: \"Pancreatic Cancer Diagnostic Pathway\",\r\n  description: \"Evidence-based approach to pancreatic cancer diagnosis, staging, and initial management planning, aligned with NCCN 2024, ESMO 2023, and ASGE guidelines.\",\r\n  recommendedTimeframe: \"1-2 weeks for diagnosis; 2-3 weeks for full staging and MDT discussion.\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Presentation & Symptom Evaluation\",\r\n      description: \"Patient presents with symptoms such as painless obstructive jaundice, new-onset diabetes (especially >50 yrs with weight loss), unexplained persistent abdominal/back pain, weight loss, steatorrhea, or acute pancreatitis without clear cause.\",\r\n      expectedDuration: \"1-2 days\",\r\n      guidelineSource: \"NCCN PA-1 & PA-2 2024, ESMO Pancreatic Cancer Guidelines 2023\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain that symptoms warrant investigation to rule out serious conditions, including pancreatic cancer. Discuss the diagnostic plan, likely involving imaging and specialist referral.\",\r\n      pitfalls: [\"Attributing symptoms to benign GI issues, delaying diagnosis.\", \"Not recognizing new-onset diabetes with weight loss as a red flag.\", \"Delay in imaging for painless jaundice.\"],\r\n      options: [\r\n        {\r\n          text: \"Painless obstructive jaundice (elevated bilirubin, dark urine, pale stools)\",\r\n          next: \"urgent_imaging_jaundice\",\r\n          triggers: [\"pan_jaundice\"]\r\n        },\r\n        {\r\n          text: \"Suspicious pancreatic mass/lesion found on incidental imaging\",\r\n          next: \"dedicated_pancreatic_imaging\"\r\n        },\r\n        {\r\n          text: \"Concerning symptoms (e.g., persistent epigastric pain radiating to back, unexplained significant weight loss, new-onset diabetes with weight loss) without jaundice\",\r\n          next: \"initial_labs_imaging_non_jaundice\"\r\n        },\r\n        {\r\n          text: \"Vague symptoms, low suspicion initially\",\r\n          next: \"primary_care_workup_monitoring\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"pan_jaundice\",\r\n          condition: \"Painless obstructive jaundice.\",\r\n          message: \"High suspicion for pancreatic head or periampullary malignancy. Requires urgent evaluation.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent (within 48 hours) high-quality multiphase pancreatic protocol CT scan (or MRI/MRCP if CT contraindicated/equivocal).\",\r\n            \"Check LFTs, coagulation profile (INR).\",\r\n            \"Urgent referral to HPB surgeon / Gastroenterologist with expertise in pancreatobiliary diseases.\",\r\n            \"Consider biliary drainage (ERCP with stenting or PTBD) if severe jaundice or cholangitis, after imaging if possible.\"\r\n          ],\r\n          urgency: \"Immediate\", // For imaging and referral\r\n          actionType: \"Urgent Imaging, Labs & Specialist Referral\"\r\n        },\r\n        {\r\n          id: \"cholangitis_signs\",\r\n          condition: \"Jaundice with fever, chills, RUQ pain (Charcot's triad) or sepsis.\",\r\n          message: \"Acute cholangitis, a medical emergency. Requires immediate biliary decompression and antibiotics.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Immediate hospital admission.\",\r\n            \"Broad-spectrum IV antibiotics.\",\r\n            \"Urgent biliary decompression (ERCP or PTBD) within 12-24 hours.\",\r\n            \"Fluid resuscitation and supportive care.\"\r\n          ],\r\n          urgency: \"Immediate\",\r\n          actionType: \"Emergency Admission & Intervention\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"dedicated_pancreatic_imaging\",\r\n      title: \"High-Quality Pancreatic Imaging\",\r\n      description: \"Perform multiphase pancreatic protocol CT (preferred) or MRI/MRCP. This is crucial for characterizing the lesion, assessing vascular involvement (SMA, SMV, portal vein, celiac axis), and detecting metastatic disease.\",\r\n      expectedDuration: \"2-5 days\",\r\n      tooltip: \"CT protocol: non-contrast, arterial, pancreatic parenchymal, and portal venous phases. Thin slices. Radiologist expertise is key.\",\r\n      guidelineSource: \"NCCN PA-2 & PA-3 2024, International Consensus Guidelines 2017 (Radiology)\",\r\n      evidenceLevel: \"I\",\r\n      patientInfo: \"Explain the specific type of CT or MRI needed and why itâ€™s important for detailed views of the pancreas and surrounding structures.\",\r\n      pitfalls: [\"Using a generic abdominal CT instead of a dedicated pancreatic protocol scan.\", \"Misinterpretation of vascular involvement.\", \"Not identifying small liver or peritoneal metastases.\"],\r\n      options: [\r\n        {\r\n          text: \"Solid pancreatic mass identified, potentially resectable or borderline resectable\",\r\n          next: \"ca19_9_tissue_acquisition\"\r\n        },\r\n        {\r\n          text: \"Clearly unresectable locally advanced disease (e.g., extensive vascular encasement)\",\r\n          next: \"ca19_9_tissue_acquisition_unresectable\"\r\n        },\r\n        {\r\n          text: \"Metastatic disease identified on imaging\",\r\n          next: \"ca19_9_biopsy_metastatic_site\",\r\n          triggers: [\"pan_metastatic_imaging\"]\r\n        },\r\n        {\r\n          text: \"Cystic lesion of pancreas identified\",\r\n          next: \"pancreatic_cystic_lesion_pathway\" // Link to separate pathway for cystic neoplasms\r\n        },\r\n        {\r\n          text: \"No discrete mass, but diffuse changes or secondary signs (e.g. dilated pancreatic duct)\",\r\n          next: \"eus_evaluation_pancreas\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"pan_metastatic_imaging\",\r\n          condition: \"Evidence of metastatic disease (e.g., liver, lung, peritoneal metastases) on initial high-quality imaging.\",\r\n          message: \"Metastatic pancreatic cancer. Tissue diagnosis is needed, preferably from a metastatic site. Treatment is systemic.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Obtain CA 19-9.\",\r\n            \"Biopsy of an accessible metastatic lesion is preferred for diagnosis and molecular profiling.\",\r\n            \"Refer to Medical Oncologist.\",\r\n            \"Early Palliative Care consultation.\"\r\n          ],\r\n          urgency: \"Routine\",\r\n          actionType: \"Biopsy Planning & Oncology Referral\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"ca19_9_tissue_acquisition\",\r\n      title: \"CA 19-9 & Tissue Acquisition Strategy\",\r\n      description: \"Measure serum CA 19-9. Plan for tissue acquisition. EUS-FNA is preferred for most pancreatic head/body/tail lesions. CT-guided biopsy if EUS not feasible or for specific targets. Biopsy of suspected metastatic sites is preferred if M1 disease. For resectable disease without preoperative therapy planned, some centers proceed to surgery without biopsy if imaging is classic, but biopsy is generally recommended (NCCN PA-3).\",\r\n      expectedDuration: \"3-7 days (including EUS scheduling and procedure)\",\r\n      tooltip: \"CA 19-9 can be falsely normal in Lewis antigen negative individuals (~10%). EUS allows FNA and detailed local staging.\",\r\n      guidelineSource: \"NCCN PA-3 2024, ASGE Guideline 2022 (EUS)\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true, // To decide on biopsy necessity/approach for resectable cases\r\n      patientInfo: \"Explain CA 19-9 blood test. Discuss EUS/biopsy procedure, its purpose for confirming diagnosis and guiding treatment, risks (pancreatitis, bleeding, perforation).\",\r\n      pitfalls: [\"Not obtaining tissue prior to neoadjuvant therapy.\", \"Performing percutaneous biopsy through uninvolved peritoneum if potentially resectable (risk of seeding - though controversial and often unavoidable).\", \"Non-diagnostic biopsy delaying treatment.\"],\r\n      options: [\r\n        {\r\n          text: \"Pancreatic adenocarcinoma or other malignancy confirmed by biopsy\",\r\n          next: \"molecular_testing_staging_mdt\"\r\n        },\r\n        {\r\n          text: \"Biopsy non-diagnostic, but high suspicion remains\",\r\n          next: \"repeat_biopsy_alternative_approach\"\r\n        },\r\n        {\r\n          text: \"Benign pathology, concordant with less suspicious imaging\",\r\n          next: \"benign_pancreas_followup\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"molecular_testing_staging_mdt\",\r\n      title: \"Molecular Testing, Full Staging Review & MDT\",\r\n      description: \"For confirmed adenocarcinoma, perform germline testing for all patients (BRCA1/2, PALB2, ATM, Lynch syndrome genes, etc.). Somatic tumor testing (e.g., KRAS, NRG1, NTRK fusions, MSI/dMMR, HRD) for advanced/metastatic disease or if informing neoadjuvant/adjuvant choices (NCCN PA-4). Review all imaging with MDT (HPB surgeon, medical/radiation oncologist, radiologist, pathologist) to confirm resectability status (resectable, borderline, locally advanced unresectable, metastatic) using NCCN criteria. Consider staging laparoscopy for select cases (e.g. high CA19-9, large tumors, borderline resectable) to rule out occult peritoneal/liver mets.\",\r\n      expectedDuration: \"1-2 weeks (molecular testing can take time)\",\r\n      guidelineSource: \"NCCN PA-3, PA-4, PA-5 2024\",\r\n      evidenceLevel: \"I\",\r\n      requiresMDT: true,\r\n      patientInfo: \"Explain that genetic testing (blood and/or tumor) can identify specific mutations that might guide treatment. Discuss MDT review and its role in formulating the best treatment plan. Explain staging laparoscopy if considered.\",\r\n      pitfalls: [\"Not performing germline testing for all patients.\", \"Delay in obtaining molecular results for treatment decisions.\", \"Inaccurate staging due to lack of MDT review or omitting staging laparoscopy when indicated.\"],\r\n      options: [\r\n        {\r\n          text: \"Resectable disease confirmed by MDT\",\r\n          next: \"treatment_planning_resectable_pancreas\"\r\n        },\r\n        {\r\n          text: \"Borderline resectable disease confirmed by MDT\",\r\n          next: \"treatment_planning_borderline_pancreas\"\r\n        },\r\n        {\r\n          text: \"Locally advanced, unresectable disease confirmed by MDT\",\r\n          next: \"treatment_planning_locally_advanced_pancreas\"\r\n        },\r\n        {\r\n          text: \"Metastatic disease confirmed by MDT\",\r\n          next: \"treatment_planning_metastatic_pancreas\",\r\n          triggers: [\"pan_metastatic_mdt\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"pan_metastatic_mdt\",\r\n          condition: \"Metastatic pancreatic cancer confirmed after full workup and MDT review.\",\r\n          message: \"Definitive metastatic disease. Focus on systemic therapy and supportive/palliative care.\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Medical Oncology to lead systemic therapy (chemotherapy +/- targeted therapy based on molecular results).\",\r\n            \"Palliative care for symptom management, QoL, and goals of care.\",\r\n            \"Nutritional support, pain management, management of biliary/duodenal obstruction.\",\r\n            \"Discuss clinical trial options.\"\r\n          ],\r\n          urgency: \"Routine\", // Assuming prior referral if metastatic was suspected earlier\r\n          actionType: \"Systemic Therapy & Palliative Care\"\r\n        }\r\n      ]\r\n    }\r\n    // Further steps for treatment planning based on resectability, neoadjuvant/adjuvant therapy, surgical management, palliative care details etc.\r\n  ]\r\n};\r\n","import { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const bladderCancerPathway: StepBasedPathway = {\r\n  id: \"bladder\",\r\n  name: \"Bladder Cancer Diagnostic Pathway\",\r\n  description: \"Systematic approach to bladder cancer diagnosis and staging\",\r\n  recommendedTimeframe: \"2-3 weeks\",\r\n  steps: [\r\n    {\r\n      id: \"initial\",\r\n      title: \"Initial Assessment\",\r\n      description: \"Patient presents with hematuria or urinary symptoms\",\r\n      expectedDuration: \"1-2 days\",\r\n      tooltip: \"Document gross vs microscopic hematuria and associated symptoms\",\r\n      options: [\r\n        {\r\n          text: \"Gross hematuria\",\r\n          next: \"urgent_cystoscopy\",\r\n          triggers: [\"gross_bleeding\"]\r\n        },\r\n        {\r\n          text: \"Microscopic hematuria\",\r\n          next: \"initial_workup\"\r\n        },\r\n        {\r\n          text: \"Irritative symptoms\",\r\n          next: \"urinalysis\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"gross_bleeding\",\r\n          condition: \"Gross hematuria with clots\",\r\n          message: \"Active bleeding requiring evaluation\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Urgent urologic consultation\",\r\n            \"CBC and coagulation profile\",\r\n            \"Consider admission if heavy bleeding\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"urinalysis\",\r\n      title: \"Urinalysis and Cytology\",\r\n      description: \"Initial laboratory evaluation\",\r\n      expectedDuration: \"2-3 days\",\r\n      tooltip: \"Include urine cytology and culture if indicated\",\r\n      options: [\r\n        {\r\n          text: \"Positive cytology\",\r\n          next: \"cystoscopy\",\r\n          triggers: [\"positive_cytology\"]\r\n        },\r\n        {\r\n          text: \"Persistent hematuria\",\r\n          next: \"cystoscopy\"\r\n        },\r\n        {\r\n          text: \"Negative workup\",\r\n          next: \"risk_assessment\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"positive_cytology\",\r\n          condition: \"Positive urine cytology\",\r\n          message: \"Cytology suggesting malignancy\",\r\n          severity: \"warning\",\r\n          recommendations: [\r\n            \"Expedite cystoscopy\",\r\n            \"Consider upper tract imaging\",\r\n            \"Document smoking history\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"cystoscopy\",\r\n      title: \"Diagnostic Cystoscopy\",\r\n      description: \"Direct visualization of bladder mucosa\",\r\n      expectedDuration: \"1 day\",\r\n      tooltip: \"Document location, size, and number of lesions\",\r\n      options: [\r\n        {\r\n          text: \"Visible tumor\",\r\n          next: \"turbt\",\r\n          triggers: [\"visible_tumor\"]\r\n        },\r\n        {\r\n          text: \"Suspicious areas\",\r\n          next: \"biopsy\"\r\n        },\r\n        {\r\n          text: \"Normal cystoscopy\",\r\n          next: \"imaging\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"visible_tumor\",\r\n          condition: \"Visible bladder tumor\",\r\n          message: \"Tumor identified on cystoscopy\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Schedule TURBT within 2 weeks\",\r\n            \"Complete staging workup\",\r\n            \"Consider enhanced cystoscopy\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"imaging\",\r\n      title: \"Upper Tract Imaging\",\r\n      description: \"CT urogram or other appropriate imaging\",\r\n      expectedDuration: \"2-3 days\",\r\n      tooltip: \"Evaluate upper tracts and look for metastatic disease\",\r\n      options: [\r\n        {\r\n          text: \"Bladder mass\",\r\n          next: \"turbt\"\r\n        },\r\n        {\r\n          text: \"Upper tract lesion\",\r\n          next: \"specialized_evaluation\",\r\n          triggers: [\"upper_tract\"]\r\n        },\r\n        {\r\n          text: \"Metastatic disease\",\r\n          next: \"staging\",\r\n          triggers: [\"metastatic\"]\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"upper_tract\",\r\n          condition: \"Upper tract lesion\",\r\n          message: \"Suspicious upper tract finding\",\r\n          severity: \"warning\",\r\n          recommendations: [\r\n            \"Urology consultation\",\r\n            \"Consider ureteroscopy\",\r\n            \"Plan comprehensive evaluation\"\r\n          ]\r\n        },\r\n        {\r\n          id: \"metastatic\",\r\n          condition: \"Metastatic disease\",\r\n          message: \"Evidence of metastatic spread\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Tissue confirmation needed\",\r\n            \"Oncology consultation\",\r\n            \"Discuss treatment goals\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      id: \"turbt\",\r\n      title: \"TURBT\",\r\n      description: \"Transurethral resection of bladder tumor\",\r\n      expectedDuration: \"1-2 days\",\r\n      tooltip: \"Complete resection with muscle if possible\",\r\n      options: [\r\n        {\r\n          text: \"Non-muscle invasive\",\r\n          next: \"risk_stratification\"\r\n        },\r\n        {\r\n          text: \"Muscle invasive\",\r\n          next: \"staging\",\r\n          triggers: [\"muscle_invasive\"]\r\n        },\r\n        {\r\n          text: \"Incomplete resection\",\r\n          next: \"repeat_turbt\"\r\n        }\r\n      ],\r\n      redFlags: [\r\n        {\r\n          id: \"muscle_invasive\",\r\n          condition: \"Muscle invasive disease\",\r\n          message: \"Muscle invasion confirmed\",\r\n          severity: \"critical\",\r\n          recommendations: [\r\n            \"Complete staging workup\",\r\n            \"Multidisciplinary consultation\",\r\n            \"Discuss treatment options\",\r\n            \"Consider clinical trials\"\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n};\r\n","import { breastCancerPathway } from \"./breast\";\r\nimport { prostateCancerPathway } from \"./prostate\";\r\nimport { lungCancerPathway } from \"./lung\";\r\nimport { ovarianCancerPathway } from \"./ovarian\";\r\nimport { gastricCancerPathway } from \"./gastric\";\r\nimport { headNeckCancerPathway } from \"./head-neck\";\r\nimport { pancreaticCancerPathway } from \"./pancreatic\";\r\nimport { bladderCancerPathway } from \"./bladder\";\r\nimport { StepBasedPathway } from \"../../types/cancer-pathways\";\r\n\r\nexport const pathways: Record<string, StepBasedPathway> = {\r\n  breast: breastCancerPathway,\r\n  prostate: prostateCancerPathway,\r\n  lung: lungCancerPathway,\r\n  ovarian: ovarianCancerPathway,\r\n  gastric: gastricCancerPathway,\r\n  head_neck: headNeckCancerPathway,\r\n  pancreatic: pancreaticCancerPathway,\r\n  bladder: bladderCancerPathway\r\n};\r\n\r\nexport {\r\n  breastCancerPathway,\r\n  prostateCancerPathway,\r\n  lungCancerPathway,\r\n  ovarianCancerPathway,\r\n  gastricCancerPathway,\r\n  headNeckCancerPathway,\r\n  pancreaticCancerPathway,\r\n  bladderCancerPathway\r\n};\r\n","import React from \"react\";\r\nimport { RedFlag } from \"../../../types/cancer-pathways\";\r\nimport { AlertTriangle, AlertCircle } from \"lucide-react\";\r\n\r\ninterface RedFlagAlertProps {\r\n  redFlag: RedFlag;\r\n  onDismiss?: () => void;\r\n}\r\n\r\nconst RedFlagAlert: React.FC<RedFlagAlertProps> = ({ redFlag, onDismiss }) => {\r\n  const { severity, message, condition, recommendations } = redFlag;\r\n\r\n  return (\r\n    <div className={`p-4 rounded-lg border ${\r\n      severity === \"critical\" \r\n        ? \"bg-red-50 border-red-300\" \r\n        : \"bg-yellow-50 border-yellow-300\"\r\n    }`}>\r\n      <div className=\"flex items-start space-x-3\">\r\n        <div className=\"flex-shrink-0 mt-1\">\r\n          {severity === \"critical\" ? (\r\n            <AlertCircle className=\"w-5 h-5 text-red-600\" />\r\n          ) : (\r\n            <AlertTriangle className=\"w-5 h-5 text-yellow-600\" />\r\n          )}\r\n        </div>\r\n        <div className=\"flex-1\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className={`font-semibold ${\r\n              severity === \"critical\" ? \"text-red-800\" : \"text-yellow-800\"\r\n            }`}>\r\n              {condition}\r\n            </h3>\r\n            {onDismiss && (\r\n              <button\r\n                onClick={onDismiss}\r\n                className=\"text-gray-400 hover:text-gray-500\"\r\n              >\r\n                <span className=\"sr-only\">Dismiss</span>\r\n                <svg className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n            )}\r\n          </div>\r\n          <p className={`mt-1 text-sm ${\r\n            severity === \"critical\" ? \"text-red-700\" : \"text-yellow-700\"\r\n          }`}>\r\n            {message}\r\n          </p>\r\n          {recommendations && recommendations.length > 0 && (\r\n            <div className=\"mt-3\">\r\n              <h4 className={`text-sm font-medium ${\r\n                severity === \"critical\" ? \"text-red-800\" : \"text-yellow-800\"\r\n              }`}>\r\n                Recommendations:\r\n              </h4>\r\n              <ul className={`mt-2 text-sm space-y-1 list-disc list-inside ${\r\n                severity === \"critical\" ? \"text-red-700\" : \"text-yellow-700\"\r\n              }`}>\r\n                {recommendations.map((rec, index) => (\r\n                  <li key={index}>{rec}</li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RedFlagAlert;\r\n","import React from \"react\";\r\nimport { PathwaySummaryCard as PathwaySummaryType, RedFlag } from \"../../../types/cancer-pathways\";\r\nimport { CheckCircle, Clock, AlertTriangle } from \"lucide-react\";\r\nimport RedFlagAlert from \"./RedFlagAlert\";\r\n\r\ninterface PathwaySummaryCardProps {\r\n  summary: PathwaySummaryType;\r\n  onRedFlagDismiss?: (flagId: string) => void;\r\n}\r\n\r\nconst PathwaySummaryCard: React.FC<PathwaySummaryCardProps> = ({\r\n  summary,\r\n  onRedFlagDismiss,\r\n}) => {\r\n  const { totalSteps, completedSteps, activeRedFlags, estimatedTimeRemaining, nextRequiredActions } = summary;\r\n  \r\n  const progress = Math.round((completedSteps / totalSteps) * 100);\r\n  \r\n  const criticalFlags = activeRedFlags.filter(flag => flag.severity === \"critical\");\r\n  const warningFlags = activeRedFlags.filter(flag => flag.severity === \"warning\");\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow divide-y divide-gray-200\">\r\n      {/* Progress Section */}\r\n      <div className=\"p-6\">\r\n        <h3 className=\"text-lg font-medium text-gray-900\">Pathway Progress</h3>\r\n        <div className=\"mt-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <span className=\"text-sm font-medium text-gray-700\">\r\n              {completedSteps} of {totalSteps} steps completed\r\n            </span>\r\n            <span className=\"text-sm font-medium text-gray-700\">\r\n              {progress}%\r\n            </span>\r\n          </div>\r\n          <div className=\"mt-2 relative\">\r\n            <div className=\"h-2 bg-gray-100 rounded-full\">\r\n              <div\r\n                className={`absolute left-0 h-2 rounded-full ${\r\n                  progress === 100 ? \"bg-green-500\" : \"bg-blue-500\"\r\n                }`}\r\n                style={{ width: `${progress}%` }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Estimated Time */}\r\n        {estimatedTimeRemaining && (\r\n          <div className=\"mt-4 flex items-center text-sm text-gray-600\">\r\n            <Clock className=\"w-4 h-4 mr-2\" />\r\n            <span>Estimated time remaining: {estimatedTimeRemaining}</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Red Flags Section */}\r\n      {activeRedFlags.length > 0 && (\r\n        <div className=\"p-6 space-y-4\">\r\n          <h4 className=\"text-lg font-medium text-gray-900\">Active Red Flags</h4>\r\n          <div className=\"space-y-3\">\r\n            {criticalFlags.map(flag => (\r\n              <RedFlagAlert\r\n                key={flag.id}\r\n                redFlag={flag}\r\n                onDismiss={\r\n                  onRedFlagDismiss \r\n                    ? () => onRedFlagDismiss(flag.id)\r\n                    : undefined\r\n                }\r\n              />\r\n            ))}\r\n            {warningFlags.map(flag => (\r\n              <RedFlagAlert\r\n                key={flag.id}\r\n                redFlag={flag}\r\n                onDismiss={\r\n                  onRedFlagDismiss \r\n                    ? () => onRedFlagDismiss(flag.id)\r\n                    : undefined\r\n                }\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Next Actions Section */}\r\n      {nextRequiredActions.length > 0 && (\r\n        <div className=\"p-6\">\r\n          <h4 className=\"text-lg font-medium text-gray-900\">Next Required Actions</h4>\r\n          <ul className=\"mt-4 space-y-3\">\r\n            {nextRequiredActions.map((action, index) => (\r\n              <li key={index} className=\"flex items-start\">\r\n                <CheckCircle className=\"w-5 h-5 text-gray-400 mt-0.5 mr-3\" />\r\n                <span className=\"text-gray-600\">{action}</span>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n\r\n      {/* AI Assistant Button */}\r\n      <div className=\"p-6\">\r\n        <button\r\n          className=\"w-full flex justify-center items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\r\n          onClick={() => {\r\n            // TODO: Implement AI suggestion generation\r\n            console.log(\"Generate AI suggestions\");\r\n          }}\r\n        >\r\n          <svg \r\n            className=\"w-5 h-5 mr-2\" \r\n            fill=\"none\" \r\n            stroke=\"currentColor\" \r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path \r\n              strokeLinecap=\"round\" \r\n              strokeLinejoin=\"round\" \r\n              strokeWidth={2} \r\n              d=\"M13 10V3L4 14h7v7l9-11h-7z\" \r\n            />\r\n          </svg>\r\n          Get AI Suggestions\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PathwaySummaryCard;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { StepBasedPathway, PathwayProgress, PathwaySummaryCard as PathwaySummaryType } from \"../../../types/cancer-pathways\";\r\nimport PathwaySummaryCard from \"../components/PathwaySummaryCard\";\r\nimport { Info } from \"lucide-react\";\r\n\r\ninterface Props {\r\n  pathway: StepBasedPathway;\r\n}\r\n\r\nconst DecisionTree: React.FC<Props> = ({ pathway }) => {\r\n  const [currentStepId, setCurrentStepId] = useState(\"initial\");\r\n  const [progress, setProgress] = useState<PathwayProgress>({\r\n    completedSteps: [],\r\n    currentStep: \"initial\",\r\n    redFlagsTriggered: [],\r\n    timeStarted: Date.now()\r\n  });\r\n\r\n  const currentStep = pathway.steps.find(step => step.id === currentStepId);\r\n\r\n  // Calculate summary for the progress card\r\n  const calculateSummary = (): PathwaySummaryType => {\r\n    const totalSteps = pathway.steps.length;\r\n    const completedSteps = progress.completedSteps.length;\r\n    \r\n    // Get active red flags from completed steps\r\n    const activeRedFlags = pathway.steps\r\n      .filter(step => progress.redFlagsTriggered.some(flagId => \r\n        step.redFlags?.some(flag => flag.id === flagId)\r\n      ))\r\n      .flatMap(step => step.redFlags || [])\r\n      .filter(flag => progress.redFlagsTriggered.includes(flag.id));\r\n\r\n    // Calculate estimated time remaining based on pathway recommendedTimeframe\r\n    const estimatedTimeRemaining = pathway.recommendedTimeframe \r\n      ? `${pathway.recommendedTimeframe} (estimated)`\r\n      : undefined;\r\n\r\n    // Determine next actions based on current step\r\n    const nextRequiredActions = currentStep \r\n      ? [currentStep.description, ...(currentStep.redFlags || []).flatMap(flag => flag.recommendations)]\r\n      : [];\r\n\r\n    return {\r\n      totalSteps,\r\n      completedSteps,\r\n      activeRedFlags,\r\n      estimatedTimeRemaining,\r\n      nextRequiredActions\r\n    };\r\n  };\r\n\r\n  const handleOptionSelect = (nextId: string, triggers?: string[]) => {\r\n    // Track completed step\r\n    setProgress(prev => ({\r\n      ...prev,\r\n      completedSteps: [...prev.completedSteps, currentStepId],\r\n      currentStep: nextId,\r\n      redFlagsTriggered: [\r\n        ...prev.redFlagsTriggered,\r\n        ...(triggers || [])\r\n      ]\r\n    }));\r\n    setCurrentStepId(nextId);\r\n  };\r\n\r\n  const dismissRedFlag = (flagId: string) => {\r\n    setProgress(prev => ({\r\n      ...prev,\r\n      redFlagsTriggered: prev.redFlagsTriggered.filter(id => id !== flagId)\r\n    }));\r\n  };\r\n\r\n  if (!currentStep) {\r\n    return (\r\n      <div className=\"p-4 rounded-md bg-red-50 text-red-700\">\r\n        Error: Step not found for ID \"{currentStepId}\"\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Current Step Card */}\r\n      <div className=\"bg-white rounded-lg shadow p-6\">\r\n        <div className=\"flex items-start justify-between\">\r\n          <div>\r\n            <h2 className=\"text-xl font-bold text-gray-800\">{currentStep.title}</h2>\r\n            <p className=\"mt-2 text-gray-700\">{currentStep.description}</p>\r\n          </div>\r\n          {currentStep.tooltip && (\r\n            <div className=\"group relative\">\r\n              <Info className=\"w-5 h-5 text-gray-400 hover:text-gray-500 cursor-help\" />\r\n              <div className=\"invisible group-hover:visible absolute right-0 w-64 p-2 mt-2 text-sm text-gray-600 bg-white rounded-lg shadow-lg border border-gray-200\">\r\n                {currentStep.tooltip}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {currentStep.expectedDuration && (\r\n          <div className=\"mt-4 text-sm text-gray-600\">\r\n            Expected duration: {currentStep.expectedDuration}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Progress Summary */}\r\n      <PathwaySummaryCard \r\n        summary={calculateSummary()} \r\n        onRedFlagDismiss={dismissRedFlag}\r\n      />\r\n\r\n      {/* Options */}\r\n      <div className=\"space-y-4\">\r\n        {currentStep.options.map((option, index) => (\r\n          <button\r\n            key={index}\r\n            onClick={() => handleOptionSelect(option.next, option.triggers)}\r\n            className=\"w-full py-3 px-4 rounded-md bg-indigo-600 hover:bg-indigo-700 text-white font-medium text-left\"\r\n          >\r\n            {option.text}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DecisionTree;\r\n","import React, { useState } from \"react\";\r\nimport { pathways } from \"../../../data/cancer-pathways\";\r\nimport DecisionTree from \"./DecisionTree\";\r\nimport { CancerType } from \"../../../types/cancer-pathways\";\r\nimport { \r\n  Book, \r\n  Activity, \r\n  Brain, \r\n  Heart, \r\n  CircleDot,\r\n  Stethoscope, \r\n  Dna, \r\n  Waves \r\n} from \"lucide-react\";\r\n\r\nconst DiagnosticPathways: React.FC = () => {\r\n  const [selectedCancer, setSelectedCancer] = useState<CancerType | null>(null);\r\n\r\n  const cancerIcons: Record<CancerType, React.ReactNode> = {\r\n    breast: (\r\n      <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n      </svg>\r\n    ),\r\n    prostate: <Activity className=\"w-6 h-6\" />,\r\n    lung: (\r\n      <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11c0-4.4-3.6-8-8-8S3 6.6 3 11c0 2.5 1.2 4.8 3 6.2V21h12v-3.8c1.8-1.4 3-3.7 3-6.2z\" />\r\n      </svg>\r\n    ),\r\n    ovarian: <Dna className=\"w-6 h-6\" />,\r\n    gastric: (\r\n      <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 13.87C6 16.15 7.57 18 9.46 18H14.54C16.43 18 18 16.15 18 13.87C18 10.5 14 9 12 9C10 9 6 10.5 6 13.87Z\" />\r\n      </svg>\r\n    ),\r\n    head_neck: <Stethoscope className=\"w-6 h-6\" />,\r\n    pancreatic: <Heart className=\"w-6 h-6\" />,\r\n    bladder: <Waves className=\"w-6 h-6\" />,\r\n    colorectal: <CircleDot className=\"w-6 h-6\" />,\r\n    lymphoma: <Brain className=\"w-6 h-6\" />\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800\">Diagnostic Pathways</h2>\r\n        {selectedCancer && (\r\n          <button\r\n            onClick={() => setSelectedCancer(null)}\r\n            className=\"text-sm text-gray-600 hover:text-gray-800 flex items-center\"\r\n          >\r\n            <svg className=\"w-5 h-5 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n            </svg>\r\n            Back to Cancer Types\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {!selectedCancer ? (\r\n        <div className=\"grid gap-6\">\r\n          <div className=\"p-4 bg-white rounded-lg shadow border border-gray-200\">\r\n            <h3 className=\"text-xl font-semibold text-gray-800 mb-4\">Select Cancer Type</h3>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              {Object.entries(pathways).map(([type, pathway]) => (\r\n                <button\r\n                  key={type}\r\n                  onClick={() => setSelectedCancer(type as CancerType)}\r\n                  className=\"p-4 text-left bg-blue-50 hover:bg-blue-100 rounded-lg border border-blue-200 flex items-start space-x-3\"\r\n                >\r\n                  <div className=\"text-blue-600\">\r\n                    {cancerIcons[type as CancerType]}\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"font-semibold text-blue-800\">{pathway.name}</h4>\r\n                    <p className=\"text-sm text-blue-600 mt-1\">{pathway.description}</p>\r\n                    {pathway.recommendedTimeframe && (\r\n                      <p className=\"text-sm text-blue-500 mt-2\">\r\n                        Typical timeline: {pathway.recommendedTimeframe}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"p-4 bg-white rounded-lg shadow border border-gray-200\">\r\n            <div className=\"flex items-start space-x-3\">\r\n              <Book className=\"w-6 h-6 text-gray-400\" />\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-gray-800\">About Diagnostic Pathways</h3>\r\n                <p className=\"mt-2 text-gray-600\">\r\n                  Select a cancer type above to view its specific diagnostic pathway. Each pathway provides:\r\n                </p>\r\n                <ul className=\"mt-2 space-y-2 text-gray-600 list-disc list-inside\">\r\n                  <li>Step-by-step diagnostic guidance</li>\r\n                  <li>Red flag alerts for critical findings</li>\r\n                  <li>Expected timelines and progress tracking</li>\r\n                  <li>AI-powered suggestions and summaries</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div className=\"bg-white rounded-lg shadow border border-gray-200 p-6\">\r\n          <DecisionTree pathway={pathways[selectedCancer]} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DiagnosticPathways;\r\n","import { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from '@google/generative-ai';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { AIError } from '@/types/ai-agent';\r\n\r\nconst MODEL_NAME = 'gemini-pro';\r\nconst MAX_RETRIES = 3;\r\nconst RETRY_DELAY = 1000;\r\n\r\nconst safetySettings = [\r\n  {\r\n    category: HarmCategory.HARM_CATEGORY_HARASSMENT,\r\n    threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,\r\n  },\r\n  {\r\n    category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,\r\n    threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,\r\n  },\r\n  {\r\n    category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,\r\n    threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,\r\n  },\r\n  {\r\n    category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,\r\n    threshold: HarmBlockThreshold.BLOCK_MEDIUM_AND_ABOVE,\r\n  },\r\n];\r\n\r\nclass GeminiError extends Error implements AIError {\r\n  code: string;\r\n  statusCode: number;\r\n\r\n  constructor(message: string, code: string, statusCode: number = 500) {\r\n    super(message);\r\n    this.name = 'GeminiError';\r\n    this.code = code;\r\n    this.statusCode = statusCode;\r\n  }\r\n}\r\n\r\nfunction validateApiKey(): string {\r\n  const API_KEY = import.meta?.env?.VITE_GEMINI_API_KEY ?? process?.env?.VITE_GEMINI_API_KEY ?? '';\r\n  if (!API_KEY) {\r\n    throw new GeminiError('Gemini API key not configured', 'API_KEY_MISSING', 400);\r\n  }\r\n  return API_KEY;\r\n}\r\n\r\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\nasync function retryWithBackoff<T>(\r\n  fn: () => Promise<T>,\r\n  retries: number = MAX_RETRIES\r\n): Promise<T> {\r\n  try {\r\n    return await fn();\r\n  } catch (error) {\r\n    if (retries <= 0) throw error;\r\n    \r\n    // Don't retry certain errors\r\n    if (error instanceof GeminiError && \r\n        ['API_KEY_MISSING', 'INVALID_RESPONSE', 'RATE_LIMIT_EXCEEDED'].includes(error.code)) {\r\n      throw error;\r\n    }\r\n    \r\n    await delay(RETRY_DELAY * (MAX_RETRIES - retries + 1));\r\n    return retryWithBackoff(fn, retries - 1);\r\n  }\r\n}\r\n\r\nfunction validateJsonSafety(text: string): { valid: boolean; sanitized?: string } {\r\n  try {\r\n    // Test if the string can be safely stringified and parsed\r\n    const parsed = JSON.parse(JSON.stringify(text));\r\n    return { valid: true, sanitized: parsed };\r\n  } catch (error) {\r\n    return { valid: false };\r\n  }\r\n}\r\n\r\nexport async function generateGeminiResponse(prompt: string, context?: string, history?: string[]) {\r\n  // Validate API key first\r\n  const apiKey = validateApiKey();\r\n\r\n  return retryWithBackoff(async () => {\r\n    try {\r\n      const genAI = new GoogleGenerativeAI(apiKey);\r\n      const model = genAI.getGenerativeModel({ \r\n        model: MODEL_NAME,\r\n        safetySettings\r\n      });\r\n\r\n      // Construct the chat\r\n      const messages = [];\r\n      if (context) {\r\n        messages.push({ role: 'user' as const, parts: [{ text: `Context: ${context}` }] });\r\n      }\r\n      if (history?.length) {\r\n        for (const msg of history) {\r\n          messages.push({ role: 'user' as const, parts: [{ text: msg }] });\r\n        }\r\n      }\r\n      messages.push({ role: 'user' as const, parts: [{ text: prompt }] });\r\n\r\n      const chat = model.startChat({\r\n        history: messages,\r\n        generationConfig: {\r\n          temperature: 0.7,\r\n          topK: 40,\r\n          topP: 0.95,\r\n          maxOutputTokens: 1024,\r\n        },\r\n      });\r\n\r\n      const result = await chat.sendMessage(prompt);\r\n      const response = await result.response;\r\n      const text = response.text();\r\n\r\n      // Validate response\r\n      const validation = validateJsonSafety(text);\r\n      if (!validation.valid || !validation.sanitized) {\r\n        throw new Error('Response contains invalid JSON characters');\r\n      }\r\n\r\n      return {\r\n        id: uuidv4(),\r\n        content: validation.sanitized,\r\n        timestamp: new Date().toISOString(),\r\n        metadata: {\r\n          model: MODEL_NAME\r\n        }\r\n      };\r\n\r\n    } catch (error) {\r\n      if (error instanceof GeminiError) {\r\n        throw error;\r\n      }\r\n\r\n      if (error instanceof Error) {\r\n        // Pass through the original error message for expected error types\r\n        if (\r\n          error.message.includes('API quota exceeded') ||\r\n          error.message.includes('Network error') ||\r\n          error.message.includes('Response contains invalid JSON characters')\r\n        ) {\r\n          throw new Error(error.message);\r\n        }\r\n\r\n        // Check for network related errors\r\n        if (\r\n          error.message.toLowerCase().includes('network') ||\r\n          error.message.toLowerCase().includes('fetch') ||\r\n          error.message.toLowerCase().includes('connection')\r\n        ) {\r\n          throw new Error('Network error');\r\n        }\r\n\r\n        throw new GeminiError(\r\n          `Failed to generate response: ${error.message}`,\r\n          'GENERATION_FAILED',\r\n          500\r\n        );\r\n      }\r\n\r\n      throw new GeminiError('Unknown error occurred', 'UNKNOWN_ERROR', 500);\r\n    }\r\n  });\r\n}","import { ModuleType, PromptIntent, AIResponse } from '@/components/ai-agent/types';\r\nimport { promptBuilder } from '@/components/ai-agent/promptBuilder';\r\nimport OpenAI from 'openai';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { generateGeminiResponse, generateGeminiChat } from '@/lib/gemini';\r\nimport { getOfflineResponse } from '../../components/ai-agent/mockResponses';\r\n\r\n// Mock responses for development\r\nconst mockResponses: Record<ModuleType, Record<PromptIntent, string[]>> = {\r\n  OPD: {\r\n    screening: [\r\n      \"Based on the patient's age and risk factors, recommended screening includes annual mammography and colonoscopy every 10 years.\",\r\n      \"Given the family history, consider genetic counseling and BRCA testing.\",\r\n    ],\r\n    triage: [\r\n      \"Patient requires urgent evaluation due to severe symptoms.\",\r\n      \"Routine follow-up recommended in 3 months.\",\r\n    ]\r\n  } as Record<PromptIntent, string[]>,\r\n  CDU: {\r\n    toxicity: [\r\n      \"Grade 3 neutropenia detected. Consider G-CSF support and dose reduction.\",\r\n      \"Mild peripheral neuropathy - continue monitoring, consider vitamin B6.\",\r\n    ]\r\n  } as Record<PromptIntent, string[]>,\r\n  Inpatient: {} as Record<PromptIntent, string[]>,\r\n  Palliative: {} as Record<PromptIntent, string[]>,\r\n  RadOnc: {} as Record<PromptIntent, string[]>\r\n};\r\n\r\ninterface AIAgentParams {\r\n  module: ModuleType;\r\n  intent: PromptIntent;\r\n  prompt: string;\r\n  context?: string;\r\n  mockMode?: boolean;\r\n  history?: string[];\r\n  iterationCount?: number;\r\n  previousResponse?: string;\r\n  feedbackType?: 'refine' | 'elaborate' | 'correct';\r\n}\r\n\r\n// Initialize OpenAI client with Vite environment variable\r\nconst openai = new OpenAI({\r\n  apiKey: import.meta.env.VITE_OPENAI_API_KEY,\r\n  dangerouslyAllowBrowser: true // Since we're using Vite, enable browser usage\r\n});\r\n\r\nclass APIError extends Error {\r\n  constructor(message: string, public code: string) {\r\n    super(message);\r\n    this.name = 'APIError';\r\n  }\r\n}\r\n\r\nexport const aiAgentAPI = {\r\n  /**\r\n   * Gets an AI response for the given prompt, module, and intent\r\n   * @throws {APIError} If the API call fails or returns invalid data\r\n   */\r\n  async getResponse(\r\n    prompt: string, \r\n    module: ModuleType, \r\n    intent: PromptIntent\r\n  ): Promise<AIResponse> {\r\n    try {\r\n      // Generate specialized prompt using promptBuilder\r\n      const enhancedPrompt = promptBuilder(module, intent, prompt);\r\n\r\n      // Call OpenAI API\r\n      const completion = await openai.chat.completions.create({\r\n        model: \"gpt-4-turbo-preview\",\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: \"You are an expert oncology AI assistant. Provide evidence-based recommendations following current clinical guidelines.\"\r\n          },\r\n          {\r\n            role: \"user\",\r\n            content: enhancedPrompt\r\n          }\r\n        ],\r\n        temperature: 0.7,\r\n        max_tokens: 1000\r\n      });\r\n\r\n      // Validate response\r\n      const content = completion.choices[0]?.message?.content;\r\n      if (!content) {\r\n        throw new APIError(\"Empty response from AI\", \"EMPTY_RESPONSE\");\r\n      }\r\n\r\n      // Format response with markdown if it contains structured sections\r\n      const markdown = content.includes('#') || content.includes('-') ? content : null;\r\n\r\n      // Return formatted response\r\n      return {\r\n        id: uuidv4(),\r\n        content,\r\n        timestamp: new Date(), // Changed from toISOString()\r\n        metadata: {\r\n          module,\r\n          intent,\r\n          model: 'gpt-4-turbo-preview'\r\n        }\r\n      };\r\n\r\n    } catch (error: any) {\r\n      // Handle different types of errors\r\n      if (error.name === 'APIError') {\r\n        throw error;\r\n      }\r\n      \r\n      if (error.code === 'ETIMEDOUT' || error.code === 'ECONNREFUSED') {\r\n        throw new APIError('Unable to connect to AI service', 'CONNECTION_ERROR');\r\n      }\r\n\r\n      if (error.response?.status === 429) {\r\n        throw new APIError('Rate limit exceeded', 'RATE_LIMIT');\r\n      }\r\n\r\n      // Generic error with original message\r\n      throw new APIError(\r\n        error.message || 'Failed to get AI response',\r\n        'UNKNOWN_ERROR'\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nfunction getMockResponse(module: string, intent: string): string {\r\n  const moduleResponses = mockResponses[module as keyof typeof mockResponses];\r\n  if (!moduleResponses) {\r\n    return \"Mock response not found for this module.\";\r\n  }\r\n  \r\n  const intentResponses = moduleResponses[intent as keyof typeof moduleResponses];\r\n  if (!intentResponses) {\r\n    return \"Mock response not found for this intent.\";\r\n  }\r\n  \r\n  const randomIndex = Math.floor(Math.random() * intentResponses.length);\r\n  return intentResponses[randomIndex];\r\n}\r\n\r\nexport async function callAIAgent({\r\n  module,\r\n  intent,\r\n  prompt,\r\n  context,\r\n  mockMode,\r\n  iterationCount = 0,\r\n  previousResponse,\r\n  feedbackType,\r\n  history = []\r\n}: AIAgentParams): Promise<AIResponse> {\r\n  if (mockMode) {\r\n    return {\r\n      id: uuidv4(),\r\n      content: getMockResponse(module, intent),\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        module,\r\n        intent,\r\n        model: 'mock'\r\n      }\r\n    };\r\n  }\r\n\r\n  // Handle iteration-based feedback with more natural prompts\r\n  let enhancedPrompt = prompt;\r\n  if (iterationCount > 0 && previousResponse) {\r\n    const base = `Previous response:\\n${previousResponse}\\n\\nUser feedback:\\n${prompt}`;\r\n    \r\n    enhancedPrompt = feedbackType === 'refine'\r\n      ? `Please refine and improve the previous response, focusing on accuracy and clarity.\\n${base}`\r\n      : feedbackType === 'elaborate'\r\n      ? `Please provide more detailed information and examples to elaborate on the previous response.\\n${base}`\r\n      : feedbackType === 'correct'\r\n      ? `Please correct any errors or inaccuracies in the previous response, ensuring medical accuracy.\\n${base}`\r\n      : `Please continue with this additional context:\\n${base}`;\r\n  }\r\n\r\n  // Construct a comprehensive prompt with full context\r\n  const fullPrompt = `\r\nContext:\r\n${context || 'No specific context provided'}\r\n\r\nModule: ${module}\r\nIntent: ${intent}\r\n\r\nHistory:\r\n${history.length > 0 ? history.join('\\n\\n') : 'No previous history'}\r\n\r\nCurrent Task:\r\n${enhancedPrompt}\r\n\r\nPlease provide a comprehensive response suitable for a medical professional.`;\r\n\r\n  try {\r\n    const response = await generateGeminiResponse(fullPrompt);\r\n    \r\n    return {\r\n      id: uuidv4(),\r\n      content: response,\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        module,\r\n        intent,\r\n        model: 'gemini'\r\n      }\r\n    };\r\n  } catch (error) {\r\n    throw new APIError(\r\n      error instanceof Error ? error.message : 'Failed to get AI response',\r\n      'GEMINI_API_ERROR'\r\n    );\r\n  }\r\n}\r\n\r\n// Retry wrapper with exponential backoff\r\nexport async function callAIAgentWithRetry(\r\n  params: AIAgentParams,\r\n  maxRetries = 3\r\n): Promise<AIResponse> {\r\n  for (let i = 0; i < maxRetries; i++) {\r\n    try {\r\n      return await callAIAgent(params);\r\n    } catch (error) {\r\n      if (i === maxRetries - 1) throw error;\r\n      await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));\r\n    }\r\n  }\r\n  throw new Error('Maximum retries exceeded');\r\n}","import React, { useState } from 'react';\r\nimport { AlertTriangle, ChevronDown, ChevronUp, Download, MessageSquare } from 'lucide-react';\r\nimport { toast } from 'react-toastify';\r\nimport { callAIAgent } from '@/lib/api/aiAgentAPI';\r\n\r\n// Types\r\ntype Gender = 'male' | 'female';\r\n\r\ninterface GeneticRisk {\r\n  brcaPositive: boolean;\r\n  lynchSyndrome: boolean;\r\n  otherSyndrome?: string;\r\n}\r\n\r\ninterface RiskFactors {\r\n  priorCancer: boolean;\r\n  immunocompromised: boolean;\r\n  radiationExposure: boolean;\r\n  geneticRisk: GeneticRisk;\r\n}\r\n\r\ninterface Symptoms {\r\n  weightLoss: boolean;\r\n  abdominalPain: boolean;\r\n  backPain: boolean;\r\n  jaundice: boolean;\r\n  bloating: boolean;\r\n  earlySatiety: boolean;\r\n  hoarseness: boolean;\r\n  dysphagia: boolean;\r\n  earPain: boolean;\r\n  vomiting: boolean;\r\n  bleeding: boolean;\r\n  fever: boolean;\r\n  nightSweats: boolean;\r\n}\r\n\r\ninterface PatientData {\r\n  age: number;\r\n  gender: Gender;\r\n  smokingHistory: boolean;\r\n  packYears?: number;\r\n  isHighRisk: boolean;\r\n  riskFactors: RiskFactors;\r\n  familyHistory: {\r\n    breast: boolean;\r\n    colorectal: boolean;\r\n    prostate: boolean;\r\n    ovarian: boolean;\r\n  };\r\n  lastScreening: {\r\n    mammogram: string;\r\n    colonoscopy: string;\r\n    papSmear: string;\r\n    ldct: string;\r\n    psa: string;\r\n    breastMri: string;\r\n    endoscopy: string;\r\n    ctAbdomen: string;\r\n  };\r\n  activeSymptoms: Symptoms;\r\n}\r\n\r\ntype CancerType = \r\n  | 'breast' \r\n  | 'cervical' \r\n  | 'colorectal' \r\n  | 'lung' \r\n  | 'prostate'\r\n  | 'pancreatic'\r\n  | 'ovarian'\r\n  | 'gastric'\r\n  | 'headNeck'\r\n  | 'lymphoma';\r\n\r\ninterface SymptomWarning {\r\n  severity: 'low' | 'moderate' | 'high';\r\n  description: string;\r\n  suggestedAction: string;\r\n}\r\n\r\ninterface ScreeningRecommendation {\r\n  cancerType: CancerType;\r\n  status: 'due' | 'upcoming' | 'not-indicated';\r\n  reason: string;\r\n  nextDue?: string;\r\n  isOverdue?: boolean;\r\n}\r\n\r\ninterface ScreeningResults {\r\n  breast?: ScreeningRecommendation;\r\n  cervical?: ScreeningRecommendation;\r\n  colorectal: ScreeningRecommendation;\r\n  lung: ScreeningRecommendation;\r\n  prostate?: ScreeningRecommendation;\r\n  pancreatic?: ScreeningRecommendation;\r\n  ovarian?: ScreeningRecommendation;\r\n  gastric?: ScreeningRecommendation;\r\n  headNeck?: ScreeningRecommendation;\r\n  lymphoma?: ScreeningRecommendation;\r\n  [key: string]: ScreeningRecommendation | undefined;\r\n}\r\n\r\ninterface GenerateSummaryParams {\r\n  prompt: string;\r\n  context: string;\r\n}\r\n\r\ninterface ToastParams {\r\n  title?: string;\r\n  description: string;\r\n  duration?: number;\r\n  variant?: 'default' | 'destructive';\r\n}\r\n\r\nconst CancerScreening: React.FC = () => {\r\n  const [mockMode, setMockMode] = useState(false);\r\n  type LastScreeningKey = keyof PatientData['lastScreening'];\r\n\r\n  // State\r\n  const [patientData, setPatientData] = useState<PatientData>({\r\n    age: 0,\r\n    gender: 'female',\r\n    smokingHistory: false,\r\n    packYears: 0,\r\n    isHighRisk: false,\r\n    riskFactors: {\r\n      priorCancer: false,\r\n      immunocompromised: false,\r\n      radiationExposure: false,\r\n      geneticRisk: {\r\n        brcaPositive: false,\r\n        lynchSyndrome: false\r\n      }\r\n    },\r\n    familyHistory: {\r\n      breast: false,\r\n      colorectal: false,\r\n      prostate: false,\r\n      ovarian: false,\r\n    },\r\n    lastScreening: {\r\n      mammogram: '',\r\n      colonoscopy: '',\r\n      papSmear: '',\r\n      ldct: '',\r\n      psa: '',\r\n      breastMri: '',\r\n      endoscopy: '',\r\n      ctAbdomen: ''\r\n    },\r\n    activeSymptoms: {\r\n      weightLoss: false,\r\n      abdominalPain: false,\r\n      backPain: false,\r\n      jaundice: false,\r\n      bloating: false,\r\n      earlySatiety: false,\r\n      hoarseness: false,\r\n      dysphagia: false,\r\n      earPain: false,\r\n      vomiting: false,\r\n      bleeding: false,\r\n      fever: false,\r\n      nightSweats: false\r\n    }\r\n  });\r\n\r\n  const [expandedPanels, setExpandedPanels] = useState<{ [key: string]: boolean }>({\r\n    breast: true,\r\n    cervical: true,\r\n    colorectal: true,\r\n    lung: true,\r\n    prostate: true\r\n  });\r\n\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Helper functions for type checking and event handling\r\n  const handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>): boolean => {\r\n    return e.target.checked;\r\n  };\r\n\r\n  const isValidDate = (date: string): boolean => {\r\n    return date !== undefined && date !== null && date.length > 0;\r\n  };\r\n\r\n  const getYearsSince = (date: string): number => {\r\n    return isValidDate(date) ? new Date().getFullYear() - new Date(date).getFullYear() : Infinity;\r\n  };\r\n\r\n  // Helper functions for risk assessment and symptoms\r\n  const getSymptomBasedCancers = (): CancerType[] => {\r\n    const symptoms = patientData.activeSymptoms;\r\n    const concerns: CancerType[] = [];\r\n\r\n    // Pancreatic cancer symptoms\r\n    if (symptoms.weightLoss && (symptoms.backPain || symptoms.jaundice)) {\r\n      concerns.push('pancreatic');\r\n    }\r\n\r\n    // Ovarian cancer symptoms\r\n    if (symptoms.bloating && symptoms.earlySatiety && patientData.gender === 'female') {\r\n      concerns.push('ovarian');\r\n    }\r\n\r\n    // Head & neck cancer symptoms\r\n    if (symptoms.hoarseness || symptoms.dysphagia || symptoms.earPain) {\r\n      concerns.push('headNeck');\r\n    }\r\n\r\n    // Gastric cancer symptoms\r\n    if (symptoms.vomiting || symptoms.bleeding) {\r\n      concerns.push('gastric');\r\n    }\r\n\r\n    // Lymphoma symptoms\r\n    if ((symptoms.fever || symptoms.nightSweats) && symptoms.weightLoss) {\r\n      concerns.push('lymphoma');\r\n    }\r\n\r\n    return concerns;\r\n  };\r\n\r\n  const getHighRiskInterval = (standardInterval: number): number => {\r\n    if (!patientData.isHighRisk) return standardInterval;\r\n\r\n    // Reduce intervals for high-risk patients\r\n    if (patientData.riskFactors.geneticRisk.brcaPositive) return Math.max(6, standardInterval / 2);\r\n    if (patientData.riskFactors.geneticRisk.lynchSyndrome) return Math.max(1, standardInterval / 2);\r\n    if (patientData.riskFactors.priorCancer) return Math.max(6, standardInterval * 0.75);\r\n    \r\n    return standardInterval;\r\n  };\r\n\r\n  // Helper function to calculate screening recommendations\r\n  const calculateRecommendations = (): ScreeningResults => {\r\n    const results: ScreeningResults = {\r\n      colorectal: { \r\n        cancerType: 'colorectal',\r\n        status: 'not-indicated', \r\n        reason: 'Age below screening threshold' \r\n      },\r\n      lung: { \r\n        cancerType: 'lung',\r\n        status: 'not-indicated', \r\n        reason: 'Not meeting screening criteria' \r\n      }\r\n    };\r\n\r\n    // Colorectal Cancer Screening\r\n    if (patientData.age >= 45) {\r\n      const lastColonoscopy = patientData.lastScreening.colonoscopy;\r\n      const yearsSinceColonoscopy = getYearsSince(lastColonoscopy);\r\n      if (!isValidDate(lastColonoscopy)) {\r\n        results.colorectal = {\r\n          cancerType: 'colorectal',\r\n          status: 'due',\r\n          reason: 'Initial screening colonoscopy needed',\r\n          isOverdue: patientData.age > 45\r\n        };\r\n      } else {\r\n        if (yearsSinceColonoscopy >= 10) {\r\n          results.colorectal = {\r\n            cancerType: 'colorectal',\r\n            status: 'due',\r\n            reason: 'Follow-up colonoscopy needed',\r\n            isOverdue: true\r\n          };\r\n        } else if (yearsSinceColonoscopy >= 8) {\r\n          results.colorectal = {\r\n            cancerType: 'colorectal',\r\n            status: 'upcoming',\r\n            reason: 'Colonoscopy due within 2 years',\r\n            nextDue: lastColonoscopy\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    // Add symptom-based warnings\r\n    const concernedCancers = getSymptomBasedCancers();\r\n    if (concernedCancers.length > 0) {\r\n      concernedCancers.forEach(cancerType => {\r\n        results[cancerType] = {\r\n          cancerType,\r\n          status: 'due',\r\n          reason: 'Concerning symptoms present - requires immediate evaluation',\r\n          isOverdue: true\r\n        };\r\n      });\r\n    }\r\n\r\n    // Gender-specific screenings\r\n    if (patientData.gender === 'female') {\r\n      // Breast Cancer Screening\r\n      if (patientData.age >= 40 && patientData.age <= 74) {\r\n        const lastMammogram = patientData.lastScreening.mammogram;\r\n        results.breast = {\r\n          cancerType: 'breast',\r\n          status: !isValidDate(lastMammogram) || getYearsSince(lastMammogram) >= 1 \r\n            ? 'due' \r\n            : 'upcoming',\r\n          reason: patientData.familyHistory.breast \r\n            ? 'High-risk patient requires more frequent screening'\r\n            : patientData.isHighRisk \r\n              ? 'Modified screening interval due to risk factors'\r\n              : 'Regular annual screening recommended',\r\n          isOverdue: isValidDate(lastMammogram) && getYearsSince(lastMammogram) > 1\r\n        };\r\n      }\r\n\r\n      // Cervical Cancer Screening\r\n      if (patientData.age >= 21 && patientData.age <= 65) {\r\n        const lastPap = patientData.lastScreening.papSmear;\r\n        results.cervical = {\r\n          cancerType: 'cervical',\r\n          status: !isValidDate(lastPap) || getYearsSince(lastPap) >= 3\r\n            ? 'due'\r\n            : 'upcoming',\r\n          reason: patientData.age >= 30 \r\n            ? 'Co-testing with HPV recommended every 5 years'\r\n            : 'Pap smear recommended every 3 years',\r\n          isOverdue: isValidDate(lastPap) && getYearsSince(lastPap) > 3\r\n        };\r\n      }\r\n    }\r\n\r\n    // Prostate Cancer Screening\r\n    if (patientData.gender === 'male' && patientData.age >= 50) {\r\n      const lastPSA = patientData.lastScreening.psa;\r\n      results.prostate = {\r\n          cancerType: 'prostate',\r\n          status: !isValidDate(lastPSA) || getYearsSince(lastPSA) >= 1\r\n            ? 'due'\r\n            : 'upcoming',\r\n          reason: patientData.familyHistory.prostate\r\n            ? 'High-risk patient requires annual PSA screening'\r\n            : 'Consider PSA screening based on shared decision making',\r\n          isOverdue: isValidDate(lastPSA) && getYearsSince(lastPSA) > 1\r\n      };\r\n    }\r\n\r\n    // Lung Cancer Screening\r\n    if (patientData.age >= 50 && patientData.age <= 80 && patientData.smokingHistory && (patientData.packYears ?? 0) >= 20) {\r\n      const lastLDCT = patientData.lastScreening.ldct;\r\n      results.lung = {\r\n          cancerType: 'lung',\r\n          status: !isValidDate(lastLDCT) || getYearsSince(lastLDCT) >= 1\r\n            ? 'due'\r\n            : 'upcoming',\r\n          reason: 'Annual LDCT recommended for high-risk patients',\r\n          isOverdue: isValidDate(lastLDCT) && getYearsSince(lastLDCT) > 1\r\n      };\r\n    }\r\n\r\n    return results;\r\n  };\r\n\r\n  const generateSummary = async ({ prompt, context }: GenerateSummaryParams): Promise<string> => {\r\n    try {\r\n      const response = await callAIAgent({\r\n        module: 'OPD',\r\n        intent: 'screening',\r\n        prompt,\r\n        context,\r\n        mockMode\r\n      });\r\n      return response.content;\r\n    } catch (error: any) {\r\n      console.error('Generate Summary Error:', error);\r\n      \r\n      // Handle specific API errors\r\n      if (error.name === 'APIError') {\r\n        switch (error.code) {\r\n          case 'INVALID_JSON':\r\n          case 'INVALID_RESPONSE':\r\n            throw new Error('The AI service returned an invalid response. Please try again.');\r\n          case 'RATE_LIMIT':\r\n            throw new Error('Too many requests. Please wait a moment and try again.');\r\n          case 'CONNECTION_ERROR':\r\n            throw new Error('Unable to connect to the AI service. Please check your connection.');\r\n          default:\r\n            throw new Error(error.message || 'Failed to generate summary');\r\n        }\r\n      }\r\n\r\n      throw new Error('Failed to generate summary');\r\n    }\r\n  };\r\n\r\n  const recommendations = calculateRecommendations();\r\n\r\n  // Handle AI consultation\r\n  const showToast = ({ title, description, duration = 5000, variant = 'default' }: ToastParams) => {\r\n    toast(description, {\r\n      type: variant === 'destructive' ? 'error' : 'info',\r\n      autoClose: duration,\r\n      hideProgressBar: false,\r\n      closeOnClick: true,\r\n      pauseOnHover: true,\r\n      draggable: true,\r\n    });\r\n  };\r\n\r\n  const handleAIConsult = async (cancerType: string) => {\r\n    setLoading(true);\r\n    const recommendation = recommendations[cancerType.toLowerCase()];\r\n    if (!recommendation) return;\r\n\r\n    try {\r\n      const context = `\r\nPatient Information:\r\n- Age: ${patientData.age}\r\n- Gender: ${patientData.gender}\r\n- Smoking History: ${patientData.smokingHistory ? `Yes (${patientData.packYears} pack years)` : 'No'}\r\n- High Risk: ${patientData.isHighRisk ? 'Yes' : 'No'}\r\n- Family History: ${Object.entries(patientData.familyHistory)\r\n  .filter(([_, value]) => value)\r\n  .map(([cancer]) => cancer)\r\n  .join(', ')}\r\n\r\nScreening Status:\r\nCancer Type: ${cancerType}\r\nCurrent Status: ${recommendation.status}\r\nReason: ${recommendation.reason}\r\nLast Screening: ${patientData.lastScreening[cancerType.toLowerCase() as keyof typeof patientData.lastScreening] || 'Never'}\r\n${recommendation.isOverdue ? 'OVERDUE FOR SCREENING' : ''}\r\n`;\r\n\r\n      const response = await generateSummary({\r\n        prompt: \"Analyze this patient's cancer screening status and provide personalized recommendations.\",\r\n        context\r\n      });\r\n\r\n      showToast({\r\n        title: `${cancerType} Screening Analysis`,\r\n        description: response,\r\n        duration: 10000\r\n      });\r\n\r\n    } catch (error: any) {\r\n      console.error('AI Consultation Error:', error);\r\n      showToast({\r\n        title: \"Consultation Failed\",\r\n        description: error.message || \"Unable to provide AI consultation at this time. Please try again later.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Export recommendations as PDF\r\n  const exportRecommendations = () => {\r\n    // Implement PDF export logic\r\n    console.log('Exporting recommendations...');\r\n  };\r\n\r\n  const getStatusColor = (status: string, isOverdue?: boolean) => {\r\n    if (isOverdue) return 'text-red-600 bg-red-50';\r\n    switch (status) {\r\n      case 'due': return 'text-yellow-600 bg-yellow-50';\r\n      case 'upcoming': return 'text-blue-600 bg-blue-50';\r\n      case 'not-indicated': return 'text-gray-600 bg-gray-50';\r\n      default: return 'text-gray-600 bg-gray-50';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 max-w-4xl mx-auto p-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800\">Cancer Screening Assistant</h2>\r\n        <div className=\"flex items-center gap-4\">\r\n          <button\r\n            onClick={() => setMockMode(!mockMode)}\r\n            className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n              mockMode ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'\r\n            }`}\r\n          >\r\n            {mockMode ? 'ðŸ§ª Mock Mode' : 'ðŸ¤– Gemini Mode'}\r\n          </button>\r\n          <button\r\n            onClick={exportRecommendations}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n          >\r\n            <Download size={16} />\r\n            Export PDF\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Patient Input Panel */}\r\n      {/* High Risk Panel */}\r\n      <div className=\"bg-white rounded-lg shadow p-6 space-y-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800\">High Risk Assessment</h3>\r\n          <label className=\"relative inline-flex items-center cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={patientData.isHighRisk}\r\n              onChange={(e) => setPatientData(prev => ({\r\n                ...prev,\r\n                isHighRisk: handleCheckboxChange(e)\r\n              }))}\r\n              className=\"sr-only peer\"\r\n            />\r\n            <div className=\"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:bg-blue-600 after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all\"></div>\r\n            <span className=\"ml-3 text-sm font-medium text-gray-700\">High Risk Patient</span>\r\n          </label>\r\n        </div>\r\n\r\n        {patientData.isHighRisk && (\r\n          <div className=\"mt-4 space-y-4\">\r\n            <div className=\"grid md:grid-cols-2 gap-4\">\r\n              <label className=\"flex items-center space-x-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.riskFactors.geneticRisk.brcaPositive}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    riskFactors: {\r\n                      ...prev.riskFactors,\r\n                      geneticRisk: {\r\n                        ...prev.riskFactors.geneticRisk,\r\n                        brcaPositive: handleCheckboxChange(e)\r\n                      }\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span>BRCA1/2 Positive</span>\r\n              </label>\r\n              <label className=\"flex items-center space-x-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.riskFactors.geneticRisk.lynchSyndrome}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    riskFactors: {\r\n                      ...prev.riskFactors,\r\n                      geneticRisk: {\r\n                        ...prev.riskFactors.geneticRisk,\r\n                        lynchSyndrome: handleCheckboxChange(e)\r\n                      }\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span>Lynch Syndrome</span>\r\n              </label>\r\n              <label className=\"flex items-center space-x-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.riskFactors.priorCancer}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    riskFactors: {\r\n                      ...prev.riskFactors,\r\n                      priorCancer: handleCheckboxChange(e)\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span>Prior Cancer History</span>\r\n              </label>\r\n              <label className=\"flex items-center space-x-3\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.riskFactors.immunocompromised}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    riskFactors: {\r\n                      ...prev.riskFactors,\r\n                      immunocompromised: handleCheckboxChange(e)\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span>Immunocompromised</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Patient Information Panel */}\r\n      <div className=\"bg-white rounded-lg shadow p-6 space-y-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-800\">Patient Information</h3>\r\n        <div className=\"grid md:grid-cols-2 gap-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Age</label>\r\n            <input\r\n              type=\"number\"\r\n              value={patientData.age || ''}\r\n              onChange={(e) => setPatientData(prev => ({ ...prev, age: parseInt(e.target.value) || 0 }))}\r\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Gender</label>\r\n            <select\r\n              value={patientData.gender}\r\n              onChange={(e) => setPatientData(prev => ({ ...prev, gender: e.target.value as Gender }))}\r\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"female\">Female</option>\r\n              <option value=\"male\">Male</option>\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700\">Smoking History</label>\r\n            <div className=\"mt-1 space-y-2\">\r\n              <label className=\"inline-flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.smokingHistory}\r\n                  onChange={(e) => setPatientData(prev => ({ ...prev, smokingHistory: handleCheckboxChange(e) }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2\">Current or Former Smoker</span>\r\n              </label>\r\n              {patientData.smokingHistory && (\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Pack Years\"\r\n                  value={patientData.packYears || ''}\r\n                  onChange={(e) => setPatientData(prev => ({ ...prev, packYears: parseInt(e.target.value) || 0 }))}\r\n                  className=\"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Family History Section */}\r\n        <div className=\"mt-4\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Family History</h4>\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            {(Object.keys(patientData.familyHistory) as Array<keyof typeof patientData.familyHistory>).map((cancer) => (\r\n              <label key={cancer} className=\"inline-flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={patientData.familyHistory[cancer]}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    familyHistory: {\r\n                      ...prev.familyHistory,\r\n                      [cancer]: handleCheckboxChange(e)\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2 capitalize\">{cancer} Cancer</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Symptoms Panel */}\r\n        <div className=\"mt-4 border-t pt-4\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Active Symptoms</h4>\r\n          <div className=\"grid md:grid-cols-3 gap-4\">\r\n            {Object.entries(patientData.activeSymptoms).map(([symptom, isActive]) => (\r\n              <label key={symptom} className=\"inline-flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={isActive}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    activeSymptoms: {\r\n                      ...prev.activeSymptoms,\r\n                      [symptom]: handleCheckboxChange(e)\r\n                    }\r\n                  }))}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2 capitalize\">{symptom.replace(/([A-Z])/g, ' $1').toLowerCase()}</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Last Screening Dates */}\r\n        <div className=\"mt-4 border-t pt-4\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Last Screening Dates</h4>\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            {(Object.keys(patientData.lastScreening) as LastScreeningKey[]).map((screening) => (\r\n              <div key={screening}>\r\n                <label className=\"block text-sm font-medium text-gray-700 capitalize\">\r\n                  {screening.replace(/([A-Z])/g, ' $1').trim()}\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={patientData.lastScreening[screening as keyof typeof patientData.lastScreening] || ''}\r\n                  onChange={(e) => setPatientData(prev => ({\r\n                    ...prev,\r\n                    lastScreening: {\r\n                      ...prev.lastScreening,\r\n                      [screening]: e.target.value\r\n                    }\r\n                  }))}\r\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Recommendations Panel */}\r\n      <div className=\"space-y-4\">\r\n        {Object.entries(recommendations).map(([cancerType, recommendation]) => {\r\n          // Skip if recommendation is undefined or gender-specific recommendation doesn't apply\r\n          if (!recommendation) return null;\r\n          if ((cancerType === 'breast' || cancerType === 'cervical') && patientData.gender === 'male') return null;\r\n          if (cancerType === 'prostate' && patientData.gender === 'female') return null;\r\n\r\n          return (\r\n            <div key={cancerType} className=\"bg-white rounded-lg shadow\">\r\n              <div\r\n                className=\"p-4 flex items-center justify-between cursor-pointer\"\r\n                onClick={() => setExpandedPanels(prev => ({ ...prev, [cancerType]: !prev[cancerType] }))}\r\n              >\r\n                <div className=\"flex items-center gap-4\">\r\n                  <h3 className=\"text-lg font-semibold text-gray-800 capitalize\">\r\n                    {cancerType} Cancer Screening\r\n                  </h3>\r\n                  <span className={`px-2 py-1 rounded-full text-sm font-medium ${getStatusColor(recommendation.status, recommendation.isOverdue)}`}>\r\n                    {recommendation.status.toUpperCase()}\r\n                  </span>\r\n                  {recommendation.isOverdue && (\r\n                    <AlertTriangle className=\"text-red-500\" size={20} />\r\n                  )}\r\n                </div>\r\n                {expandedPanels[cancerType] ? <ChevronUp size={20} /> : <ChevronDown size={20} />}\r\n              </div>\r\n\r\n              {expandedPanels[cancerType] && (\r\n                <div className=\"p-4 border-t border-gray-200 space-y-4\">\r\n                  <p className=\"text-gray-600\">{recommendation.reason}</p>\r\n                  {recommendation?.nextDue && (\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      Next screening due: {new Date(recommendation.nextDue).toLocaleDateString()}\r\n                    </p>\r\n                  )}\r\n                  <button\r\n                    onClick={() => handleAIConsult(recommendation.cancerType)}\r\n                    className=\"flex items-center gap-2 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200\"\r\n                    disabled={loading}\r\n                  >\r\n                    <MessageSquare size={16} />\r\n                    Ask AI about {cancerType} screening\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CancerScreening;\r\n","import React from 'react';\r\n\r\ninterface ReferralGuideline {\r\n  condition: string;\r\n  urgency: string;\r\n  criteria: string[];\r\n  workup: string[];\r\n}\r\n\r\ninterface Props {\r\n  guideline: ReferralGuideline;\r\n}\r\n\r\nexport default function ReferralCard({ guideline }: Props) {\r\n  console.log(\"ReferralCard guideline prop:\", guideline); // ADDED\r\n  return (\r\n    <div className=\"bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n      <div className=\"flex justify-between items-start mb-3\">\r\n        <h3 className=\"font-medium text-gray-900\">{guideline.condition}</h3>\r\n        <span className={`text-xs px-2 py-1 rounded-full ${\r\n          guideline.urgency.includes('Urgent') \r\n            ? 'bg-red-100 text-red-800' \r\n            : 'bg-yellow-100 text-yellow-800'\r\n        }`}>\r\n          {guideline.urgency}\r\n        </span>\r\n      </div>\r\n      \r\n      <div className=\"space-y-3 text-sm\">\r\n        <div>\r\n          <span className=\"text-gray-500\">Referral Criteria:</span>\r\n          <ul className=\"mt-1 space-y-1\">\r\n            {guideline.criteria.map((criterion, index) => (\r\n              <li key={index} className=\"text-gray-900 flex items-start\">\r\n                <span className=\"mr-2\">â€¢</span>\r\n                {criterion}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n        \r\n        <div>\r\n          <span className=\"text-gray-500\">Required Workup:</span>\r\n          <ul className=\"mt-1 space-y-1\">\r\n            {guideline.workup.map((item, index) => (\r\n              <li key={index} className=\"text-gray-900 flex items-start\">\r\n                <span className=\"mr-2\">â€¢</span>\r\n                {item}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\ninterface ReferralFormProps {\r\n  formData: {\r\n    age: string;\r\n    symptoms: string;\r\n    duration: string;\r\n    clinicalFindings: string;\r\n  };\r\n  setFormData: React.Dispatch<React.SetStateAction<{\r\n    age: string;\r\n    symptoms: string;\r\n    duration: string;\r\n    clinicalFindings: string;\r\n  }>>;\r\n}\r\n\r\nconst ReferralForm: React.FC<ReferralFormProps> = ({ formData, setFormData }) => {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div>\r\n        <label htmlFor=\"age\" className=\"block text-sm font-medium text-gray-700\">\r\n          Age\r\n        </label>\r\n        <input\r\n          type=\"number\"\r\n          id=\"age\"\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          value={formData.age}\r\n          onChange={(e) => setFormData((prev) => ({ ...prev, age: e.target.value }))}\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label htmlFor=\"symptoms\" className=\"block text-sm font-medium text-gray-700\">\r\n          Symptoms\r\n        </label>\r\n        <textarea\r\n          id=\"symptoms\"\r\n          rows={3}\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          value={formData.symptoms}\r\n          onChange={(e) => setFormData((prev) => ({ ...prev, symptoms: e.target.value }))}\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label htmlFor=\"duration\" className=\"block text-sm font-medium text-gray-700\">\r\n          Duration of Symptoms\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"duration\"\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          placeholder=\"e.g., 2 weeks\"\r\n          value={formData.duration}\r\n          onChange={(e) => setFormData((prev) => ({ ...prev, duration: e.target.value }))}\r\n        />\r\n      </div>\r\n\r\n      <div>\r\n        <label htmlFor=\"clinicalFindings\" className=\"block text-sm font-medium text-gray-700\">\r\n          Clinical Findings\r\n        </label>\r\n        <textarea\r\n          id=\"clinicalFindings\"\r\n          rows={3}\r\n          className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          value={formData.clinicalFindings}\r\n          onChange={(e) => setFormData((prev) => ({ ...prev, clinicalFindings: e.target.value }))}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReferralForm;\r\n","import React from 'react';\r\nimport { AlertTriangle, Clock, Check } from 'lucide-react';\r\n\r\ninterface TriageResultProps {\r\n  aiTriageResult: {\r\n    urgency: 'Urgent' | 'Soon' | 'Routine';\r\n    reasoning: string[];\r\n    timeframe: string;\r\n  } | null;\r\n}\r\n\r\nconst TriageResult: React.FC<TriageResultProps> = ({ aiTriageResult }) => {\r\n  if (!aiTriageResult) return null;\r\n\r\nconst urgencyStyles: Record<'Urgent' | 'Soon' | 'Routine', string> = {\r\n  Urgent: 'bg-red-50 text-red-600',\r\n  Soon: 'bg-yellow-50 text-yellow-600',\r\n  Routine: 'bg-green-50 text-green-600',\r\n};\r\n\r\n  const Icon = aiTriageResult.urgency === 'Urgent'\r\n    ? AlertTriangle\r\n    : aiTriageResult.urgency === 'Soon'\r\n    ? Clock\r\n    : Check;\r\n\r\n  return (\r\n    <div className={`p-4 rounded-md ${urgencyStyles[aiTriageResult.urgency]}`}>\r\n      <div className=\"flex items-center gap-2\">\r\n        <Icon className=\"h-5 w-5\" />\r\n        <h4 className=\"font-medium\">{aiTriageResult.urgency} Referral</h4>\r\n      </div>\r\n      <div className=\"mt-2 text-sm\">\r\n        <p>Timeframe: {aiTriageResult.timeframe}</p>\r\n        <ul className=\"mt-2 pl-5 list-disc\">\r\n          {aiTriageResult.reasoning.map((reason, index) => (\r\n            <li key={index}>{reason}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TriageResult;\r\n","export interface ReferralTemplate {\r\n  id: string;\r\n  cancerType: string;\r\n  pathwayName: string;\r\n  urgencyLevel: string; // This might be redundant if calculated by triage engine\r\n  aiTriageFactors: {\r\n    highRiskFactors: string[];\r\n    moderateRiskFactors: string[];\r\n    lowRiskFactors: string[]; // Optional, for context\r\n    redFlags: { trigger: string[]; message: string }[]; // Red flag definitions\r\n  };\r\n  requiredInformation: {\r\n    clinical: string[]; // Symptoms, findings\r\n  };\r\n  slaTimeframes: {\r\n    urgent: string; // e.g., \"24 hours\"\r\n    soon: string; // e.g., \"7 days\"\r\n    routine: string; // e.g., \"14 days\"\r\n  };\r\n}\r\n\r\nexport const referralTemplates: ReferralTemplate[] = [\r\n  {\r\n    id: 'breast-001',\r\n    cancerType: 'Breast Cancer',\r\n    pathwayName: 'Suspected Breast Cancer Pathway',\r\n    urgencyLevel: 'Calculated', // Determined by triage engine\r\n    aiTriageFactors: {\r\n      highRiskFactors: ['Palpable lump', 'Skin changes (peau d\\'orange)', 'Nipple discharge (bloody)'],\r\n      moderateRiskFactors: ['Axillary lymphadenopathy', 'Persistent breast pain'],\r\n      lowRiskFactors: ['Family history (low risk)', 'Fibrocystic changes'],\r\n      redFlags: [\r\n        { trigger: ['Palpable lump', 'Skin changes'], message: 'ðŸš¨ Red Flag: High suspicion for inflammatory breast cancer.' },\r\n      ],\r\n    },\r\n    requiredInformation: {\r\n      clinical: ['Age', 'Symptoms', 'Duration', 'Clinical Findings'],\r\n    },\r\n    slaTimeframes: {\r\n      urgent: 'See within 2 weeks',\r\n      soon: 'See within 4 weeks',\r\n      routine: 'See within 6 weeks',\r\n    },\r\n  },\r\n  {\r\n    id: 'lung-001',\r\n    cancerType: 'Lung Cancer',\r\n    pathwayName: 'Suspected Lung Cancer Pathway',\r\n    urgencyLevel: 'Calculated',\r\n    aiTriageFactors: {\r\n      highRiskFactors: ['Hemoptysis', 'Unexplained weight loss (>10%)', 'Chest X-ray suggestive of malignancy'],\r\n      moderateRiskFactors: ['Persistent cough (>3 weeks)', 'Smoker (>20 pack-years)', 'Hoarseness'],\r\n      lowRiskFactors: ['Shortness of breath (stable)', 'Resolved pneumonia'],\r\n      redFlags: [\r\n        { trigger: ['Hemoptysis', 'Weight loss'], message: 'ðŸš¨ Red Flag: High suspicion for malignancy. Expedite referral.' },\r\n        { trigger: ['Hoarseness', 'Persistent cough'], message: 'ðŸš¨ Red Flag: Possible recurrent laryngeal nerve involvement.' },\r\n      ],\r\n    },\r\n    requiredInformation: {\r\n      clinical: ['Age', 'Symptoms', 'Duration', 'Smoking history', 'Clinical Findings'],\r\n    },\r\n    slaTimeframes: {\r\n      urgent: 'See within 1 week',\r\n      soon: 'See within 3 weeks',\r\n      routine: 'See within 5 weeks',\r\n    },\r\n  },\r\n  {\r\n    id: 'colorectal-001',\r\n    cancerType: 'Colorectal Cancer',\r\n    pathwayName: 'Suspected Colorectal Cancer Pathway',\r\n    urgencyLevel: 'Calculated',\r\n    aiTriageFactors: {\r\n      highRiskFactors: ['Rectal bleeding with change in bowel habit', 'Palpable abdominal mass', 'Iron deficiency anemia (unexplained)'],\r\n      moderateRiskFactors: ['Change in bowel habit (>6 weeks)', 'Family history (first-degree relative)', 'Weight loss'],\r\n      lowRiskFactors: ['Hemorrhoids (confirmed)', 'Anal fissure'],\r\n      redFlags: [\r\n        { trigger: ['Rectal bleeding', 'Change in bowel habit', 'Age > 50'], message: 'ðŸš¨ Red Flag: High suspicion for colorectal cancer. Urgent colonoscopy needed.' },\r\n      ],\r\n    },\r\n    requiredInformation: {\r\n      clinical: ['Age', 'Symptoms', 'Duration', 'Family history', 'Clinical Findings'],\r\n    },\r\n    slaTimeframes: {\r\n      urgent: 'See within 2 weeks',\r\n      soon: 'See within 4 weeks',\r\n      routine: 'See within 6 weeks',\r\n    },\r\n  },\r\n  // Add more templates for other cancer types as needed\r\n];\r\n","export interface TriageInput {\r\n  age: number;\r\n  symptoms: string;\r\n  duration: string;\r\n  clinicalFindings: string;\r\n  highRiskFactors: string[];\r\n  moderateRiskFactors: string[];\r\n}\r\n\r\nexport interface TriageResult {\r\n  urgency: 'Urgent' | 'Soon' | 'Routine';\r\n  reasoning: string[];\r\n  timeframe: string;\r\n}\r\n\r\nexport const calculateRiskScore = (input: TriageInput): number => {\r\n  let score = 0;\r\n\r\n  // Check high-risk factors\r\n  input.highRiskFactors.forEach((factor) => {\r\n    if (\r\n      input.clinicalFindings.toLowerCase().includes(factor.toLowerCase()) ||\r\n      input.symptoms.toLowerCase().includes(factor.toLowerCase())\r\n    ) {\r\n      score += 3;\r\n    }\r\n  });\r\n\r\n  // Check moderate-risk factors\r\n  input.moderateRiskFactors.forEach((factor) => {\r\n    if (\r\n      input.clinicalFindings.toLowerCase().includes(factor.toLowerCase()) ||\r\n      input.symptoms.toLowerCase().includes(factor.toLowerCase())\r\n    ) {\r\n      score += 2;\r\n    }\r\n  });\r\n\r\n  // Age consideration\r\n  if (input.age > 60) score += 1;\r\n  if (input.age > 75) score += 1;\r\n\r\n  // Duration consideration\r\n  if (\r\n    input.duration.includes('month') ||\r\n    (input.duration.includes('week') && parseInt(input.duration) > 6)\r\n  ) {\r\n    score += 1;\r\n  }\r\n\r\n  return score;\r\n};\r\n\r\nexport const determineTriageResult = (\r\n  input: TriageInput,\r\n  slaTimeframes: { urgent: string; routine: string }\r\n): TriageResult => {\r\n  const riskScore = calculateRiskScore(input);\r\n\r\n  const urgency =\r\n    riskScore >= 7 ? 'Urgent' : riskScore >= 4 ? 'Soon' : 'Routine';\r\n\r\n  const reasoning: string[] = [];\r\n  if (riskScore >= 7) {\r\n    reasoning.push('Multiple high-risk factors identified');\r\n    reasoning.push('Requires urgent assessment');\r\n  } else if (riskScore >= 4) {\r\n    reasoning.push('Moderate risk factors present');\r\n    reasoning.push('Early assessment recommended');\r\n  } else {\r\n    reasoning.push('Routine assessment appropriate');\r\n    reasoning.push('Low-risk presentation');\r\n  }\r\n\r\n  const timeframe =\r\n    urgency === 'Urgent'\r\n      ? slaTimeframes.urgent\r\n      : slaTimeframes.routine || 'Not specified';\r\n\r\n  return {\r\n    urgency,\r\n    reasoning,\r\n    timeframe,\r\n  };\r\n};\r\n","import React, { useState, useMemo } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { FileText, AlertTriangle, Loader2 } from 'lucide-react';\r\nimport ReferralCard from './ReferralCard'; // Assuming this exists and is styled\r\nimport ReferralForm from './ReferralForm';\r\nimport TriageResult from './TriageResult';\r\nimport { referralTemplates, ReferralTemplate } from './data/referralTemplates';\r\nimport { determineTriageResult, TriageInput, TriageResult as TriageResultType } from './logic/triageEngine';\r\nimport { generateSummary } from '@/services/aiAssistant';\r\nimport { toast } from '@/components/ui/use-toast';\r\nimport { callAIAgent } from '@/lib/api/aiAgentAPI';\r\n\r\nexport default function ReferralGuidelines() {\r\n  const [mockMode, setMockMode] = useState(false);\r\n  const [selectedCancerType, setSelectedCancerType] = useState<string>('');\r\n  const [formData, setFormData] = useState({\r\n    age: '',\r\n    symptoms: '',\r\n    duration: '',\r\n    clinicalFindings: '',\r\n  });\r\n  const [aiTriageResult, setAiTriageResult] = useState<TriageResultType | null>(null);\r\n  const [redFlagAlerts, setRedFlagAlerts] = useState<string[]>([]);\r\n  const [isLoadingAI, setIsLoadingAI] = useState(false);\r\n  \r\n  const cancerTypes = useMemo(() => [...new Set(referralTemplates.map(t => t.cancerType))], []);\r\n\r\n  const selectedTemplate = useMemo(() => {\r\n    return referralTemplates.find(t => t.cancerType === selectedCancerType);\r\n  }, [selectedCancerType]);\r\n\r\n  const handleTriage = async () => {\r\n    if (!selectedTemplate) return;\r\n\r\n    // Local triage engine\r\n    const input: TriageInput = {\r\n      age: parseInt(formData.age) || 0,\r\n      symptoms: formData.symptoms,\r\n      duration: formData.duration,\r\n      clinicalFindings: formData.clinicalFindings,\r\n      highRiskFactors: selectedTemplate.aiTriageFactors.highRiskFactors,\r\n      moderateRiskFactors: selectedTemplate.aiTriageFactors.moderateRiskFactors,\r\n    };\r\n\r\n    const slaTimeframes = {\r\n      urgent: selectedTemplate.slaTimeframes.urgent,\r\n      routine: selectedTemplate.slaTimeframes.routine,\r\n    };\r\n\r\n    // Get local triage result\r\n    const localResult = determineTriageResult(input, slaTimeframes);\r\n    setAiTriageResult(localResult);\r\n\r\n    // Check for Red Flags\r\n    const triggeredFlags: string[] = [];\r\n    const combinedInput = `${formData.symptoms.toLowerCase()} ${formData.clinicalFindings.toLowerCase()}`;\r\n    selectedTemplate.aiTriageFactors.redFlags.forEach(flag => {\r\n      const allTriggersPresent = flag.trigger.every(trigger => \r\n        combinedInput.includes(trigger.toLowerCase())\r\n      );\r\n      if (allTriggersPresent) {\r\n        triggeredFlags.push(flag.message);\r\n      }\r\n    });\r\n    setRedFlagAlerts(triggeredFlags);\r\n\r\n    // Get AI-enhanced insights\r\n    getAIInsights();\r\n  };\r\n\r\n  // Update getAIInsights to handle optional values\r\n  const getAIInsights = async () => {\r\n    if (!selectedTemplate || !aiTriageResult) return;\r\n    setIsLoadingAI(true);\r\n    try {\r\n      const context = `\r\nCancer Type: ${selectedTemplate.pathwayName}\r\nPatient Age: ${formData.age}\r\nPresenting Symptoms: ${formData.symptoms}\r\nDuration: ${formData.duration}\r\nClinical Findings: ${formData.clinicalFindings}\r\n\r\nInitial Triage Result: ${aiTriageResult.urgency}\r\nRed Flags Present: ${redFlagAlerts.length > 0 ? redFlagAlerts.join(', ') : 'None'}\r\n\r\nHigh Risk Factors to Consider:\r\n${selectedTemplate.aiTriageFactors.highRiskFactors.join('\\n')}\r\n\r\nModerate Risk Factors to Consider:\r\n${selectedTemplate.aiTriageFactors.moderateRiskFactors.join('\\n')}\r\n`;\r\n\r\n      const aiResponse = await callAIAgent({\r\n        module: 'OPD',\r\n        intent: 'triage',\r\n        prompt: \"Analyze this oncology referral and provide additional insights. Consider the urgency level, risk factors, and any concerning features that might need immediate attention. Suggest additional workup if needed.\",\r\n        context,\r\n        mockMode\r\n      });\r\n\r\n      toast({\r\n        title: \"AI Clinical Insights\",\r\n        description: aiResponse.content,\r\n        duration: 10000\r\n      });\r\n\r\n    } catch (error: any) {\r\n      console.error('AI Analysis Error:', error);\r\n      toast({\r\n        title: \"AI Analysis Error\",\r\n        description: \"Unable to get AI insights at this time. Using local triage results only.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsLoadingAI(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: -20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"flex items-center gap-3\"\r\n        >\r\n          <h2 className=\"text-2xl font-bold\">ðŸ“‹ Referral Guidelines</h2>\r\n          <button\r\n            onClick={() => setMockMode(!mockMode)}\r\n            className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n              mockMode ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'\r\n            }`}\r\n          >\r\n            {mockMode ? 'ðŸ§ª Mock Mode' : 'ðŸ¤– Gemini Mode'}\r\n          </button>\r\n        </motion.div>\r\n      </div>\r\n      \r\n      <motion.div\r\n        initial={{ opacity: 0, y: -20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"flex items-center gap-3\"\r\n      >\r\n        <div className=\"p-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg shadow-lg\">\r\n          <FileText className=\"h-6 w-6 text-white\" />\r\n        </div>\r\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n          Referral Guideline Assistant\r\n        </h2>\r\n      </motion.div>\r\n\r\n      <div className=\"grid gap-6 md:grid-cols-2\">\r\n        {/* Referral Input Section */}\r\n        <div className=\"space-y-4 p-6 backdrop-blur-sm bg-white bg-opacity-40 rounded-xl shadow-lg border border-gray-200 border-opacity-40 transition-all duration-300 hover:shadow-xl\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800\">Clinical Information</h3>\r\n\r\n          {/* Cancer Type Selector */}\r\n          <div>\r\n            <label htmlFor=\"cancerType\" className=\"block text-sm font-medium text-gray-700\">\r\n              Select Cancer Type / Pathway\r\n            </label>\r\n            <select\r\n              id=\"cancerType\"\r\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n              value={selectedCancerType}\r\n              onChange={(e) => {\r\n                setSelectedCancerType(e.target.value);\r\n                setAiTriageResult(null); // Reset triage on pathway change\r\n                setRedFlagAlerts([]); // Reset alerts\r\n              }}\r\n            >\r\n              <option value=\"\">Please select</option>\r\n              {cancerTypes.map(type => (\r\n                <option key={type} value={type}>\r\n                  {type}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {selectedCancerType && (\r\n            <>\r\n              {/* Dynamic Referral Form */}\r\n              <ReferralForm formData={formData} setFormData={setFormData} />\r\n\r\n              {/* Triage Button */}\r\n              <button\r\n                onClick={handleTriage}\r\n                disabled={!selectedCancerType || isLoadingAI}\r\n                className=\"w-full py-2 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n              >\r\n                {isLoadingAI && <Loader2 className=\"w-4 h-4 animate-spin\" />}\r\n                {isLoadingAI ? \"Analyzing...\" : \"Determine Suggested Action\"}\r\n              </button>\r\n\r\n              {/* Red Flag Alerts */}\r\n              {redFlagAlerts.length > 0 && (\r\n                <div className=\"space-y-2\">\r\n                  {redFlagAlerts.map((alert, index) => (\r\n                    <div key={index} className=\"p-3 bg-red-100 border border-red-300 rounded-md flex items-center gap-2 text-red-700\">\r\n                      <AlertTriangle className=\"h-5 w-5\" />\r\n                      <span className=\"text-sm font-medium\">{alert}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {/* Suggested Action / Triage Result */}\r\n              {aiTriageResult && (\r\n                <div className=\"mt-4 space-y-4\">\r\n                   <h4 className=\"text-md font-semibold text-gray-700\">Suggested Action:</h4>\r\n                   <TriageResult aiTriageResult={aiTriageResult} />\r\n                   {/* Optional: Add Print/Export button here later */}\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Guideline Information Display */}\r\n        <div className=\"space-y-4\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800\">Guideline Details</h3>\r\n          {selectedTemplate ? (\r\n             <ReferralCard\r\n                key={selectedTemplate.id}\r\n                guideline={{\r\n                  condition: selectedTemplate.pathwayName,\r\n                  urgency: selectedTemplate.urgencyLevel, // Or derive from triage result\r\n                  criteria: selectedTemplate.requiredInformation.clinical,\r\n                  workup: [ // Combine risk factors for display if needed\r\n                    ...selectedTemplate.aiTriageFactors.highRiskFactors.map(f => `High Risk: ${f}`),\r\n                    ...selectedTemplate.aiTriageFactors.moderateRiskFactors.map(f => `Moderate Risk: ${f}`),\r\n                  ],\r\n                }}\r\n              />\r\n          ) : (\r\n            <div className=\"p-4 text-center text-gray-500 bg-gray-50 rounded-lg\">\r\n              Select a cancer type to view guideline details.\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { CancerType } from '../data/followUpTemplates';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface CancerSelectorProps {\r\n  onSelect: (cancer: CancerType) => void;\r\n  selected: CancerType | null;\r\n}\r\n\r\nconst cancerTypes: Array<{ type: CancerType; label: string; icon: string }> = [\r\n  { type: 'breast', label: 'Breast Cancer', icon: 'ðŸŽ€' },\r\n  { type: 'lung', label: 'Lung Cancer', icon: 'ðŸ«' },\r\n  { type: 'colorectal', label: 'Colorectal Cancer', icon: 'ðŸŽ¯' },\r\n];\r\n\r\nexport const CancerSelector: React.FC<CancerSelectorProps> = ({ onSelect, selected }) => {\r\n  return (\r\n    <div className=\"grid grid-cols-3 gap-4\">\r\n      {cancerTypes.map(({ type, label, icon }) => (\r\n        <motion.button\r\n          key={type}\r\n          whileHover={{ scale: 1.05 }}\r\n          whileTap={{ scale: 0.95 }}\r\n          className={`p-4 rounded-lg ${\r\n            selected === type ? 'bg-blue-100 border-blue-500' : 'bg-gray-50'\r\n          } border-2 flex flex-col items-center`}\r\n          onClick={() => onSelect(type)}\r\n        >\r\n          <span className=\"text-2xl mb-2\">{icon}</span>\r\n          <span className=\"text-sm font-medium\">{label}</span>\r\n        </motion.button>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Calendar, FileText, Image, TestTube, Microscope, CheckCircle2 } from 'lucide-react';\r\n\r\ninterface TimelineEvent {\r\n  type: 'first_visit' | 'imaging' | 'biopsy' | 'histopathology' | 'molecular' | 'final';\r\n  date: string;\r\n  detail: string;\r\n  status: 'completed' | 'pending' | 'scheduled';\r\n}\r\n\r\ninterface DiagnosticTimelineProps {\r\n  events: TimelineEvent[];\r\n}\r\n\r\nconst eventIcons = {\r\n  first_visit: Calendar,\r\n  imaging: Image,\r\n  biopsy: TestTube,\r\n  histopathology: Microscope,\r\n  molecular: FileText,\r\n  final: CheckCircle2\r\n};\r\n\r\nconst eventLabels = {\r\n  first_visit: 'First Visit',\r\n  imaging: 'Imaging',\r\n  biopsy: 'Biopsy',\r\n  histopathology: 'Histopathology',\r\n  molecular: 'Molecular Testing',\r\n  final: 'Final Diagnosis'\r\n};\r\n\r\nexport const DiagnosticTimeline: React.FC<DiagnosticTimelineProps> = ({ events }) => {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n        <Calendar className=\"w-5 h-5 text-indigo-600\" />\r\n        Diagnostic Timeline\r\n      </h3>\r\n      <div className=\"relative\">\r\n        {/* Vertical line */}\r\n        <div className=\"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-200\" />\r\n        \r\n        {/* Timeline events */}\r\n        <div className=\"space-y-6\">\r\n          {events.map((event, index) => {\r\n            const Icon = eventIcons[event.type];\r\n            return (\r\n              <motion.div\r\n                key={event.type}\r\n                initial={{ opacity: 0, x: -20 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                transition={{ delay: index * 0.1 }}\r\n                className=\"relative flex items-start gap-4 pl-8\"\r\n              >\r\n                <div className={`absolute left-0 p-1 rounded-full bg-white ring-2 ${\r\n                  event.status === 'completed' ? 'ring-green-500' :\r\n                  event.status === 'scheduled' ? 'ring-blue-500' :\r\n                  'ring-gray-300'\r\n                }`}>\r\n                  <Icon className={`w-4 h-4 ${\r\n                    event.status === 'completed' ? 'text-green-500' :\r\n                    event.status === 'scheduled' ? 'text-blue-500' :\r\n                    'text-gray-400'\r\n                  }`} />\r\n                </div>\r\n                <div className=\"flex-1 bg-white rounded-lg border p-3\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div>\r\n                      <h4 className=\"font-medium text-gray-900\">{eventLabels[event.type]}</h4>\r\n                      <p className=\"text-sm text-gray-600\">{event.detail}</p>\r\n                    </div>\r\n                    <time className=\"text-sm text-gray-500\">{event.date}</time>\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","import React from 'react';\r\nimport { Line } from 'react-chartjs-2';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ChartOptions\r\n} from 'chart.js';\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\ninterface PerformanceData {\r\n  date: string;\r\n  ecog: number;\r\n  kps: number;\r\n}\r\n\r\ninterface PerformanceScoreChartProps {\r\n  data: PerformanceData[];\r\n}\r\n\r\nexport const PerformanceScoreChart: React.FC<PerformanceScoreChartProps> = ({ data }) => {\r\n  const chartData = {\r\n    labels: data.map(d => new Date(d.date).toLocaleDateString()),\r\n    datasets: [\r\n      {\r\n        label: 'ECOG Score',\r\n        data: data.map(d => d.ecog),\r\n        borderColor: 'rgb(79, 70, 229)',\r\n        backgroundColor: 'rgba(79, 70, 229, 0.1)',\r\n        yAxisID: 'y',\r\n      },\r\n      {\r\n        label: 'KPS Score',\r\n        data: data.map(d => d.kps),\r\n        borderColor: 'rgb(16, 185, 129)',\r\n        backgroundColor: 'rgba(16, 185, 129, 0.1)',\r\n        yAxisID: 'y1',\r\n      }\r\n    ]\r\n  };\r\n\r\n  const options: ChartOptions<'line'> = {\r\n    responsive: true,\r\n    interaction: {\r\n      mode: 'index' as const,\r\n      intersect: false,\r\n    },\r\n    scales: {\r\n      y: {\r\n        type: 'linear' as const,\r\n        display: true,\r\n        position: 'left' as const,\r\n        title: {\r\n          display: true,\r\n          text: 'ECOG Score'\r\n        },\r\n        min: 0,\r\n        max: 4,\r\n        grid: {\r\n          color: 'rgba(0, 0, 0, 0.1)',\r\n        }\r\n      },\r\n      y1: {\r\n        type: 'linear' as const,\r\n        display: true,\r\n        position: 'right' as const,\r\n        title: {\r\n          display: true,\r\n          text: 'KPS Score'\r\n        },\r\n        min: 0,\r\n        max: 100,\r\n        grid: {\r\n          drawOnChartArea: false,\r\n        },\r\n      },\r\n    },\r\n    plugins: {\r\n      legend: {\r\n        position: 'top' as const,\r\n      },\r\n      title: {\r\n        display: true,\r\n        text: 'Performance Status Trends',\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-4 bg-white rounded-lg border\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Performance Score Trends</h3>\r\n      <div className=\"h-64\">\r\n        <Line options={options} data={chartData} />\r\n      </div>\r\n      <div className=\"mt-4 grid grid-cols-2 gap-4 text-sm text-gray-600\">\r\n        <div>\r\n          <p className=\"font-medium\">ECOG Score Interpretation:</p>\r\n          <ul className=\"list-disc list-inside\">\r\n            <li>0: Fully active</li>\r\n            <li>1: Restricted but ambulatory</li>\r\n            <li>2: Ambulatory, capable of self-care</li>\r\n            <li>3: Limited self-care</li>\r\n            <li>4: Completely disabled</li>\r\n          </ul>\r\n        </div>\r\n        <div>\r\n          <p className=\"font-medium\">KPS Score Interpretation:</p>\r\n          <ul className=\"list-disc list-inside\">\r\n            <li>100-90: Normal activity</li>\r\n            <li>80-70: Normal activity with effort</li>\r\n            <li>60-50: Occasional assistance needed</li>\r\n            <li>40-30: Disabled, special care needed</li>\r\n            <li>20-10: Very sick, hospitalization</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};","import React, { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Download, Brain } from 'lucide-react';\r\nimport { TNMStage } from '../../types/evaluation';\r\n\r\ninterface SmartFollowUpSummaryProps {\r\n  cancerType: string;\r\n  stage: string;\r\n  tnmStage: TNMStage;\r\n  diagnosisDate: string;\r\n  currentECOG: number;\r\n  currentKPS: number;\r\n  onGenerate: () => Promise<string>;\r\n  followUpPlan?: any;\r\n}\r\n\r\nexport const SmartFollowUpSummary: React.FC<SmartFollowUpSummaryProps> = ({\r\n  cancerType,\r\n  stage,\r\n  tnmStage,\r\n  diagnosisDate,\r\n  currentECOG,\r\n  currentKPS,\r\n  onGenerate,\r\n  followUpPlan\r\n}) => {\r\n  const [summary, setSummary] = useState<string>('');\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n\r\n  const handleGenerateSummary = async () => {\r\n    setIsGenerating(true);\r\n    try {\r\n      const generatedSummary = await onGenerate();\r\n      setSummary(generatedSummary);\r\n    } catch (error) {\r\n      console.error('Error generating summary:', error);\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleExport = () => {\r\n    const element = document.createElement('a');\r\n    const file = new Blob([summary], { type: 'text/markdown' });\r\n    element.href = URL.createObjectURL(file);\r\n    element.download = `follow-up-summary-${new Date().toISOString().split('T')[0]}.md`;\r\n    document.body.appendChild(element);\r\n    element.click();\r\n    document.body.removeChild(element);\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      className=\"p-4 bg-white rounded-lg border shadow-sm\"\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n    >\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n          <Brain className=\"w-5 h-5 text-indigo-600\" />\r\n          Smart Follow-Up Summary\r\n        </h3>\r\n        <div className=\"flex gap-2\">\r\n          <button\r\n            onClick={handleGenerateSummary}\r\n            disabled={isGenerating}\r\n            className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 flex items-center gap-2\"\r\n          >\r\n            <Brain className=\"w-4 h-4\" />\r\n            {isGenerating ? 'Generating...' : 'Generate Summary'}\r\n          </button>\r\n          {summary && (\r\n            <button\r\n              onClick={handleExport}\r\n              className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 flex items-center gap-2\"\r\n            >\r\n              <Download className=\"w-4 h-4\" />\r\n              Export\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-2 gap-4 mb-4 text-sm\">\r\n        <div>\r\n          <p className=\"text-gray-600\">Cancer Type: <span className=\"font-medium text-gray-900\">{cancerType}</span></p>\r\n          <p className=\"text-gray-600\">Stage: <span className=\"font-medium text-gray-900\">{stage}</span></p>\r\n          <p className=\"text-gray-600\">TNM: <span className=\"font-medium text-gray-900\">T{tnmStage.t}N{tnmStage.n}M{tnmStage.m}</span></p>\r\n        </div>\r\n        <div>\r\n          <p className=\"text-gray-600\">Diagnosis Date: <span className=\"font-medium text-gray-900\">{new Date(diagnosisDate).toLocaleDateString()}</span></p>\r\n          <p className=\"text-gray-600\">Current ECOG: <span className=\"font-medium text-gray-900\">{currentECOG}</span></p>\r\n          <p className=\"text-gray-600\">Current KPS: <span className=\"font-medium text-gray-900\">{currentKPS}</span></p>\r\n        </div>\r\n      </div>\r\n\r\n      {summary && (\r\n        <div className=\"mt-4 p-4 bg-gray-50 rounded-lg prose prose-sm max-w-none\">\r\n          <div dangerouslySetInnerHTML={{ __html: summary }} />\r\n        </div>\r\n      )}\r\n\r\n      {!summary && !isGenerating && (\r\n        <div className=\"text-center py-8 text-gray-500\">\r\n          Click \"Generate Summary\" to create a comprehensive follow-up summary based on current patient data\r\n        </div>\r\n      )}\r\n\r\n      {isGenerating && (\r\n        <div className=\"text-center py-8 text-gray-500 animate-pulse\">\r\n          Generating comprehensive follow-up summary...\r\n        </div>\r\n      )}\r\n    </motion.div>\r\n  );\r\n};","interface TimelineEvent {\r\n  type: 'first_visit' | 'imaging' | 'biopsy' | 'histopathology' | 'molecular' | 'final';\r\n  date: string;\r\n  detail: string;\r\n  status: 'completed' | 'pending' | 'scheduled';\r\n}\r\n\r\ninterface PerformanceData {\r\n  date: string;\r\n  ecog: number;\r\n  kps: number;\r\n}\r\n\r\nexport const mockDiagnosticEvents: { [key: string]: TimelineEvent[] } = {\r\n  breast: [\r\n    {\r\n      type: 'first_visit',\r\n      date: '2025-03-15',\r\n      detail: 'Initial consultation for breast lump',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'imaging',\r\n      date: '2025-03-18',\r\n      detail: 'Mammogram and breast ultrasound',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'biopsy',\r\n      date: '2025-03-22',\r\n      detail: 'Core needle biopsy performed',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'histopathology',\r\n      date: '2025-03-28',\r\n      detail: 'Invasive ductal carcinoma confirmed',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'molecular',\r\n      date: '2025-04-02',\r\n      detail: 'ER+/PR+, HER2-, Ki-67 25%',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'final',\r\n      date: '2025-04-05',\r\n      detail: 'Stage IIA (T2N0M0) breast cancer diagnosis',\r\n      status: 'completed'\r\n    }\r\n  ],\r\n  lung: [\r\n    {\r\n      type: 'first_visit',\r\n      date: '2025-03-10',\r\n      detail: 'Referral for persistent cough and weight loss',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'imaging',\r\n      date: '2025-03-12',\r\n      detail: 'Chest CT showing RUL mass',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'biopsy',\r\n      date: '2025-03-16',\r\n      detail: 'CT-guided needle biopsy',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'histopathology',\r\n      date: '2025-03-20',\r\n      detail: 'Non-small cell lung cancer (adenocarcinoma)',\r\n      status: 'completed'\r\n    },\r\n    {\r\n      type: 'molecular',\r\n      date: '2025-03-25',\r\n      detail: 'Pending molecular testing results',\r\n      status: 'scheduled'\r\n    },\r\n    {\r\n      type: 'final',\r\n      date: '2025-03-28',\r\n      detail: 'Awaiting complete staging workup',\r\n      status: 'pending'\r\n    }\r\n  ]\r\n};\r\n\r\nexport const mockPerformanceData: { [key: string]: PerformanceData[] } = {\r\n  breast: [\r\n    { date: '2025-03-15', ecog: 0, kps: 100 },\r\n    { date: '2025-03-28', ecog: 0, kps: 90 },\r\n    { date: '2025-04-10', ecog: 1, kps: 80 },\r\n    { date: '2025-04-25', ecog: 1, kps: 80 },\r\n    { date: '2025-05-01', ecog: 0, kps: 90 }\r\n  ],\r\n  lung: [\r\n    { date: '2025-03-10', ecog: 1, kps: 80 },\r\n    { date: '2025-03-24', ecog: 1, kps: 70 },\r\n    { date: '2025-04-07', ecog: 2, kps: 60 },\r\n    { date: '2025-04-21', ecog: 1, kps: 70 },\r\n    { date: '2025-05-01', ecog: 1, kps: 80 }\r\n  ]\r\n};","export type CancerType = \r\n  | 'breast' | 'lung' | 'colorectal' | 'prostate' \r\n  | 'pancreatic' | 'bladder' | 'headneck' \r\n  | 'ovarian' | 'gastric' | 'lymphoma' | 'melanoma'\r\n  | 'esophageal' | 'thyroid' | 'hepatocellular'\r\n  | 'testicular' | 'brain' | 'sarcoma';\r\n\r\nexport type Stage = 'early' | 'advanced';\r\nexport type Intent = 'curative' | 'palliative';\r\nexport type FollowUpInterval = '3mo' | '6mo' | '1yr' | '2yr' | '5yr';\r\n\r\nexport interface FollowUpTimelineItem {\r\n  interval: FollowUpInterval;\r\n  actions: string[];\r\n}\r\n\r\ninterface Investigation {\r\n  title: string;\r\n  frequency: string;\r\n  description?: string;\r\n  duration?: string; // Added duration property\r\n}\r\n\r\ninterface TemplateMetadata {\r\n  version: string;\r\n  lastUpdated: string;\r\n  source?: string;\r\n}\r\n\r\nexport interface FollowUpTemplate {\r\n  metadata: TemplateMetadata;\r\n  intervals: {\r\n    curative: Record<FollowUpInterval, Investigation[]>;\r\n    palliative: Record<FollowUpInterval, Investigation[]>;\r\n  };\r\n  stageGuidelines: Record<Stage, {\r\n    surveillance: Investigation[];\r\n    imaging: Investigation[];\r\n    labTests: Investigation[];\r\n  }>;\r\n  surveillance: {\r\n    investigations: Investigation[];\r\n    examinations: Investigation[];\r\n  };\r\n  redFlags: Array<{\r\n    symptom: string;\r\n    severity: 'urgent' | 'warning';\r\n    action: string;\r\n  }>;\r\n  urgentFlags: Array<{\r\n    condition: string;\r\n    action: string;\r\n    timeframe: string;\r\n  }>;\r\n  qolTopics: Array<{\r\n    topic: string;\r\n    description: string;\r\n    recommendations: string[];\r\n    applicableStages: Stage[];\r\n  }>;\r\n  commonSymptoms: Array<{\r\n    symptom: string;\r\n    severity: 'low' | 'medium' | 'high';\r\n    relatedFlags?: string[];\r\n  }>;\r\n}\r\n\r\n// Diagnostic Timeline Event type\r\nexport interface TimelineEvent {\r\n  type: 'first_visit' | 'imaging' | 'biopsy' | 'histopathology' | 'molecular' | 'final';\r\n  date: string;\r\n  detail: string;\r\n  status: 'completed' | 'pending' | 'scheduled';\r\n}\r\n\r\n// Performance Score Chart Data type\r\nexport interface PerformanceData {\r\n  date: string;\r\n  ecog: number; // 0-4 scale\r\n  kps: number;  // 0-100 scale\r\n}\r\n\r\nexport const cancerTemplates: Record<CancerType, FollowUpTemplate> = {\r\n  breast: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [\r\n          { title: 'Clinical breast exam', frequency: 'Every 3-4 months for 3 years' },\r\n          { title: 'Review symptoms', frequency: 'Every visit' }\r\n        ],\r\n        '6mo': [\r\n          { title: 'Mammogram', frequency: 'Every 6-12 months' },\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [\r\n          { title: 'Symptom assessment', frequency: 'Every visit' },\r\n          { title: 'Pain evaluation', frequency: 'Every visit' }\r\n        ],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [\r\n          { title: 'Mammogram', frequency: 'Every 12 months', duration: '5 years' },\r\n          { title: 'Clinical exam', frequency: 'Every 3-4 months', duration: '2 years' }\r\n        ],\r\n        imaging: [\r\n          { title: 'Breast MRI', frequency: 'As indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ]\r\n      },\r\n      advanced: {\r\n        surveillance: [\r\n          { title: 'CT scan', frequency: 'Every 6 months', duration: '2 years' },\r\n          { title: 'Bone scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        imaging: [\r\n          { title: 'PET scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Tumor markers', frequency: 'As clinically indicated' }\r\n        ]\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'New breast lumps', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Bone pain', severity: 'warning', action: 'Further investigation' },\r\n      { symptom: 'Persistent cough', severity: 'warning', action: 'Further investigation' },\r\n      { symptom: 'Unexplained weight loss', severity: 'warning', action: 'Further investigation' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Lymphedema',\r\n        description: 'Swelling in arm or breast',\r\n        recommendations: ['Exercise', 'Compression garments', 'Specialist referral'],\r\n        applicableStages: ['early', 'advanced']\r\n      },\r\n      // ...other QoL topics\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Fatigue', severity: 'medium' },\r\n      { symptom: 'Arm swelling', severity: 'medium' },\r\n      { symptom: 'Hot flashes', severity: 'low' }\r\n    ]\r\n  },\r\n  lung: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [\r\n          { title: 'Chest CT', frequency: 'Every 3-6 months for 2 years' },\r\n          { title: 'Physical exam', frequency: 'Every 3 months' }\r\n        ],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [\r\n          { title: 'Chest X-ray', frequency: 'Every 6 months', duration: '2 years' }\r\n        ],\r\n        imaging: [\r\n          { title: 'CT scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ]\r\n      },\r\n      advanced: {\r\n        surveillance: [\r\n          { title: 'PET scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        imaging: [\r\n          { title: 'MRI', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Tumor markers', frequency: 'As clinically indicated' }\r\n        ]\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'New cough', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Hemoptysis', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Shortness of breath', severity: 'warning', action: 'Further investigation' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Smoking cessation',\r\n        description: 'Support to quit smoking',\r\n        recommendations: ['Counseling', 'Nicotine replacement', 'Medications'],\r\n        applicableStages: ['early', 'advanced']\r\n      },\r\n      // ...other QoL topics\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Cough', severity: 'medium' },\r\n      { symptom: 'Shortness of breath', severity: 'high' },\r\n      { symptom: 'Chest pain', severity: 'medium' }\r\n    ]\r\n  },\r\n  colorectal: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [\r\n          { title: 'CEA test', frequency: 'Every 3-6 months for 5 years' },\r\n          { title: 'CT scan', frequency: 'Every 6-12 months for 5 years' }\r\n        ],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [\r\n          { title: 'Colonoscopy', frequency: 'Every 1 year', duration: '5 years' }\r\n        ],\r\n        imaging: [\r\n          { title: 'CT scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ]\r\n      },\r\n      advanced: {\r\n        surveillance: [\r\n          { title: 'PET scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        imaging: [\r\n          { title: 'MRI', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Tumor markers', frequency: 'As clinically indicated' }\r\n        ]\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'Rectal bleeding', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Abdominal pain', severity: 'warning', action: 'Further investigation' },\r\n      { symptom: 'Change in bowel habits', severity: 'warning', action: 'Further investigation' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Dietary advice',\r\n        description: 'Nutritional support',\r\n        recommendations: ['High fiber diet', 'Hydration', 'Specialist referral'],\r\n        applicableStages: ['early', 'advanced']\r\n      },\r\n      // ...other QoL topics\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Fatigue', severity: 'medium' },\r\n      { symptom: 'Abdominal pain', severity: 'high' },\r\n      { symptom: 'Weight loss', severity: 'medium' }\r\n    ]\r\n  },\r\n  prostate: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [{ title: 'PSA test', frequency: 'Every 3 months for 2 years' }],\r\n        '6mo': [{ title: 'Physical exam', frequency: 'Every 6 months' }],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [\r\n          { title: 'PSA test', frequency: 'Every 6 months', duration: '5 years' }\r\n        ],\r\n        imaging: [\r\n          { title: 'MRI', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ]\r\n      },\r\n      advanced: {\r\n        surveillance: [\r\n          { title: 'Bone scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        imaging: [\r\n          { title: 'CT scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Tumor markers', frequency: 'As clinically indicated' }\r\n        ]\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'Urinary retention', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Bone pain', severity: 'warning', action: 'Further investigation' },\r\n      { symptom: 'Weight loss', severity: 'warning', action: 'Further investigation' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Sexual health',\r\n        description: 'Support for sexual health',\r\n        recommendations: ['Counseling', 'Medications', 'Specialist referral'],\r\n        applicableStages: ['early', 'advanced']\r\n      },\r\n      // ...other QoL topics\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Fatigue', severity: 'medium' },\r\n      { symptom: 'Urinary issues', severity: 'high' },\r\n      { symptom: 'Erectile dysfunction', severity: 'medium' }\r\n    ]\r\n  },\r\n  pancreatic: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [\r\n          { title: 'CA 19-9', frequency: 'Every 3 months', duration: '2 years' },\r\n          { title: 'CT abdomen', frequency: 'Every 3-6 months', duration: '2 years' }\r\n        ],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [\r\n          { title: 'CA 19-9', frequency: 'Every 3 months', duration: '2 years' }\r\n        ],\r\n        imaging: [\r\n          { title: 'CT scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Blood tests', frequency: 'As clinically indicated' }\r\n        ]\r\n      },\r\n      advanced: {\r\n        surveillance: [\r\n          { title: 'PET scan', frequency: 'As clinically indicated' }\r\n        ],\r\n        imaging: [\r\n          { title: 'MRI', frequency: 'As clinically indicated' }\r\n        ],\r\n        labTests: [\r\n          { title: 'Tumor markers', frequency: 'As clinically indicated' }\r\n        ]\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'Jaundice', severity: 'urgent', action: 'Immediate referral' },\r\n      { symptom: 'Abdominal pain', severity: 'warning', action: 'Further investigation' },\r\n      { symptom: 'Weight loss', severity: 'warning', action: 'Further investigation' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Nutritional support',\r\n        description: 'Support for maintaining nutrition',\r\n        recommendations: ['High calorie diet', 'Enzyme supplements', 'Specialist referral'],\r\n        applicableStages: ['early', 'advanced']\r\n      },\r\n      // ...other QoL topics\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Fatigue', severity: 'medium' },\r\n      { symptom: 'Abdominal pain', severity: 'high' },\r\n      { symptom: 'Weight loss', severity: 'medium' }\r\n    ]\r\n  },\r\n  esophageal: {\r\n    metadata: {\r\n      version: '1.0.0',\r\n      lastUpdated: '2024-01-20'\r\n    },\r\n    intervals: {\r\n      curative: {\r\n        '3mo': [\r\n          { title: 'CT chest/abdomen', frequency: 'Every 3-6 months', duration: '2 years' },\r\n          { title: 'Endoscopy', frequency: 'Every 6 months', duration: '2 years' }\r\n        ],\r\n        '6mo': [\r\n          { title: 'Physical exam', frequency: 'Every 6 months', duration: '3 years' },\r\n          { title: 'Nutritional assessment', frequency: 'Every 6 months' }\r\n        ],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      },\r\n      palliative: {\r\n        '3mo': [\r\n          { title: 'Symptom assessment', frequency: 'Every 3 months' },\r\n          { title: 'Weight monitoring', frequency: 'Every visit' }\r\n        ],\r\n        '6mo': [],\r\n        '1yr': [],\r\n        '2yr': [],\r\n        '5yr': []\r\n      }\r\n    },\r\n    stageGuidelines: {\r\n      early: {\r\n        surveillance: [],\r\n        imaging: [],\r\n        labTests: []\r\n      },\r\n      advanced: {\r\n        surveillance: [],\r\n        imaging: [],\r\n        labTests: []\r\n      }\r\n    },\r\n    surveillance: {\r\n      investigations: [],\r\n      examinations: []\r\n    },\r\n    redFlags: [\r\n      { symptom: 'Progressive dysphagia', severity: 'urgent', action: 'Immediate evaluation' },\r\n      { symptom: 'Weight loss > 5%', severity: 'warning', action: 'Early review' }\r\n    ],\r\n    urgentFlags: [],\r\n    qolTopics: [\r\n      {\r\n        topic: 'Nutrition',\r\n        description: 'Managing eating difficulties and maintaining weight',\r\n        recommendations: ['Small frequent meals', 'Soft diet when needed'],\r\n        applicableStages: ['early', 'advanced']\r\n      }\r\n    ],\r\n    commonSymptoms: [\r\n      { symptom: 'Swallowing difficulty', severity: 'high', relatedFlags: ['Progressive dysphagia'] }\r\n    ]\r\n  },\r\n  bladder: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  headneck: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  ovarian: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  gastric: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  lymphoma: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  melanoma: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  thyroid: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  hepatocellular: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  testicular: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  brain: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n  sarcoma: {\r\n    metadata: { version: '1.0.0', lastUpdated: '2024-01-20' },\r\n    intervals: {\r\n      curative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] },\r\n      palliative: { '3mo': [], '6mo': [], '1yr': [], '2yr': [], '5yr': [] }\r\n    },\r\n    stageGuidelines: {\r\n      early: { surveillance: [], imaging: [], labTests: [] },\r\n      advanced: { surveillance: [], imaging: [], labTests: [] }\r\n    },\r\n    surveillance: { investigations: [], examinations: [] },\r\n    redFlags: [],\r\n    urgentFlags: [],\r\n    qolTopics: [],\r\n    commonSymptoms: []\r\n  },\r\n};\r\n","import { FollowUpTemplate, CancerType } from '../data/followUpTemplates';\r\n\r\ninterface ValidationResult {\r\n  isValid: boolean;\r\n  errors: string[];\r\n  warnings: string[];\r\n}\r\n\r\nexport const validateTemplate = (\r\n  template: FollowUpTemplate,\r\n  cancerType: CancerType\r\n): ValidationResult => {\r\n  const errors: string[] = [];\r\n  const warnings: string[] = [];\r\n\r\n  // Required sections check\r\n  const requiredSections = [\r\n    'intervals',\r\n    'surveillance',\r\n    'redFlags',\r\n    'urgentFlags',\r\n    'qolTopics',\r\n    'commonSymptoms'\r\n  ];\r\n\r\n  requiredSections.forEach(section => {\r\n    if (!template[section]) {\r\n      errors.push(`Missing required section: ${section}`);\r\n    }\r\n  });\r\n\r\n  // Validate template structure\r\n  if (!template.metadata?.version) {\r\n    errors.push('Missing template version');\r\n  }\r\n\r\n  // Validate intervals\r\n  Object.entries(template.intervals).forEach(([intent, intervals]) => {\r\n    if (Object.keys(intervals).length === 0) {\r\n      errors.push(`No follow-up intervals defined for ${intent} intent`);\r\n    }\r\n  });\r\n\r\n  // Validate symptom mappings\r\n  template.commonSymptoms.forEach(symptom => {\r\n    if (!['low', 'medium', 'high'].includes(symptom.severity)) {\r\n      errors.push(`Invalid severity for symptom: ${symptom.symptom}`);\r\n    }\r\n  });\r\n\r\n  // Validate red flags\r\n  template.redFlags.forEach(flag => {\r\n    if (!template.commonSymptoms.some(s => \r\n      s.relatedFlags?.includes(flag.symptom)\r\n    )) {\r\n      warnings.push(`Red flag \"${flag.symptom}\" not linked to any common symptoms`);\r\n    }\r\n  });\r\n\r\n  // Validate QoL topics\r\n  if (template.qolTopics.length === 0) {\r\n    errors.push('No quality of life topics defined');\r\n  }\r\n\r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors,\r\n    warnings\r\n  };\r\n};\r\n\r\nexport const formatFrequency = (frequency: string): string => {\r\n  // Convert standardized frequency to human-readable format\r\n  const patterns = {\r\n    '3m': '3 months',\r\n    '6m': '6 months',\r\n    '1y': '1 year'\r\n  };\r\n  return patterns[frequency] || frequency;\r\n};\r\n","import { CancerType, Intent, cancerTemplates, FollowUpTemplate } from '../data/followUpTemplates';\r\nimport { validateTemplate, formatFrequency } from '../utils/templateValidation';\r\n\r\nexport type Stage = {\r\n  t: string;\r\n  n: string;\r\n  m: string;\r\n};\r\n\r\nexport interface FollowUpPlan {\r\n  timeline: Array<{\r\n    interval: string;\r\n    actions: string[];\r\n    dueDate?: Date;\r\n    guidelines: string[];\r\n  }>;\r\n  surveillance: {\r\n    investigations: Array<{\r\n      title: string;\r\n      frequency: string;\r\n      isDue: boolean;\r\n    }>;\r\n    examinations: Array<{\r\n      title: string;\r\n      frequency: string;\r\n      isDue: boolean;\r\n    }>;\r\n  };\r\n  redFlags: string[];\r\n  urgentFlags: string[];\r\n  qolTopics: Array<{\r\n    topic: string;\r\n    description: string;\r\n    recommendations: string[];\r\n  }>;\r\n  commonSymptoms: Array<{\r\n    symptom: string;\r\n    severity: 'low' | 'medium' | 'high';\r\n  }>;\r\n}\r\n\r\ninterface GuidelineItem {\r\n  frequency: string;\r\n}\r\n\r\nexport const generateFollowUpPlan = (\r\n  cancerType: CancerType,\r\n  stage: Stage,\r\n  intent: Intent\r\n): FollowUpPlan => {\r\n  const template = cancerTemplates[cancerType];\r\n  const { isValid, errors } = validateTemplate(template, cancerType);\r\n\r\n  if (!isValid) {\r\n    console.error(`Template validation failed for ${cancerType}:`, errors);\r\n    throw new Error('Invalid follow-up template');\r\n  }\r\n\r\n  const stageKey = `${stage.t}${stage.n}${stage.m}`;\r\n  const stageGuidelines = template.stageGuidelines[stageKey as keyof typeof template.stageGuidelines];\r\n  \r\n  // Convert the guidelines structure to the expected format\r\n  const guidelines: GuidelineItem[] = [\r\n    ...(stageGuidelines?.surveillance || []).map(item => ({ frequency: item.frequency })),\r\n    ...(stageGuidelines?.imaging || []).map(item => ({ frequency: item.frequency })),\r\n    ...(stageGuidelines?.labTests || []).map(item => ({ frequency: item.frequency }))\r\n  ];\r\n\r\n  const intervals = template.intervals[intent] || {};\r\n\r\n  return {\r\n    timeline: Object.entries(intervals).map(([interval, actions]) => ({\r\n      interval: formatFrequency(interval),\r\n      actions: actions.map(a => `${a.title} (${formatFrequency(a.frequency)})`),\r\n      guidelines: guidelines.map((g: GuidelineItem) => formatFrequency(g.frequency))\r\n    })),\r\n    surveillance: {\r\n      investigations: template.surveillance.investigations.map(i => ({ ...i, isDue: false })),\r\n      examinations: template.surveillance.examinations.map(i => ({ ...i, isDue: false }))\r\n    },\r\n    redFlags: template.redFlags.map(flag => flag.symptom),\r\n    urgentFlags: template.urgentFlags.map(flag => flag.condition),\r\n    qolTopics: template.qolTopics,\r\n    commonSymptoms: template.commonSymptoms\r\n  };\r\n};\r\n\r\nexport const evaluateSymptoms = (\r\n  symptoms: string[],\r\n  cancerType: CancerType\r\n): { matches: string[]; riskLevel: 'low' | 'medium' | 'high' } => {\r\n  return { matches: [], riskLevel: 'low' };\r\n};\r\n","interface AIRequest {\r\n  prompt: string;\r\n  context?: string;\r\n}\r\n\r\ninterface AIResponse {\r\n  summary: string;\r\n}\r\n\r\ninterface AIError {\r\n  error: string;\r\n  details?: string;\r\n}\r\n\r\nconst MAX_RETRIES = 1;\r\nconst RETRY_DELAY = 1000;\r\nconst CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours\r\n\r\nexport class AIAssistantError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public statusCode?: number,\r\n    public details?: string\r\n  ) {\r\n    super(message);\r\n    this.name = 'AIAssistantError';\r\n  }\r\n}\r\n\r\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\nexport async function generateSummary(request: AIRequest): Promise<string> {\r\n  let lastError: Error | undefined;\r\n  \r\n  for (let attempt = 0; attempt <= MAX_RETRIES; attempt++) {\r\n    try {\r\n      if (attempt > 0) {\r\n        await delay(RETRY_DELAY);\r\n      }\r\n\r\n      const response = await fetch('/api/ai/generate-summary', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(request),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData: AIError = await response.json();\r\n        if (response.status === 429) {\r\n          throw new AIAssistantError(\r\n            'Rate limit exceeded. Please try again later.',\r\n            429\r\n          );\r\n        }\r\n        throw new AIAssistantError(\r\n          errorData.error || 'Failed to generate summary',\r\n          response.status,\r\n          errorData.details\r\n        );\r\n      }\r\n\r\n      const data: AIResponse = await response.json();\r\n      return data.summary;\r\n    } catch (error: any) {\r\n      console.error(`AI Summary Generation Error (Attempt ${attempt + 1}/${MAX_RETRIES + 1}):`, error);\r\n      lastError = error;\r\n      \r\n      // Don't retry on specific errors\r\n      if (error.statusCode === 429 || error.statusCode === 400) {\r\n        throw error;\r\n      }\r\n    }\r\n  }\r\n\r\n  throw lastError || new AIAssistantError('Failed to generate summary after retries');\r\n}\r\n\r\n// Cache implementation\r\ninterface CacheEntry {\r\n  summary: string;\r\n  timestamp: number;\r\n}\r\n\r\nexport function getCachedSummary(key: string): string | null {\r\n  try {\r\n    const cached = localStorage.getItem(`ai_summary_${key}`);\r\n    if (!cached) return null;\r\n\r\n    const entry: CacheEntry = JSON.parse(cached);\r\n    if (Date.now() - entry.timestamp > CACHE_DURATION) {\r\n      localStorage.removeItem(`ai_summary_${key}`);\r\n      return null;\r\n    }\r\n\r\n    return entry.summary;\r\n  } catch (error) {\r\n    console.error('Cache read error:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function cacheSummary(key: string, summary: string): void {\r\n  try {\r\n    const entry: CacheEntry = {\r\n      summary,\r\n      timestamp: Date.now()\r\n    };\r\n    localStorage.setItem(`ai_summary_${key}`, JSON.stringify(entry));\r\n  } catch (error) {\r\n    console.error('Cache write error:', error);\r\n  }\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { toast } from '@/components/ui/use-toast';\r\nimport { generateSummary } from '@/services/aiAssistant';\r\nimport type { CancerType } from '../data/followUpTemplates';\r\nimport type { FollowUpPlan } from '../logic/generateFollowUpPlan';\r\nimport type { TNMStage } from '../../types/evaluation';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Download } from 'lucide-react';\r\n\r\ninterface Props {\r\n  cancerType: CancerType;\r\n  stage: TNMStage;\r\n  intent: 'follow-up';\r\n  plan: FollowUpPlan;\r\n  onInsightsReady?: (insights: string) => void;\r\n}\r\n\r\nconst AIFollowUpAssistant: React.FC<Props> = ({ cancerType, stage, intent, plan, onInsightsReady }) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [insights, setInsights] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    async function analyzePlan() {\r\n      if (!plan) return;\r\n      \r\n      setLoading(true);\r\n      setError(null);\r\n      setInsights(null);\r\n\r\n      try {\r\n        const context = `\r\nCancer Type: ${cancerType}\r\nDisease Stage: ${stage}\r\nTreatment Intent: ${intent}\r\n\r\nFollow-up Plan:\r\nTimeline: ${plan.timeline.map(t => `${t.interval}: ${t.actions.join(', ')}`).join('\\n')}\r\n\r\nSurveillance:\r\nInvestigations: ${plan.surveillance.investigations.map(i => i.title).join(', ')}\r\nExaminations: ${plan.surveillance.examinations.map(e => e.title).join(', ')}\r\n\r\nRed Flags to Monitor: ${plan.redFlags.join(', ')}\r\nUrgent Flags: ${plan.urgentFlags.join(', ')}\r\n\r\nQuality of Life Topics: ${plan.qolTopics.map(t => t.topic).join(', ')}\r\nCommon Symptoms to Monitor: ${plan.commonSymptoms.map(s => s.symptom).join(', ')}\r\n`;\r\n\r\n        const aiResponse = await generateSummary({\r\n          prompt: \"Review this oncology follow-up plan and provide enhanced recommendations. Consider surveillance frequency, symptom monitoring, quality of life aspects, and potential areas needing closer monitoring. Suggest any additional screenings or monitoring based on current guidelines.\",\r\n          context\r\n        });\r\n\r\n        setInsights(aiResponse);\r\n\r\n        if (onInsightsReady) {\r\n          onInsightsReady(aiResponse);\r\n        }\r\n\r\n        toast({\r\n          title: \"AI Follow-up Insights\",\r\n          description: aiResponse,\r\n          duration: 10000\r\n        });\r\n\r\n      } catch (error: any) {\r\n        console.error('AI Analysis Error:', error);\r\n        setError(error.message || 'Failed to analyze follow-up plan');\r\n        toast({\r\n          title: \"AI Analysis Failed\",\r\n          description: \"Unable to provide AI insights at this time. Using standard follow-up plan.\",\r\n          variant: \"destructive\"\r\n        });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    analyzePlan();\r\n  }, [cancerType, stage, intent, plan, onInsightsReady]);\r\n\r\n  const handleExport = () => {\r\n    if (!insights) return;\r\n    const blob = new Blob([insights], { type: 'text/markdown' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `followup-summary-${cancerType}.md`;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center gap-2 text-sm text-indigo-600 dark:text-indigo-300 animate-pulse\">\r\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n        AI analyzing follow-up plan...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"text-sm text-red-600 dark:text-red-400\">\r\n        {error}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (insights) {\r\n    return (\r\n      <div className=\"mt-2 flex flex-col gap-2\">\r\n        <div className=\"prose prose-sm dark:prose-invert max-w-none border rounded p-2 bg-gray-50 dark:bg-gray-800\">\r\n          <pre className=\"whitespace-pre-wrap text-xs\">{insights}</pre>\r\n        </div>\r\n        {/* Fallback: Remove Tooltip if API is unknown or not compatible */}\r\n        <Button variant=\"outline\" size=\"sm\" onClick={handleExport} className=\"self-end flex items-center gap-1\" title=\"Export summary as Markdown\">\r\n          <Download className=\"w-4 h-4\" /> Export Markdown\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default AIFollowUpAssistant;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { toast } from '@/components/ui/use-toast';\r\nimport { CancerSelector } from './components/CancerSelector';\r\nimport { DiagnosticTimeline } from './components/DiagnosticTimeline';\r\nimport { PerformanceScoreChart } from './components/PerformanceScoreChart';\r\nimport { SmartFollowUpSummary } from './components/SmartFollowUpSummary';\r\nimport { mockDiagnosticEvents, mockPerformanceData } from './data/followUpData';\r\nimport { TNMStage, PerformanceStatus } from '../types/evaluation';\r\nimport { CancerType } from './data/followUpTemplates';\r\nimport { generateFollowUpPlan, Stage } from './logic/generateFollowUpPlan';\r\nimport ErrorBoundary from '@/components/ErrorBoundary';\r\nimport { callAIAgent } from '@/lib/api/aiAgentAPI';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Tooltip, TooltipProvider, TooltipTrigger, TooltipContent } from '@/components/ui/tooltip';\r\nimport AIFollowUpAssistant from './components/AIFollowUpAssistant';\r\n\r\n// Helper type and functions for mock data\r\ntype MockData<T> = {\r\n  [K in CancerType]?: T;\r\n};\r\n\r\nfunction hasData<T>(data: MockData<T>, cancer: CancerType): boolean {\r\n  return cancer in data;\r\n}\r\n\r\nfunction getMockData<T>(data: MockData<T>, cancer: CancerType): T | undefined {\r\n  return hasData(data, cancer) ? data[cancer] : undefined;\r\n}\r\n\r\nconst FollowUpOncology: React.FC = () => {\r\n  const [mockMode, setMockMode] = useState(false);\r\n  const [selectedCancer, setSelectedCancer] = useState<CancerType | null>(null);\r\n  const [stage, setStage] = useState<TNMStage>({ t: '', n: '', m: '' });\r\n  const [intent, setIntent] = useState<'curative' | 'palliative'>('curative');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [followUpPlan, setFollowUpPlan] = useState<any>(null);\r\n  const [aiInsights, setAIInsights] = useState<string | null>(null);\r\n\r\n  // Generate follow-up plan when cancer type changes\r\n  useEffect(() => {\r\n    if (selectedCancer) {\r\n      setIsLoading(true);\r\n      try {\r\n        // Use stage directly since it already has the correct shape\r\n        const plan = generateFollowUpPlan(selectedCancer, stage, intent);\r\n        setFollowUpPlan(plan);\r\n      } catch (error) {\r\n        toast({\r\n          title: \"Error\",\r\n          description: \"Failed to generate follow-up plan. Please try again.\",\r\n          variant: \"destructive\"\r\n        });\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    }\r\n  }, [selectedCancer, stage, intent]);\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <div className=\"space-y-6 p-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-200\">Follow-up Oncology</h2>\r\n          <button\r\n            onClick={() => setMockMode(!mockMode)}\r\n            className={`px-3 py-1 rounded-full text-sm font-medium ${\r\n              mockMode ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'\r\n            }`}\r\n          >\r\n            {mockMode ? 'ðŸ§ª Mock Mode' : 'ðŸ¤– Gemini Mode'}\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n          <motion.div \r\n            className=\"p-4 bg-white dark:bg-gray-800 rounded-lg shadow\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n          >\r\n            <CancerSelector\r\n              selected={selectedCancer}\r\n              onSelect={setSelectedCancer}\r\n            />\r\n          </motion.div>\r\n\r\n          {selectedCancer && !isLoading && (\r\n            <>\r\n              <motion.div \r\n                className=\"p-4 bg-white dark:bg-gray-800 rounded-lg shadow\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n              >\r\n                <Card className=\"dark:bg-gray-900 shadow-lg\">\r\n                  <CardHeader>\r\n                    <CardTitle>\r\n                      <TooltipProvider>\r\n                        <Tooltip>\r\n                          <TooltipTrigger asChild>\r\n                            <span>Diagnostic Timeline</span>\r\n                          </TooltipTrigger>\r\n                          <TooltipContent>\r\n                            <p>Key milestones in the diagnostic journey</p>\r\n                          </TooltipContent>\r\n                        </Tooltip>\r\n                      </TooltipProvider>\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <DiagnosticTimeline \r\n                      events={getMockData(mockDiagnosticEvents, selectedCancer) || []}\r\n                    />\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n\r\n              <motion.div \r\n                className=\"lg:col-span-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n              >\r\n                <Card className=\"dark:bg-gray-900 shadow-lg\">\r\n                  <CardHeader>\r\n                    <CardTitle>\r\n                      <TooltipProvider>\r\n                        <Tooltip>\r\n                          <TooltipTrigger asChild>\r\n                            <span>Performance Score Trends</span>\r\n                          </TooltipTrigger>\r\n                          <TooltipContent>\r\n                            <p>ECOG and KPS scores over time</p>\r\n                          </TooltipContent>\r\n                        </Tooltip>\r\n                      </TooltipProvider>\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <PerformanceScoreChart \r\n                      data={getMockData(mockPerformanceData, selectedCancer) || []}\r\n                    />\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n\r\n              <motion.div \r\n                className=\"lg:col-span-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n              >\r\n                <Card className=\"dark:bg-gray-900 shadow-lg\">\r\n                  <CardHeader>\r\n                    <CardTitle>\r\n                      <TooltipProvider>\r\n                        <Tooltip>\r\n                          <TooltipTrigger asChild>\r\n                            <span>Smart Follow-Up Summary</span>\r\n                          </TooltipTrigger>\r\n                          <TooltipContent>\r\n                            <p>AI-generated follow-up summary and recommendations</p>\r\n                          </TooltipContent>\r\n                        </Tooltip>\r\n                      </TooltipProvider>\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <SmartFollowUpSummary\r\n                      cancerType={selectedCancer}\r\n                      stage={`${stage.t}${stage.n}${stage.m}`}\r\n                      tnmStage={stage}\r\n                      diagnosisDate=\"2025-04-01\"\r\n                      currentECOG={0}\r\n                      currentKPS={90}\r\n                      onGenerate={async () => {\r\n                        try {\r\n                          const response = await callAIAgent({\r\n                            module: 'OPD',\r\n                            intent: 'follow-up',\r\n                            prompt: \"Generate a follow-up summary and recommendations\",\r\n                            context: `Cancer Type: ${selectedCancer}\\nStage: ${stage.t}${stage.n}${stage.m}\\nIntent: ${intent}`,\r\n                            mockMode\r\n                          });\r\n                          return response.content;\r\n                        } catch (error) {\r\n                          console.error('Error generating AI summary:', error);\r\n                          throw error;\r\n                        }\r\n                      }}\r\n                    />\r\n                    <AIFollowUpAssistant \r\n                      cancerType={selectedCancer}\r\n                      stage={stage}\r\n                      intent=\"follow-up\"\r\n                      plan={followUpPlan}\r\n                      onInsightsReady={setAIInsights}\r\n                    />\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            </>\r\n          )}\r\n\r\n          {isLoading && (\r\n            <motion.div \r\n              className=\"flex justify-center items-center p-12\"\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n            >\r\n              <div className=\"animate-pulse flex space-x-4\">\r\n                <div className=\"h-12 w-12 bg-gray-200 dark:bg-gray-700 rounded-full\"></div>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\r\n                  <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32\"></div>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default FollowUpOncology;\r\n","import React from \"react\";\r\nimport { Tab } from \"@headlessui/react\";\r\nimport {\r\n  UserCheck,\r\n  ScanLine,\r\n  ShieldCheck,\r\n  Send,\r\n  CalendarClock,\r\n} from \"lucide-react\";\r\n\r\nimport EvaluationCard from \"../cards/EvaluationCard\";\r\nimport PathwayCard from \"../cards/PathwayCard\";\r\nimport ScreeningCard from \"../cards/ScreeningCard\";\r\nimport ReferralCard from \"../cards/ReferralCard\";\r\nimport FollowUpCard from \"../cards/FollowUpCard\";\r\nimport AISummary from \"./AISummary\";\r\n\r\nimport PatientEvaluation from \"../patient-evaluation/PatientEvaluation\";\r\nimport DiagnosticPathways from \"../diagnostic-pathways/DiagnosticPathways\";\r\nimport CancerScreening from \"../cancer-screening/CancerScreening\";\r\nimport ReferralGuidelines from \"../referral-guidelines/ReferralGuidelines\";\r\nimport FollowUpOncology from \"../follow-up-oncology/FollowUpOncology\";\r\n\r\nconst tabs = [\r\n  { \r\n    label: \"Patient Evaluation\", \r\n    icon: UserCheck, \r\n    component: PatientEvaluation, \r\n    card: EvaluationCard \r\n  },\r\n  { \r\n    label: \"Diagnostic Pathways\", \r\n    icon: ScanLine, \r\n    component: DiagnosticPathways, \r\n    card: PathwayCard \r\n  },\r\n  { \r\n    label: \"Cancer Screening\", \r\n    icon: ShieldCheck, \r\n    component: CancerScreening, \r\n    card: ScreeningCard \r\n  },\r\n  { \r\n    label: \"Referral Guidelines\", \r\n    icon: Send, \r\n    component: ReferralGuidelines, \r\n    card: ReferralCard \r\n  },\r\n  { \r\n    label: \"Follow-Up Oncology\", \r\n    icon: CalendarClock, \r\n    component: FollowUpOncology, \r\n    card: FollowUpCard \r\n  },\r\n];\r\n\r\nconst OPDModule: React.FC = () => {\r\n  // Mock patient data for AI summary demonstration\r\n  const mockPatientData = {\r\n    age: 58,\r\n    gender: \"female\",\r\n    chiefComplaint: \"Persistent cough and weight loss\",\r\n    riskFactors: [\"Smoking history\", \"Family history of lung cancer\"]\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-3xl font-bold text-gray-800 mb-8 flex items-center gap-2\">\r\n        ðŸ¥ Oncology OPD Module\r\n      </h1>\r\n\r\n      <Tab.Group>\r\n        <Tab.List className=\"flex space-x-2 mb-8\">\r\n          {tabs.map(({ label, icon: Icon }) => (\r\n            <Tab\r\n              key={label}\r\n              className={({ selected }) => `\r\n                opd-tab flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all\r\n                ${\r\n                  selected\r\n                    ? \"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-md scale-[1.02]\"\r\n                    : \"bg-white text-gray-700 hover:bg-gray-50 hover:text-indigo-600\"\r\n                }\r\n              `}\r\n            >\r\n              <Icon className=\"w-4 h-4\" />\r\n              {label}\r\n            </Tab>\r\n          ))}\r\n        </Tab.List>\r\n        \r\n        <Tab.Panels>\r\n          {tabs.map(({ label, component: Component, card: Card }) => (\r\n            <Tab.Panel key={label}>\r\n              <Card>\r\n                <Component />\r\n                <AISummary patientData={mockPatientData} isEnabled={true} />\r\n              </Card>\r\n            </Tab.Panel>\r\n          ))}\r\n        </Tab.Panels>\r\n      </Tab.Group>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OPDModule;\r\n","import React, { ReactNode } from 'react';\r\nimport '../styles/opd.css';\r\n\r\ninterface OPDLayoutProps {\r\n  children: ReactNode;\r\n}\r\n\r\nconst OPDLayout: React.FC<OPDLayoutProps> = ({ children }) => {\r\n  return (\r\n    <div className=\"opd-module\">\r\n      <div className=\"opd-content p-6\">\r\n        <div className=\"max-w-5xl mx-auto\">\r\n          {children}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OPDLayout;\r\n","import React from 'react';\r\nimport { AlertTriangle, CheckCircle } from 'lucide-react';\r\nimport { EvaluationTemplate } from '../types/evaluation';\r\n\r\ninterface EvaluationSummaryProps {\r\n  template: EvaluationTemplate;\r\n  formData: Record<string, string>;\r\n}\r\n\r\nexport const EvaluationSummary: React.FC<EvaluationSummaryProps> = ({ template, formData }) => {\r\n  const missingRequired = template.sections\r\n    .flatMap((section, sIndex) => \r\n      section.items\r\n        .map((item, iIndex) => ({\r\n          item,\r\n          id: `section-${sIndex}-item-${iIndex}`,\r\n        }))\r\n    )\r\n    .filter(({ item, id }) => \r\n      item.required && (!formData[id] || formData[id].trim() === '')\r\n    );\r\n\r\n  const hasAllRequired = missingRequired.length === 0;\r\n\r\n  return (\r\n    <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200\">\r\n      <h3 className=\"font-semibold text-gray-900 mb-3\">Evaluation Summary</h3>\r\n\r\n      {/* Required Fields Status */}\r\n      <div className=\"flex items-center gap-2 mb-2\">\r\n        {hasAllRequired ? (\r\n          <CheckCircle className=\"w-5 h-5 text-green-500\" />\r\n        ) : (\r\n          <AlertTriangle className=\"w-5 h-5 text-amber-500\" />\r\n        )}\r\n        <span className={hasAllRequired ? \"text-green-700\" : \"text-amber-700\"}>\r\n          {hasAllRequired \r\n            ? \"All required fields are completed\"\r\n            : `${missingRequired.length} required field(s) need attention`}\r\n        </span>\r\n      </div>\r\n\r\n      {/* Missing Required Fields */}\r\n      {!hasAllRequired && (\r\n        <div className=\"mt-2 pl-7\">\r\n          <ul className=\"list-disc text-sm text-amber-700\">\r\n            {missingRequired.map(({ item, id }) => (\r\n              <li key={id}>{item.text}</li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n\r\n      {/* Red Flags Check */}\r\n      <div className=\"mt-4\">\r\n        <div className=\"flex items-center gap-2 mb-2\">\r\n          <AlertTriangle className=\"w-5 h-5 text-red-500\" />\r\n          <span className=\"text-red-700 font-medium\">Red Flag Checks</span>\r\n        </div>\r\n        <ul className=\"pl-7 list-disc text-sm text-red-700 space-y-1\">\r\n          {template.redFlags.map((flag, index) => (\r\n            <li key={index}>{flag}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { CancerTypeTemplate } from '../types/evaluation';\r\n\r\nexport const evaluationTemplates: CancerTypeTemplate = {\r\n  breast: {\r\n    sections: [\r\n      {\r\n        title: \"Clinical Presentation\",\r\n        items: [\r\n          {\r\n            text: \"Breast Mass Characteristics\",\r\n            tooltip: \"Size, location, mobility, skin changes, nipple changes\",\r\n            required: true,\r\n            redFlags: [\"Skin ulceration\", \"Peau d'orange\", \"Fixed mass\"]\r\n          },\r\n          {\r\n            text: \"Lymph Node Status\",\r\n            tooltip: \"Axillary, supraclavicular, cervical nodes\",\r\n            required: true\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Document distance from nipple\", \"Check for bilateral findings\"]\r\n      },\r\n      {\r\n        title: \"Risk Assessment\",\r\n        items: [\r\n          {\r\n            text: \"Family History\",\r\n            tooltip: \"First-degree relatives with breast/ovarian cancer, age at diagnosis\",\r\n            required: true,\r\n            redFlags: [\"Multiple affected relatives\", \"Young age at diagnosis\"]\r\n          },\r\n          {\r\n            text: \"Genetic Factors\",\r\n            tooltip: \"Known BRCA status, other genetic syndromes\",\r\n            required: false\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Consider mammogram Â± ultrasound for imaging\",\r\n      \"Assess BIRADS category if imaging available\",\r\n      \"Consider genetic counseling if strong family history\"\r\n    ],\r\n    redFlags: [\r\n      \"Inflammatory breast cancer signs\",\r\n      \"Nipple discharge/retraction\",\r\n      \"Axillary lymphadenopathy\"\r\n    ]\r\n  },\r\n  lung: {\r\n    sections: [\r\n      {\r\n        title: \"Respiratory Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Cough Characteristics\",\r\n            tooltip: \"Duration, type, hemoptysis\",\r\n            required: true,\r\n            redFlags: [\"Hemoptysis\", \"Stridor\"]\r\n          },\r\n          {\r\n            text: \"Systemic Symptoms\",\r\n            tooltip: \"Weight loss, fatigue, chest pain\",\r\n            required: true\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Quantify pack-years if smoker\", \"Note occupational exposures\"]\r\n      },\r\n      {\r\n        title: \"Metastatic Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Neurological Symptoms\",\r\n            tooltip: \"Headache, weakness, confusion\",\r\n            required: true,\r\n            redFlags: [\"New neurological symptoms\", \"Severe headache\"]\r\n          },\r\n          {\r\n            text: \"Bone Pain\",\r\n            tooltip: \"Location, severity, duration\",\r\n            required: true\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Order chest CT if suspicious\",\r\n      \"Consider PET-CT for staging\",\r\n      \"Assess smoking cessation support needs\"\r\n    ],\r\n    redFlags: [\r\n      \"Superior vena cava syndrome\",\r\n      \"Severe dyspnea\",\r\n      \"Significant hemoptysis\"\r\n    ]\r\n  },\r\n  prostate: {\r\n    sections: [\r\n      {\r\n        title: \"Urinary Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"LUTS Assessment\",\r\n            tooltip: \"Frequency, urgency, nocturia, stream\",\r\n            required: true,\r\n            redFlags: [\"Acute retention\", \"Severe urinary symptoms\"]\r\n          },\r\n          {\r\n            text: \"Obstructive Symptoms\",\r\n            tooltip: \"Hesitancy, poor stream, retention\",\r\n            required: true,\r\n            redFlags: [\"Complete obstruction\"]\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Document IPSS score\", \"Record voiding diary findings\"]\r\n      },\r\n      {\r\n        title: \"Physical Examination\",\r\n        items: [\r\n          {\r\n            text: \"Digital Rectal Examination\",\r\n            tooltip: \"Size, consistency, nodules, tenderness\",\r\n            required: true,\r\n            redFlags: [\"Hard nodular prostate\", \"Fixed mass\"]\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        title: \"Metastatic Assessment\",\r\n        items: [\r\n          {\r\n            text: \"Bone Pain\",\r\n            tooltip: \"Location, severity, duration\",\r\n            required: true,\r\n            redFlags: [\"Severe back pain\", \"Pathological fracture risk\"]\r\n          },\r\n          {\r\n            text: \"Neurological Symptoms\",\r\n            tooltip: \"Lower limb weakness, sensory changes\",\r\n            required: true,\r\n            redFlags: [\"Cord compression symptoms\"]\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Check PSA level\",\r\n      \"Consider bone scan if indicated\",\r\n      \"Family history documentation essential\",\r\n      \"Consider hereditary cancer syndromes\"\r\n    ],\r\n    redFlags: [\r\n      \"Spinal cord compression\",\r\n      \"Urinary retention\",\r\n      \"Rapidly rising PSA\",\r\n      \"Pathological fracture risk\"\r\n    ]\r\n  },\r\n  lymphoma: {\r\n    sections: [\r\n      {\r\n        title: \"Lymphadenopathy Assessment\",\r\n        items: [\r\n          {\r\n            text: \"Node Characteristics\",\r\n            tooltip: \"Size, location, consistency, mobility\",\r\n            required: true,\r\n            redFlags: [\"Rapid enlargement\", \"Rock-hard nodes\"]\r\n          },\r\n          {\r\n            text: \"Distribution Pattern\",\r\n            tooltip: \"Document all involved sites systematically\",\r\n            required: true\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Map out all involved nodes\", \"Compare with previous examinations\"]\r\n      },\r\n      {\r\n        title: \"B Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Fever Pattern\",\r\n            tooltip: \"Document temperature, duration, pattern\",\r\n            required: true\r\n          },\r\n          {\r\n            text: \"Night Sweats\",\r\n            tooltip: \"Severity, frequency, impact on daily life\",\r\n            required: true\r\n          },\r\n          {\r\n            text: \"Weight Loss\",\r\n            tooltip: \"Amount, duration, associated symptoms\",\r\n            required: true,\r\n            redFlags: [\">10% in 6 months\"]\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        title: \"Systemic Examination\",\r\n        items: [\r\n          {\r\n            text: \"Hepatosplenomegaly\",\r\n            tooltip: \"Size, tenderness, associated symptoms\",\r\n            required: true\r\n          },\r\n          {\r\n            text: \"Extra-nodal Involvement\",\r\n            tooltip: \"Skin lesions, bone pain, CNS symptoms\",\r\n            required: true,\r\n            redFlags: [\"CNS involvement\", \"Airway compromise\"]\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Document performance status\",\r\n      \"Consider PET-CT staging\",\r\n      \"Plan for bone marrow assessment\",\r\n      \"Check EBV status in young patients\"\r\n    ],\r\n    redFlags: [\r\n      \"Superior vena cava syndrome\",\r\n      \"Airway compromise\",\r\n      \"CNS involvement\",\r\n      \"Significant B symptoms\"\r\n    ]\r\n  },\r\n  colon: {\r\n    sections: [\r\n      {\r\n        title: \"Gastrointestinal Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Bowel Habits\",\r\n            tooltip: \"Changes in frequency, caliber, blood in stool\",\r\n            required: true,\r\n            redFlags: [\"Rectal bleeding\", \"Severe constipation\"]\r\n          },\r\n          {\r\n            text: \"Abdominal Symptoms\",\r\n            tooltip: \"Pain, distention, mass\",\r\n            required: true\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Document Bristol stool scale\", \"Note any screening history\"]\r\n      },\r\n      {\r\n        title: \"Risk Assessment\",\r\n        items: [\r\n          {\r\n            text: \"Family History\",\r\n            tooltip: \"History of colorectal cancer or polyps\",\r\n            required: true\r\n          },\r\n          {\r\n            text: \"Lynch Syndrome Screening\",\r\n            tooltip: \"Family history of associated cancers\",\r\n            required: false\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Check hemoglobin level\",\r\n      \"Consider colonoscopy referral\",\r\n      \"Assess for Lynch syndrome criteria\"\r\n    ],\r\n    redFlags: [\r\n      \"Bowel obstruction\",\r\n      \"Significant weight loss\",\r\n      \"Iron deficiency anemia\"\r\n    ]\r\n  },\r\n  ovarian: {\r\n    sections: [\r\n      {\r\n        title: \"Symptoms & History\",\r\n        items: [\r\n          {\r\n            text: \"Abdominal/Pelvic Symptoms\",\r\n            tooltip: \"Bloating, early satiety, abdominal pain\",\r\n            required: true,\r\n            redFlags: [\"Rapidly increasing abdominal girth\", \"Severe pain\"]\r\n          },\r\n          {\r\n            text: \"Menstrual History\",\r\n            tooltip: \"Pattern changes, irregular bleeding\",\r\n            required: true,\r\n            redFlags: [\"Post-menopausal bleeding\"]\r\n          },\r\n          {\r\n            text: \"Constitutional Symptoms\",\r\n            tooltip: \"Weight loss, fatigue, appetite changes\",\r\n            required: true\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Document family history of ovarian/breast cancer\", \"Check BRCA status if applicable\"]\r\n      },\r\n      {\r\n        title: \"Physical Examination\",\r\n        items: [\r\n          {\r\n            text: \"Abdominal Assessment\",\r\n            tooltip: \"Ascites, masses, organomegaly\",\r\n            required: true,\r\n            redFlags: [\"Fixed pelvic mass\", \"Omental cake\"]\r\n          },\r\n          {\r\n            text: \"Pelvic Examination\",\r\n            tooltip: \"Adnexal masses, tenderness\",\r\n            required: true\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Check CA-125 if postmenopausal\",\r\n      \"Consider CT abdomen/pelvis\",\r\n      \"Consider genetic counseling referral\"\r\n    ],\r\n    redFlags: [\r\n      \"Fixed pelvic mass\",\r\n      \"Rapidly growing abdominal distention\",\r\n      \"Significant ascites\"\r\n    ]\r\n  },\r\n  gastric: {\r\n    sections: [\r\n      {\r\n        title: \"Upper GI Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Epigastric Symptoms\",\r\n            tooltip: \"Pain pattern, relation to food, duration\",\r\n            required: true,\r\n            redFlags: [\"Persistent pain\", \"Progressive dysphagia\"]\r\n          },\r\n          {\r\n            text: \"Eating Difficulties\",\r\n            tooltip: \"Loss of appetite, early satiety, weight loss\",\r\n            required: true,\r\n            redFlags: [\"Significant weight loss\", \"Complete dysphagia\"]\r\n          },\r\n          {\r\n            text: \"GI Bleeding Signs\",\r\n            tooltip: \"Hematemesis, melena, chronic blood loss\",\r\n            required: true,\r\n            redFlags: [\"Active bleeding\", \"Severe anemia\"]\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Note H. pylori status if known\", \"Document family history\"]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Check for Virchow's node\",\r\n      \"Consider urgent gastroscopy\",\r\n      \"Check H. pylori status\"\r\n    ],\r\n    redFlags: [\r\n      \"Persistent vomiting\",\r\n      \"Gastrointestinal bleeding\",\r\n      \"Severe weight loss\",\r\n      \"Iron deficiency anemia\"\r\n    ]\r\n  },\r\n  \"head-and-neck\": {\r\n    sections: [\r\n      {\r\n        title: \"ENT Symptoms\",\r\n        items: [\r\n          {\r\n            text: \"Voice Changes\",\r\n            tooltip: \"Hoarseness, duration, progression\",\r\n            required: true,\r\n            redFlags: [\"Progressive hoarseness\", \"Stridor\"]\r\n          },\r\n          {\r\n            text: \"Swallowing Issues\",\r\n            tooltip: \"Dysphagia pattern, odynophagia\",\r\n            required: true,\r\n            redFlags: [\"Complete dysphagia\", \"Aspiration\"]\r\n          },\r\n          {\r\n            text: \"Neck Masses\",\r\n            tooltip: \"Location, size, duration, mobility\",\r\n            required: true,\r\n            redFlags: [\"Rapidly growing mass\", \"Fixed mass\"]\r\n          }\r\n        ],\r\n        cancerSpecificNotes: [\"Document smoking/alcohol history\", \"Note occupational exposures\"]\r\n      },\r\n      {\r\n        title: \"Physical Examination\",\r\n        items: [\r\n          {\r\n            text: \"Oral Cavity Exam\",\r\n            tooltip: \"Mucosal lesions, ulcers, masses\",\r\n            required: true,\r\n            redFlags: [\"Non-healing ulcers\", \"Bleeding lesions\"]\r\n          },\r\n          {\r\n            text: \"Neck Examination\",\r\n            tooltip: \"Systematic lymph node assessment\",\r\n            required: true,\r\n            redFlags: [\"Fixed nodes\", \"Multiple levels involved\"]\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    notes: [\r\n      \"Complete head and neck exam essential\",\r\n      \"Consider nasendoscopy if indicated\",\r\n      \"Document risk factors carefully\"\r\n    ],\r\n    redFlags: [\r\n      \"Stridor or airway compromise\",\r\n      \"Unilateral ear pain\",\r\n      \"Progressive dysphagia\",\r\n      \"Cranial nerve involvement\"\r\n    ]\r\n  }\r\n};\r\n","import React from 'react';\r\n\r\ninterface FormFieldProps {\r\n  id: string;\r\n  label: string;\r\n  tooltip?: string;\r\n  required?: boolean;\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  error?: boolean;\r\n  redFlags?: string[];\r\n  rows?: number;\r\n  inputClassName?: string;\r\n}\r\n\r\nconst FormField: React.FC<FormFieldProps> = ({\r\n  id,\r\n  label,\r\n  tooltip,\r\n  required = false,\r\n  value,\r\n  onChange,\r\n  error = false,\r\n  redFlags = [],\r\n  rows = 3,\r\n  inputClassName\r\n}) => {\r\n  const ariaAttributes: Record<string, string> = {};\r\n  \r\n  if (required) {\r\n    ariaAttributes['aria-required'] = 'true';\r\n  }\r\n  \r\n  if (error) {\r\n    ariaAttributes['aria-invalid'] = 'true';\r\n  }\r\n  \r\n  return (\r\n    <div>\r\n      <div className=\"flex items-center gap-2 mb-1\">\r\n        <label \r\n          htmlFor={id} \r\n          className=\"text-sm font-medium text-gray-900\"\r\n        >\r\n          {label}\r\n          {required && <span className=\"text-red-500 ml-1\">*</span>}\r\n        </label>\r\n      </div>\r\n      <textarea\r\n        id={id}\r\n        value={value}\r\n        onChange={(e) => onChange(e.target.value)}\r\n        placeholder={tooltip}\r\n        rows={rows}\r\n        className={`w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500 ${\r\n          error ? 'border-red-300 bg-red-50' : ''\r\n        } ${inputClassName || ''}`}\r\n        required={required}\r\n        {...ariaAttributes}\r\n      />\r\n      {redFlags.length > 0 && (\r\n        <div className=\"mt-1 text-sm text-red-600\">\r\n          Monitor for: {redFlags.join(', ')}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormField;","import React, { ReactNode, ButtonHTMLAttributes } from 'react';\r\nimport { Loader2 } from 'lucide-react';\r\n\r\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\r\n  children: ReactNode;\r\n  variant?: 'primary' | 'secondary' | 'outline' | 'danger';\r\n  size?: 'sm' | 'md' | 'lg';\r\n  isLoading?: boolean;\r\n  icon?: ReactNode;\r\n  fullWidth?: boolean;\r\n}\r\n\r\nconst Button: React.FC<ButtonProps> = ({\r\n  children,\r\n  variant = 'primary',\r\n  size = 'md',\r\n  isLoading = false,\r\n  disabled = false,\r\n  icon,\r\n  fullWidth = false,\r\n  className = '',\r\n  ...props\r\n}) => {\r\n  // Base classes\r\n  const baseClasses = 'rounded-md inline-flex items-center justify-center transition-colors font-medium';\r\n\r\n  // Size classes\r\n  const sizeClasses = {\r\n    sm: 'px-3 py-1.5 text-sm',\r\n    md: 'px-4 py-2',\r\n    lg: 'px-6 py-3 text-lg'\r\n  };\r\n\r\n  // Variant classes\r\n  const variantClasses = {\r\n    primary: 'bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 shadow-sm',\r\n    secondary: 'bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2',\r\n    outline: 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2',\r\n    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 shadow-sm'\r\n  };\r\n\r\n  // State classes\r\n  const stateClasses = (disabled || isLoading) ? 'opacity-70 cursor-not-allowed' : '';\r\n  \r\n  // Width classes\r\n  const widthClasses = fullWidth ? 'w-full' : '';\r\n\r\n  // Combine all classes\r\n  const buttonClasses = [\r\n    baseClasses,\r\n    sizeClasses[size],\r\n    variantClasses[variant],\r\n    stateClasses,\r\n    widthClasses,\r\n    className\r\n  ].join(' ');\r\n\r\n  return (\r\n    <button\r\n      className={buttonClasses}\r\n      disabled={disabled || isLoading}\r\n      {...props}\r\n    >\r\n      {isLoading && (\r\n        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n      )}\r\n      {!isLoading && icon && (\r\n        <span className=\"mr-2\">{icon}</span>\r\n      )}\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default Button; ","import React, { createContext, useContext, useState, ReactNode, useCallback } from 'react';\r\nimport { CancerType } from '../types/evaluation';\r\n\r\ninterface EvaluationContextType {\r\n  formData: Record<string, string>;\r\n  updateFormField: (id: string, value: string) => void;\r\n  clearFormData: () => void;\r\n  selectedCancerType: CancerType | '';\r\n  setSelectedCancerType: (type: CancerType | '') => void;\r\n  isFormSubmitting: boolean;\r\n  setIsFormSubmitting: (value: boolean) => void;\r\n  formError: string | null;\r\n  setFormError: (error: string | null) => void;\r\n  formSuccess: boolean;\r\n  setFormSuccess: (success: boolean) => void;\r\n}\r\n\r\nconst EvaluationContext = createContext<EvaluationContextType | undefined>(undefined);\r\n\r\nexport const useEvaluation = (): EvaluationContextType => {\r\n  const context = useContext(EvaluationContext);\r\n  if (!context) {\r\n    throw new Error('useEvaluation must be used within an EvaluationProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\ninterface EvaluationProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const EvaluationProvider: React.FC<EvaluationProviderProps> = ({ children }) => {\r\n  const [formData, setFormData] = useState<Record<string, string>>({});\r\n  const [selectedCancerType, setSelectedCancerType] = useState<CancerType | ''>('');\r\n  const [isFormSubmitting, setIsFormSubmitting] = useState(false);\r\n  const [formError, setFormError] = useState<string | null>(null);\r\n  const [formSuccess, setFormSuccess] = useState(false);\r\n\r\n  const updateFormField = useCallback((id: string, value: string) => {\r\n    setFormData(prev => ({ ...prev, [id]: value }));\r\n    \r\n    // Reset submission states when form is edited\r\n    if (formSuccess) setFormSuccess(false);\r\n    if (formError) setFormError(null);\r\n  }, [formSuccess, formError]);\r\n\r\n  const clearFormData = useCallback(() => {\r\n    if (window.confirm('Are you sure you want to clear all form data?')) {\r\n      setFormData({});\r\n      setFormError(null);\r\n      setFormSuccess(false);\r\n    }\r\n  }, []);\r\n\r\n  const value = {\r\n    formData,\r\n    updateFormField,\r\n    clearFormData,\r\n    selectedCancerType,\r\n    setSelectedCancerType,\r\n    isFormSubmitting,\r\n    setIsFormSubmitting,\r\n    formError,\r\n    setFormError,\r\n    formSuccess,\r\n    setFormSuccess,\r\n  };\r\n\r\n  return (\r\n    <EvaluationContext.Provider value={value}>\r\n      {children}\r\n    </EvaluationContext.Provider>\r\n  );\r\n};\r\n\r\nexport default EvaluationContext; ","import { CancerType } from '../modules/opd/types/evaluation';\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\ninterface PatientEvaluation {\r\n  cancerType: CancerType;\r\n  formData: Record<string, string>;\r\n  timestamp: string;\r\n}\r\n\r\nclass APIError extends Error {\r\n  constructor(message: string) {\r\n    super(message);\r\n    this.name = 'APIError';\r\n  }\r\n}\r\n\r\nexport async function savePatientEvaluation(data: PatientEvaluation): Promise<void> {\r\n  const { error } = await supabase\r\n    .from('patient_evaluations')\r\n    .insert([{\r\n      cancer_type: data.cancerType,\r\n      form_data: data.formData,\r\n      timestamp: data.timestamp\r\n    }]);\r\n\r\n  if (error) {\r\n    console.error('Failed to save patient evaluation:', error);\r\n    throw new APIError(error.message);\r\n  }\r\n}\r\n\r\nexport async function getPatientEvaluations(): Promise<PatientEvaluation[]> {\r\n  const { data, error } = await supabase\r\n    .from('patient_evaluations')\r\n    .select('*')\r\n    .order('timestamp', { ascending: false });\r\n\r\n  if (error) {\r\n    console.error('Failed to fetch patient evaluations:', error);\r\n    throw new APIError(error.message);\r\n  }\r\n\r\n  return data.map(row => ({\r\n    cancerType: row.cancer_type,\r\n    formData: row.form_data,\r\n    timestamp: row.timestamp\r\n  }));\r\n}\r\n\r\nexport async function getPatientEvaluation(id: string): Promise<PatientEvaluation> {\r\n  const { data, error } = await supabase\r\n    .from('patient_evaluations')\r\n    .select('*')\r\n    .eq('id', id)\r\n    .single();\r\n\r\n  if (error) {\r\n    console.error('Failed to fetch patient evaluation:', error);\r\n    throw new APIError(error.message);\r\n  }\r\n\r\n  return {\r\n    cancerType: data.cancer_type,\r\n    formData: data.form_data,\r\n    timestamp: data.timestamp\r\n  };\r\n}","import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Check } from 'lucide-react';\r\n\r\ninterface Step {\r\n  id: number;\r\n  name: string;\r\n  description: string;\r\n  status: 'complete' | 'current' | 'upcoming';\r\n}\r\n\r\ninterface ProgressStepperProps {\r\n  steps: Step[];\r\n  currentStep: number;\r\n}\r\n\r\nexport const ProgressStepper: React.FC<ProgressStepperProps> = ({ steps, currentStep }) => {\r\n  return (\r\n    <nav aria-label=\"Progress\" className=\"mb-8\">\r\n      <ol className=\"flex items-center\">\r\n        {steps.map((step, stepIdx) => (\r\n          <li key={step.id} className={`relative ${stepIdx !== steps.length - 1 ? 'flex-1' : ''}`}>\r\n            {step.status === 'complete' ? (\r\n              <motion.div \r\n                className=\"group\"\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.3 }}\r\n              >\r\n                <span className=\"flex items-center\">\r\n                  <span className=\"relative flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600\">\r\n                    <Check className=\"h-5 w-5 text-white\" aria-hidden=\"true\" />\r\n                  </span>\r\n                  <span className=\"ml-3 text-sm font-medium text-gray-900\">{step.name}</span>\r\n                </span>\r\n              </motion.div>\r\n            ) : step.status === 'current' ? (\r\n              <motion.div \r\n                className=\"flex items-center\"\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                transition={{ duration: 0.3 }}\r\n              >\r\n                <span className=\"relative flex h-8 w-8 items-center justify-center rounded-full border-2 border-indigo-600\">\r\n                  <span className=\"h-2.5 w-2.5 rounded-full bg-indigo-600\" />\r\n                </span>\r\n                <span className=\"ml-3 text-sm font-medium text-indigo-600\">{step.name}</span>\r\n              </motion.div>\r\n            ) : (\r\n              <div className=\"flex items-center\">\r\n                <div className=\"relative flex h-8 w-8 items-center justify-center rounded-full border-2 border-gray-300\">\r\n                  <span className=\"h-2.5 w-2.5 rounded-full bg-transparent\" />\r\n                </div>\r\n                <span className=\"ml-3 text-sm font-medium text-gray-500\">{step.name}</span>\r\n              </div>\r\n            )}\r\n\r\n            {stepIdx !== steps.length - 1 && (\r\n              <>\r\n                {/* Separator Line */}\r\n                <div className=\"absolute left-4 top-4 -ml-px mt-0.5 h-0.5 w-full bg-gray-300\">\r\n                  <div\r\n                    className=\"h-full bg-indigo-600 transition-all duration-500\"\r\n                    style={{ width: step.status === 'complete' ? '100%' : '0%' }}\r\n                  />\r\n                </div>\r\n              </>\r\n            )}\r\n          </li>\r\n        ))}\r\n      </ol>\r\n    </nav>\r\n  );\r\n};","import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, Lightbulb, Brain } from 'lucide-react';\r\n\r\ninterface AISidebarProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  currentSection?: string;\r\n}\r\n\r\nconst defaultTips = {\r\n  'Chief Complaint': [\r\n    'Consider duration and pattern of symptoms',\r\n    'Note any associated symptoms',\r\n    'Document severity and impact on daily life'\r\n  ],\r\n  'History of Present Illness': [\r\n    'Include timeline of symptom progression',\r\n    'Note previous treatments and responses',\r\n    'Document diagnostic tests already done'\r\n  ],\r\n  'Physical Examination': [\r\n    'Always document ECOG/PS score',\r\n    'Note lymph node regions systematically',\r\n    'Document any B symptoms',\r\n    'Consider paraneoplastic manifestations'\r\n  ],\r\n  'Performance Status': [\r\n    'Patients with ECOG â‰¥2 may need early palliative consult',\r\n    'Document any recent changes in performance',\r\n    'Consider impact on treatment choices'\r\n  ],\r\n  'Past Medical History': [\r\n    'Note any contraindications to therapy',\r\n    'Document previous malignancies',\r\n    'Include relevant surgeries and procedures'\r\n  ]\r\n};\r\n\r\nexport const AISidebar: React.FC<AISidebarProps> = ({ isOpen, onClose, currentSection }) => {\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <motion.div\r\n          initial={{ x: '100%', opacity: 0 }}\r\n          animate={{ x: 0, opacity: 1 }}\r\n          exit={{ x: '100%', opacity: 0 }}\r\n          transition={{ type: 'spring', damping: 20 }}\r\n          className=\"fixed right-0 top-0 h-screen w-80 bg-white/95 backdrop-blur-sm shadow-xl border-l border-gray-200 z-50\"\r\n        >\r\n          <div className=\"p-4 border-b border-gray-200 flex justify-between items-center\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Brain className=\"w-5 h-5 text-indigo-600\" />\r\n              <h3 className=\"font-semibold text-gray-900\">AI Assistant Tips</h3>\r\n            </div>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n            >\r\n              <X className=\"w-5 h-5 text-gray-500\" />\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"p-4 space-y-6 overflow-y-auto max-h-[calc(100vh-64px)]\">\r\n            {currentSection && defaultTips[currentSection as keyof typeof defaultTips] ? (\r\n              <div>\r\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2\">\r\n                  <Lightbulb className=\"w-4 h-4 text-yellow-500\" />\r\n                  Tips for: {currentSection}\r\n                </h4>\r\n                <ul className=\"space-y-2\">\r\n                  {defaultTips[currentSection as keyof typeof defaultTips].map((tip, index) => (\r\n                    <motion.li\r\n                      key={index}\r\n                      initial={{ opacity: 0, y: 10 }}\r\n                      animate={{ opacity: 1, y: 0 }}\r\n                      transition={{ delay: index * 0.1 }}\r\n                      className=\"p-3 bg-indigo-50 rounded-lg text-sm text-indigo-700\"\r\n                    >\r\n                      {tip}\r\n                    </motion.li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center text-gray-500 py-8\">\r\n                <Brain className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\r\n                <p>Select a section to see relevant AI tips</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};","import React from 'react';\r\nimport { CancerType } from '../../types/evaluation';\r\n\r\ninterface TNMStagingProps {\r\n  cancerType: CancerType;\r\n  value: {\r\n    t: string;\r\n    n: string;\r\n    m: string;\r\n  };\r\n  onChange: (value: { t: string; n: string; m: string }) => void;\r\n}\r\n\r\nconst TNMStaging: React.FC<TNMStagingProps> = ({ cancerType, value, onChange }) => {\r\n  const getTOptions = (cancerType: CancerType) => {\r\n    // Basic T staging options - can be expanded per cancer type\r\n    return ['X', 'is', '0', '1', '1a', '1b', '2', '2a', '2b', '3', '3a', '3b', '4', '4a', '4b'];\r\n  };\r\n\r\n  const getNOptions = () => ['X', '0', '1', '2', '3'];\r\n  const getMOptions = () => ['X', '0', '1', '1a', '1b'];\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"text-lg font-semibold text-gray-800\">TNM Staging</h3>\r\n      <div className=\"grid grid-cols-3 gap-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">T Stage</label>\r\n          <select\r\n            value={value.t}\r\n            onChange={(e) => onChange({ ...value, t: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          >\r\n            <option value=\"\">Select T Stage</option>\r\n            {getTOptions(cancerType).map((t) => (\r\n              <option key={t} value={t}>\r\n                T{t}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">N Stage</label>\r\n          <select\r\n            value={value.n}\r\n            onChange={(e) => onChange({ ...value, n: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          >\r\n            <option value=\"\">Select N Stage</option>\r\n            {getNOptions().map((n) => (\r\n              <option key={n} value={n}>\r\n                N{n}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">M Stage</label>\r\n          <select\r\n            value={value.m}\r\n            onChange={(e) => onChange({ ...value, m: e.target.value })}\r\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500\"\r\n          >\r\n            <option value=\"\">Select M Stage</option>\r\n            {getMOptions().map((m) => (\r\n              <option key={m} value={m}>\r\n                M{m}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TNMStaging;","import React from 'react';\r\nimport { AlertCircle } from 'lucide-react';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\n\r\ninterface ECOGSelectorProps {\r\n  value: number;\r\n  onChange: (value: number) => void;\r\n}\r\n\r\nconst ecogScores = [\r\n  {\r\n    score: 0,\r\n    description: 'Fully active, able to carry on all pre-disease performance without restriction'\r\n  },\r\n  {\r\n    score: 1,\r\n    description: 'Restricted in physically strenuous activity but ambulatory and able to carry out work of a light or sedentary nature'\r\n  },\r\n  {\r\n    score: 2,\r\n    description: 'Ambulatory and capable of all self-care but unable to carry out any work activities; up and about more than 50% of waking hours'\r\n  },\r\n  {\r\n    score: 3,\r\n    description: 'Capable of only limited self-care; confined to bed or chair more than 50% of waking hours'\r\n  },\r\n  {\r\n    score: 4,\r\n    description: 'Completely disabled; cannot carry on any self-care; totally confined to bed or chair'\r\n  },\r\n  {\r\n    score: 5,\r\n    description: 'Dead'\r\n  }\r\n];\r\n\r\nconst ECOGSelector: React.FC<ECOGSelectorProps> = ({ value, onChange }) => {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <h3 className=\"text-lg font-semibold text-gray-800\">ECOG Performance Status</h3>\r\n        <TooltipProvider>\r\n          <Tooltip>\r\n            <TooltipTrigger>\r\n              <AlertCircle className=\"w-4 h-4 text-blue-500\" />\r\n            </TooltipTrigger>\r\n            <TooltipContent>\r\n              <p className=\"max-w-xs text-sm\">\r\n                Eastern Cooperative Oncology Group (ECOG) performance status.\r\n                Used to assess disease progress and how it affects daily living abilities.\r\n              </p>\r\n            </TooltipContent>\r\n          </Tooltip>\r\n        </TooltipProvider>\r\n      </div>\r\n      \r\n      <div className=\"grid gap-4\">\r\n        {ecogScores.map(({ score, description }) => (\r\n          <div\r\n            key={score}\r\n            className={`p-4 rounded-lg border cursor-pointer transition-colors ${\r\n              value === score\r\n                ? 'border-indigo-500 bg-indigo-50'\r\n                : 'border-gray-200 hover:border-indigo-200'\r\n            }`}\r\n            onClick={() => onChange(score)}\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className={`w-8 h-8 rounded-full flex items-center justify-center font-semibold ${\r\n                value === score ? 'bg-indigo-500 text-white' : 'bg-gray-100 text-gray-700'\r\n              }`}>\r\n                {score}\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">{description}</p>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ECOGSelector;","import React from 'react';\r\nimport { AlertCircle } from 'lucide-react';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\n\r\ninterface KarnofskySliderProps {\r\n  value: number;\r\n  onChange: (value: number) => void;\r\n}\r\n\r\nconst getScoreDescription = (score: number): string => {\r\n  if (score >= 90) return 'Able to carry on normal activities; minor signs or symptoms of disease';\r\n  if (score >= 70) return 'Able to care for self but unable to carry on normal activities or work';\r\n  if (score >= 50) return 'Requires considerable assistance and frequent medical care';\r\n  if (score >= 30) return 'Severely disabled; hospitalization indicated though death not imminent';\r\n  return 'Very sick; hospital admission necessary; active supportive treatment necessary';\r\n};\r\n\r\nconst getScoreColor = (score: number): string => {\r\n  if (score >= 90) return 'bg-green-500';\r\n  if (score >= 70) return 'bg-blue-500';\r\n  if (score >= 50) return 'bg-yellow-500';\r\n  if (score >= 30) return 'bg-orange-500';\r\n  return 'bg-red-500';\r\n};\r\n\r\nconst KarnofskySlider: React.FC<KarnofskySliderProps> = ({ value, onChange }) => {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <h3 className=\"text-lg font-semibold text-gray-800\">Karnofsky Performance Status</h3>\r\n        <TooltipProvider>\r\n          <Tooltip>\r\n            <TooltipTrigger>\r\n              <AlertCircle className=\"w-4 h-4 text-blue-500\" />\r\n            </TooltipTrigger>\r\n            <TooltipContent>\r\n              <p className=\"max-w-xs text-sm\">\r\n                Karnofsky Performance Status (KPS) scale quantifies cancer patients' general well-being\r\n                and activities of daily life. Scores range from 0-100.\r\n              </p>\r\n            </TooltipContent>\r\n          </Tooltip>\r\n        </TooltipProvider>\r\n      </div>\r\n\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-2xl font-bold text-gray-700\">{value}%</span>\r\n          <span className=\"text-sm text-gray-500\">{getScoreDescription(value)}</span>\r\n        </div>\r\n\r\n        <div className=\"relative\">\r\n          <input\r\n            type=\"range\"\r\n            min={0}\r\n            max={100}\r\n            step={10}\r\n            value={value}\r\n            onChange={(e) => onChange(parseInt(e.target.value))}\r\n            className=\"w-full h-2 rounded-lg appearance-none cursor-pointer\"\r\n            style={{\r\n              background: `linear-gradient(to right, ${getScoreColor(value)} 0%, ${getScoreColor(value)} ${value}%, #e5e7eb ${value}%, #e5e7eb 100%)`\r\n            }}\r\n          />\r\n          <div className=\"flex justify-between text-xs text-gray-500 px-1 mt-2\">\r\n            <span>0</span>\r\n            <span>20</span>\r\n            <span>40</span>\r\n            <span>60</span>\r\n            <span>80</span>\r\n            <span>100</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-3 gap-2 text-xs\">\r\n          <div className=\"text-center\">\r\n            <div className=\"h-2 w-full bg-red-500 rounded mb-1\"></div>\r\n            <span className=\"text-gray-600\">Critical</span>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"h-2 w-full bg-yellow-500 rounded mb-1\"></div>\r\n            <span className=\"text-gray-600\">Moderate</span>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"h-2 w-full bg-green-500 rounded mb-1\"></div>\r\n            <span className=\"text-gray-600\">Good</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default KarnofskySlider;","import React, { useMemo, useEffect, useState, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { AlertTriangle, CheckCircle, AlertCircle, Save, Trash2, Printer, Brain } from 'lucide-react';\r\nimport { useToast } from '@/components/ui/use-toast';\r\nimport { EvaluationSummary } from '../components/EvaluationSummary';\r\nimport { CancerType } from '../types/evaluation';\r\nimport { evaluationTemplates } from '../data/evaluationTemplates';\r\nimport FormField from '../components/FormField';\r\nimport Button from '../components/Button';\r\nimport { useEvaluation } from '../context/EvaluationContext';\r\nimport { savePatientEvaluation } from '../../../services/patientEvaluationService';\r\nimport { ProgressStepper } from '../components/ProgressStepper';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { AISidebar } from '../components/AISidebar';\r\nimport type { EvaluationTemplate } from '../types/evaluation';\r\nimport { TNMStaging, ECOGSelector, KarnofskySlider } from '../components/staging';\r\nimport { TNMStage, PerformanceStatus } from '../types/evaluation';\r\n\r\nconst cancerTypes: { value: CancerType; label: string }[] = [\r\n  { value: 'breast', label: 'Breast Cancer' },\r\n  { value: 'lung', label: 'Lung Cancer' },\r\n  { value: 'colorectal', label: 'Colorectal Cancer' },\r\n  { value: 'prostate', label: 'Prostate Cancer' },\r\n  { value: 'lymphoma', label: 'Lymphoma' },\r\n  { value: 'ovarian', label: 'Ovarian Cancer' },\r\n  { value: 'gastric', label: 'Gastric Cancer' },\r\n  { value: 'head_neck', label: 'Head and Neck Cancer' }\r\n];\r\n\r\nconst AUTOSAVE_KEY = 'patient-evaluation-autosave';\r\nconst AUTOSAVE_INTERVAL = 30000; // 30 seconds\r\n\r\nconst PatientEvaluationForm: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { toast } = useToast();\r\n  const {\r\n    formData,\r\n    updateFormField,\r\n    clearFormData,\r\n    selectedCancerType,\r\n    setSelectedCancerType,\r\n    isFormSubmitting,\r\n    setIsFormSubmitting,\r\n    formError,\r\n    setFormError,\r\n    formSuccess,\r\n    setFormSuccess\r\n  } = useEvaluation();\r\n  const [isAISidebarOpen, setIsAISidebarOpen] = useState(false);\r\n  const [currentSection, setCurrentSection] = useState<string>();\r\n  const [tnmStage, setTnmStage] = useState<TNMStage>({ t: '', n: '', m: '' });\r\n  const [performanceStatus, setPerformanceStatus] = useState<PerformanceStatus>({\r\n    ecog: 0,\r\n    kps: 100\r\n  });\r\n\r\n  // Define currentTemplate first as getStepStatus depends on it.\r\n  const currentTemplate = useMemo(() => {\r\n    if (!selectedCancerType) return null;\r\n    return evaluationTemplates[selectedCancerType];\r\n  }, [selectedCancerType]);\r\n\r\n  // Function to determine step status\r\n  const getStepStatus = useCallback((sectionIndex: number) => {\r\n    if (!currentTemplate) return 'upcoming';\r\n    \r\n    const sectionFields = currentTemplate.sections[sectionIndex].items.map(\r\n      (_, itemIndex) => `section-${sectionIndex}-item-${itemIndex}`\r\n    );\r\n    \r\n    const isComplete = sectionFields.every(id => formData[id]?.trim());\r\n    const isCurrent = !isComplete && sectionFields.some(id => formData[id]?.trim());\r\n    \r\n    return isComplete ? 'complete' : isCurrent ? 'current' : 'upcoming';\r\n  }, [currentTemplate, formData]);\r\n\r\n  // Calculate form progress steps\r\n  const steps = useMemo(() => {\r\n    if (!currentTemplate) return [];\r\n    \r\n    return currentTemplate.sections.map((section, index) => ({\r\n      id: index + 1,\r\n      name: section.title,\r\n      description: section.cancerSpecificNotes?.[0] || '',\r\n      status: getStepStatus(index) as 'complete' | 'current' | 'upcoming'\r\n    }));\r\n  }, [currentTemplate, formData, getStepStatus]);\r\n\r\n  // Print functionality\r\n  const handlePrint = () => {\r\n    const printWindow = window.open('', '_blank');\r\n    if (!printWindow) return;\r\n\r\n    const styles = `\r\n      <style>\r\n        body { font-family: system-ui; line-height: 1.5; padding: 2rem; }\r\n        h1 { color: #4f46e5; margin-bottom: 1.5rem; }\r\n        .section { margin-bottom: 2rem; }\r\n        .field { margin-bottom: 1rem; }\r\n        .label { font-weight: 600; color: #374151; }\r\n        .value { margin-top: 0.25rem; }\r\n        .red-flag { color: #dc2626; padding: 0.5rem; background: #fee2e2; border-radius: 0.25rem; }\r\n        @media print {\r\n          body { padding: 0; }\r\n          .page-break { page-break-before: always; }\r\n        }\r\n      </style>\r\n    `;\r\n\r\n    let content = `\r\n      <h1>Patient Evaluation - ${selectedCancerType}</h1>\r\n      <div class=\"content\">\r\n    `;\r\n\r\n    if (currentTemplate) {\r\n      currentTemplate.sections.forEach((section, sIndex) => {\r\n        content += `<div class=\"section\">\r\n          <h2>${section.title}</h2>`;\r\n        \r\n        section.items.forEach((item, iIndex) => {\r\n          const fieldId = `section-${sIndex}-item-${iIndex}`;\r\n          const value = formData[fieldId] || 'Not provided';\r\n          \r\n          content += `\r\n            <div class=\"field\">\r\n              <div class=\"label\">${item.text}</div>\r\n              <div class=\"value\">${value}</div>\r\n              ${item.redFlags?.map(flag => \r\n                `<div class=\"red-flag\">âš ï¸ ${flag}</div>`\r\n              ).join('') || ''}\r\n            </div>\r\n          `;\r\n        });\r\n        \r\n        content += '</div>';\r\n      });\r\n    }\r\n\r\n    content += '</div>';\r\n\r\n    printWindow.document.write(`\r\n      <!DOCTYPE html>\r\n      <html>\r\n        <head>${styles}</head>\r\n        <body>${content}</body>\r\n      </html>\r\n    `);\r\n\r\n    printWindow.document.close();\r\n    printWindow.print();\r\n  };\r\n\r\n  // Load saved form data on mount\r\n  useEffect(() => {\r\n    const savedData = localStorage.getItem(AUTOSAVE_KEY);\r\n    if (savedData) {\r\n      try {\r\n        const { cancerType, data } = JSON.parse(savedData);\r\n        setSelectedCancerType(cancerType);\r\n        Object.entries(data).forEach(([id, value]) => {\r\n          updateFormField(id, value as string);\r\n        });\r\n        toast({\r\n          title: 'Form Data Restored',\r\n          description: 'Your previous progress has been loaded.',\r\n          duration: 3000\r\n        });\r\n      } catch (error) {\r\n        console.error('Error loading saved form data:', error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Autosave form data periodically\r\n  useEffect(() => {\r\n    if (!selectedCancerType || Object.keys(formData).length === 0) return;\r\n    \r\n    const autosaveData = () => {\r\n      localStorage.setItem(AUTOSAVE_KEY, JSON.stringify({\r\n        cancerType: selectedCancerType,\r\n        data: formData,\r\n        timestamp: new Date().toISOString()\r\n      }));\r\n    };\r\n\r\n    const intervalId = setInterval(autosaveData, AUTOSAVE_INTERVAL);\r\n    return () => clearInterval(intervalId);\r\n  }, [selectedCancerType, formData]);\r\n\r\n  // Clear autosaved data after successful submission\r\n  const clearAutosavedData = () => {\r\n    localStorage.removeItem(AUTOSAVE_KEY);\r\n  };\r\n\r\n  const missingRequired = useMemo(() => {\r\n    if (!currentTemplate) return [];\r\n    \r\n    return currentTemplate.sections\r\n      .flatMap((section, sIndex) => \r\n        section.items\r\n          .map((item, iIndex) => ({\r\n            item,\r\n            id: `section-${sIndex}-item-${iIndex}`,\r\n          }))\r\n      )\r\n      .filter(({ item, id }) => \r\n        item.required && (!formData[id] || formData[id].trim() === '')\r\n      );\r\n  }, [currentTemplate, formData]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Reset states\r\n    setFormError(null);\r\n    setFormSuccess(false);\r\n    \r\n    // Validate selected cancer type\r\n    if (!selectedCancerType) {\r\n      setFormError('Please select a cancer type.');\r\n      toast({\r\n        variant: 'destructive',\r\n        title: 'Validation Error',\r\n        description: 'Please select a cancer type to proceed.'\r\n      });\r\n      return;\r\n    }\r\n    \r\n    // Validate required fields\r\n    if (missingRequired.length > 0) {\r\n      const errorMessage = `Please complete all required fields (${missingRequired.length} missing).`;\r\n      setFormError(errorMessage);\r\n      toast({\r\n        variant: 'destructive',\r\n        title: 'Missing Required Fields',\r\n        description: errorMessage\r\n      });\r\n      \r\n      // Scroll to first missing field\r\n      const firstMissingId = missingRequired[0].id;\r\n      const element = document.getElementById(firstMissingId);\r\n      if (element) {\r\n        element.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n        element.focus();\r\n      }\r\n      return;\r\n    }\r\n    \r\n    // Proceed with submission\r\n    try {\r\n      setIsFormSubmitting(true);\r\n      \r\n      await savePatientEvaluation({\r\n        cancerType: selectedCancerType,\r\n        formData,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n      \r\n      // Clear autosaved data after successful submission\r\n      clearAutosavedData();\r\n      \r\n      setFormSuccess(true);\r\n      toast({\r\n        title: 'Success',\r\n        description: 'Patient evaluation saved successfully.',\r\n        duration: 3000\r\n      });\r\n      \r\n      // Navigate after showing success message\r\n      setTimeout(() => {\r\n        navigate('/opd');\r\n      }, 1000);\r\n      \r\n    } catch (error) {\r\n      console.error('Form submission error:', error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to save evaluation. Please try again.';\r\n      setFormError(errorMessage);\r\n      toast({\r\n        variant: 'destructive',\r\n        title: 'Save Error',\r\n        description: errorMessage,\r\n        duration: 5000\r\n      });\r\n    } finally {\r\n      setIsFormSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Modified clearFormData handler to also clear autosaved data\r\n  const handleClearForm = () => {\r\n    if (window.confirm('Are you sure you want to clear all form data? This cannot be undone.')) {\r\n      clearFormData();\r\n      clearAutosavedData();\r\n      toast({\r\n        title: 'Form Cleared',\r\n        description: 'All form data has been cleared.',\r\n        duration: 3000\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-8\">\r\n      {/* AI Assistant Button */}\r\n      <div className=\"fixed right-4 top-4 z-50\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setIsAISidebarOpen(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition-colors\"\r\n        >\r\n          <Brain className=\"w-5 h-5\" />\r\n          <span>AI Assistant</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* AI Sidebar */}\r\n      <AISidebar\r\n        isOpen={isAISidebarOpen}\r\n        onClose={() => setIsAISidebarOpen(false)}\r\n        currentSection={currentSection}\r\n      />\r\n\r\n      {/* Progress Stepper */}\r\n      {currentTemplate && (\r\n        <ProgressStepper\r\n          steps={steps}\r\n          currentStep={steps.findIndex(step => step.status === 'current')}\r\n        />\r\n      )}\r\n\r\n      {/* Cancer Type Selector */}\r\n      <div className=\"bg-white p-6 rounded-lg border border-gray-200 shadow-sm\">\r\n        <label \r\n          htmlFor=\"cancer-type-select\" \r\n          className=\"block text-lg font-semibold text-gray-900 mb-4\"\r\n        >\r\n          Select Cancer Type\r\n        </label>\r\n        <select\r\n          id=\"cancer-type-select\"\r\n          aria-label=\"Cancer Type\"\r\n          value={selectedCancerType || ''}\r\n          onChange={(e) => setSelectedCancerType(e.target.value as CancerType)}\r\n          className=\"w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500\"\r\n        >\r\n          <option value=\"\">Select cancer type...</option>\r\n          {cancerTypes.map(type => (\r\n            <option key={type.value} value={type.value}>\r\n              {type.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {currentTemplate && (\r\n        <>\r\n          <h2 className=\"text-xl font-bold text-gray-800\">ðŸ©º Oncologist's Comprehensive OPD Evaluation</h2>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Use this structured form to guide your clinical judgment and capture essential information during patient evaluation in oncology OPD.\r\n          </p>\r\n\r\n          {/* Notes and Guidance */}\r\n          <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\r\n            <h3 className=\"text-blue-800 font-semibold flex items-center gap-2 mb-2\">\r\n              <CheckCircle className=\"w-5 h-5\" />\r\n              Clinical Guidance\r\n            </h3>\r\n            <ul className=\"list-disc list-inside space-y-1 text-blue-700\">\r\n              {currentTemplate.notes.map((note, index) => (\r\n                <li key={index}>{note}</li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n\r\n          {/* Red Flags Alert */}\r\n          <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\r\n            <h3 className=\"text-red-800 font-semibold flex items-center gap-2 mb-2\">\r\n              <AlertTriangle className=\"w-5 h-5\" />\r\n              Red Flags to Monitor\r\n            </h3>\r\n            <ul className=\"list-disc list-inside space-y-1 text-red-700\">\r\n              {currentTemplate.redFlags.map((flag, index) => (\r\n                <li key={index}>{flag}</li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n\r\n          {/* Staging Section */}\r\n          <div className=\"bg-white p-6 rounded-lg border border-gray-200 shadow-sm space-y-6\">\r\n            <div className=\"border-b border-gray-200 pb-4\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Disease Staging & Performance Status</h3>\r\n              <p className=\"mt-2 text-sm text-gray-600\">\r\n                Document current disease stage and patient's functional status\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n              <TNMStaging\r\n                cancerType={selectedCancerType as CancerType}\r\n                value={tnmStage}\r\n                onChange={setTnmStage}\r\n              />\r\n              <div className=\"space-y-6\">\r\n                <ECOGSelector\r\n                  value={performanceStatus.ecog}\r\n                  onChange={(value) => setPerformanceStatus(prev => ({ ...prev, ecog: value }))}\r\n                />\r\n                <KarnofskySlider\r\n                  value={performanceStatus.kps}\r\n                  onChange={(value) => setPerformanceStatus(prev => ({ ...prev, kps: value }))}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Evaluation Sections */}\r\n          {currentTemplate.sections.map((section, sectionIndex) => (\r\n            <div key={sectionIndex} className=\"bg-white p-6 rounded-lg border border-gray-200 shadow-sm space-y-6\">\r\n              <div className=\"border-b border-gray-200 pb-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">{section.title}</h3>\r\n                {section.cancerSpecificNotes && (\r\n                  <div className=\"mt-2 text-sm text-gray-600\">\r\n                    {section.cancerSpecificNotes.map((note, index) => (\r\n                      <div key={index} className=\"flex items-center gap-2\">\r\n                        <AlertCircle className=\"w-4 h-4 text-blue-500\" />\r\n                        {note}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                {section.items.map((item, itemIndex) => {\r\n                  const fieldId = `section-${sectionIndex}-item-${itemIndex}`;\r\n                  const isRequired = !!item.required;\r\n                  const isError = missingRequired.some(m => m.id === fieldId);\r\n                  const hasRedFlags = item.redFlags && item.redFlags.length > 0;\r\n                  \r\n                  return (\r\n                    <div key={itemIndex} className=\"relative\">\r\n                      <FormField\r\n                        id={fieldId}\r\n                        label={item.text}\r\n                        required={isRequired}\r\n                        value={formData[fieldId] || ''}\r\n                        onChange={(value) => updateFormField(fieldId, value)}\r\n                        error={isError}\r\n                        redFlags={item.redFlags || []}\r\n                        inputClassName={hasRedFlags ? 'border-red-200 focus:ring-red-500 focus:border-red-500' : ''}\r\n                      />\r\n                      {hasRedFlags && (\r\n                        <TooltipProvider>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <div className=\"absolute right-3 top-3\">\r\n                                <AlertTriangle className=\"w-5 h-5 text-red-500\" />\r\n                              </div>\r\n                            </TooltipTrigger>\r\n                            <TooltipContent className=\"bg-red-50 border border-red-200 p-3 max-w-xs\">\r\n                              <div className=\"font-medium mb-1 text-red-800\">Clinical Red Flags:</div>\r\n                              <ul className=\"list-disc pl-4 text-sm text-red-700\">\r\n                                {item.redFlags?.map((flag, idx) => (\r\n                                  <li key={idx}>{flag}</li>\r\n                                ))}\r\n                              </ul>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </TooltipProvider>\r\n                      )}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          <div className=\"mt-6\">\r\n            <EvaluationSummary \r\n              template={currentTemplate as EvaluationTemplate}\r\n              formData={formData}\r\n            />\r\n          </div>\r\n\r\n          {/* Error message */}\r\n          {formError && (\r\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded-md text-red-700 flex items-center gap-2\">\r\n              <AlertTriangle className=\"w-5 h-5\" />\r\n              {formError}\r\n            </div>\r\n          )}\r\n          \r\n          {/* Success message */}\r\n          {formSuccess && (\r\n            <div className=\"p-3 bg-green-50 border border-green-200 rounded-md text-green-700 flex items-center gap-2\">\r\n              <CheckCircle className=\"w-5 h-5\" />\r\n              Evaluation saved successfully! Redirecting...\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-end gap-4 sticky bottom-0 bg-white p-4 border-t mt-6\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"secondary\"\r\n              onClick={handlePrint}\r\n              icon={<Printer className=\"w-4 h-4\" />}\r\n            >\r\n              Print Summary\r\n            </Button>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"secondary\"\r\n              onClick={handleClearForm}\r\n              disabled={isFormSubmitting}\r\n              icon={<Trash2 className=\"w-4 h-4\" />}\r\n            >\r\n              Clear Form\r\n            </Button>\r\n            <Button\r\n              type=\"submit\"\r\n              variant=\"primary\"\r\n              isLoading={isFormSubmitting}\r\n              icon={!isFormSubmitting ? <Save className=\"w-4 h-4\" /> : undefined}\r\n            >\r\n              {isFormSubmitting ? 'Saving...' : 'Save Evaluation'}\r\n            </Button>\r\n          </div>\r\n        </>\r\n      )}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport { PatientEvaluationForm };\r\n","import React from 'react';\r\nimport { Routes, Route } from 'react-router-dom';\r\nimport { Toaster } from '@/components/ui/toaster';\r\nimport OPDModule from './components/OPDModule';\r\nimport OPDLayout from './layout/OPDLayout';\r\nimport ErrorBoundary from '@/components/ErrorBoundary';\r\nimport { PatientEvaluationForm } from './patient-evaluation/PatientEvaluationForm';\r\nimport DiagnosticPathways from './diagnostic-pathways/DiagnosticPathways';\r\nimport CancerScreening from './cancer-screening/CancerScreening';\r\nimport ReferralGuidelines from './referral-guidelines/ReferralGuidelines';\r\nimport FollowUpOncology from './follow-up-oncology/FollowUpOncology';\r\nimport { EvaluationProvider } from './context/EvaluationContext';\r\n\r\nconst OPD = () => {\r\n  return (\r\n    <ErrorBoundary moduleName=\"Oncology OPD\">\r\n      <EvaluationProvider>\r\n        <OPDLayout>\r\n          <Routes>\r\n            <Route path=\"/\" element={<OPDModule />} />\r\n            <Route path=\"/patient-evaluation-form\" element={<PatientEvaluationForm />} />\r\n            <Route path=\"/diagnostic-pathways\" element={<DiagnosticPathways />} />\r\n            <Route path=\"/cancer-screening\" element={<CancerScreening />} />\r\n            <Route path=\"/referral-guidelines\" element={<ReferralGuidelines />} />\r\n            <Route path=\"/follow-up-oncology\" element={<FollowUpOncology />} />\r\n          </Routes>\r\n          <Toaster />\r\n        </OPDLayout>\r\n      </EvaluationProvider>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport default OPD;\r\n"],"names":["TooltipProvider","TooltipPrimitive","Tooltip","TooltipTrigger","TooltipContent","React","forwardRef","className","sideOffset","props","ref","_jsx","cn","displayName","ToastProvider","ToastPrimitives","ToastViewport","toastVariants","cva","variants","variant","default","destructive","defaultVariants","Toast","ToastAction","ToastClose","children","X","ToastTitle","ToastDescription","Toaster","toasts","useToast","_jsxs","map","id","title","description","action","EvaluationCard","PathwayCard","ScreeningCard","ReferralCard","FollowUpCard","AISummary","patientData","isEnabled","process","summaryState","setSummaryState","useState","summary","setSummary","error","setError","useEffect","Promise","resolve","setTimeout","mockSummary","generateMockSummary","err","data","fill","stroke","viewBox","xmlns","strokeLinecap","strokeLinejoin","strokeWidth","d","Loader2","Check","AlertCircle","onClick","PatientEvaluation","navigate","useNavigate","breastCancerPathway","prostateCancerPathway","lungCancerPathway","ovarianCancerPathway","gastricCancerPathway","headNeckCancerPathway","pancreaticCancerPathway","bladderCancerPathway","pathways","RedFlagAlert","redFlag","onDismiss","severity","message","condition","recommendations","AlertTriangle","fillRule","clipRule","length","rec","index","PathwaySummaryCard","onRedFlagDismiss","totalSteps","completedSteps","activeRedFlags","estimatedTimeRemaining","nextRequiredActions","progress","Math","round","criticalFlags","filter","flag","warningFlags","style","width","Clock","undefined","CheckCircle","console","log","DecisionTree","pathway","currentStepId","setCurrentStepId","setProgress","currentStep","redFlagsTriggered","timeStarted","Date","now","steps","find","step","calculateSummary","some","flagId","redFlags","flatMap","includes","recommendedTimeframe","handleOptionSelect","nextId","triggers","prev","dismissRedFlag","tooltip","Info","expectedDuration","options","option","next","text","DiagnosticPathways","selectedCancer","setSelectedCancer","cancerIcons","breast","prostate","Activity","lung","ovarian","Dna","gastric","head_neck","Stethoscope","pancreatic","Heart","bladder","Waves","colorectal","CircleDot","lymphoma","Brain","Object","entries","type","name","Book","MODEL_NAME","MAX_RETRIES","RETRY_DELAY","safetySettings","HarmCategory","HarmBlockThreshold","GeminiError","code","statusCode","__publicField","validateApiKey","API_KEY","_b","_a","_c","delay","ms","retryWithBackoff","fn","retries","validateJsonSafety","generateGeminiResponse","prompt","context","history","apiKey","model","GoogleGenerativeAI","messages","validation","uuidv4","mockResponses","OpenAI","getMockResponse","module","intent","moduleResponses","intentResponses","randomIndex","callAIAgent","mockMode","iterationCount","previousResponse","feedbackType","enhancedPrompt","base","fullPrompt","response","APIError","CancerScreening","setMockMode","setPatientData","age","gender","smokingHistory","packYears","isHighRisk","riskFactors","priorCancer","immunocompromised","radiationExposure","geneticRisk","brcaPositive","lynchSyndrome","familyHistory","lastScreening","mammogram","colonoscopy","papSmear","ldct","psa","breastMri","endoscopy","ctAbdomen","activeSymptoms","weightLoss","abdominalPain","backPain","jaundice","bloating","earlySatiety","hoarseness","dysphagia","earPain","vomiting","bleeding","fever","nightSweats","expandedPanels","setExpandedPanels","cervical","loading","setLoading","handleCheckboxChange","e","target","checked","isValidDate","date","getYearsSince","getFullYear","Infinity","getSymptomBasedCancers","symptoms","concerns","push","calculateRecommendations","results","cancerType","status","reason","lastColonoscopy","yearsSinceColonoscopy","isOverdue","nextDue","concernedCancers","forEach","lastMammogram","lastPap","lastPSA","lastLDCT","generateSummary","content","Error","showToast","duration","toast","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","handleAIConsult","recommendation","toLowerCase","_","value","cancer","join","exportRecommendations","getStatusColor","Download","size","onChange","parseInt","placeholder","keys","symptom","isActive","replace","screening","trim","toUpperCase","ChevronUp","ChevronDown","toLocaleDateString","disabled","MessageSquare","guideline","urgency","criteria","criterion","workup","item","ReferralForm","formData","setFormData","htmlFor","rows","clinicalFindings","TriageResult","aiTriageResult","urgencyStyles","Urgent","Soon","Routine","Icon","timeframe","reasoning","referralTemplates","calculateRiskScore","input","score","factor","determineTriageResult","slaTimeframes","riskScore","ReferralGuidelines","selectedCancerType","setSelectedCancerType","setAiTriageResult","redFlagAlerts","setRedFlagAlerts","isLoadingAI","setIsLoadingAI","cancerTypes","useMemo","Set","t","selectedTemplate","handleTriage","highRiskFactors","aiTriageFactors","moderateRiskFactors","urgent","routine","localResult","triggeredFlags","combinedInput","trigger","every","getAIInsights","pathwayName","aiResponse","motion","div","initial","opacity","y","animate","FileText","_Fragment","alert","urgencyLevel","requiredInformation","clinical","f","label","icon","CancerSelector","onSelect","selected","button","whileHover","scale","whileTap","eventIcons","first_visit","Calendar","imaging","Image","biopsy","TestTube","histopathology","Microscope","molecular","final","CheckCircle2","eventLabels","DiagnosticTimeline","events","event","x","transition","detail","ChartJS","register","CategoryScale","LinearScale","PointElement","LineElement","Title","Legend","PerformanceScoreChart","chartData","labels","datasets","ecog","borderColor","backgroundColor","yAxisID","kps","responsive","interaction","mode","intersect","scales","display","position","min","max","grid","color","y1","drawOnChartArea","plugins","legend","Line","SmartFollowUpSummary","stage","tnmStage","diagnosisDate","currentECOG","currentKPS","onGenerate","followUpPlan","isGenerating","setIsGenerating","handleGenerateSummary","generatedSummary","handleExport","element","document","createElement","file","Blob","href","URL","createObjectURL","download","toISOString","split","body","appendChild","click","removeChild","n","m","dangerouslySetInnerHTML","__html","mockDiagnosticEvents","mockPerformanceData","cancerTemplates","validateTemplate","template","errors","warnings","section","intervals","s","formatFrequency","frequency","generateFollowUpPlan","isValid","stageKey","stageGuidelines","guidelines","interval","actions","a","g","i","AIAssistantError","details","request","lastError","attempt","errorData","AIFollowUpAssistant","plan","onInsightsReady","insights","setInsights","analyzePlan","timeline","surveillance","investigations","examinations","urgentFlags","qolTopics","topic","commonSymptoms","blob","url","revokeObjectURL","Button","hasData","getMockData","FollowUpOncology","setStage","setIntent","isLoading","setIsLoading","setFollowUpPlan","aiInsights","setAIInsights","ErrorBoundary","Card","CardHeader","CardTitle","asChild","CardContent","tabs","UserCheck","component","card","ScanLine","ShieldCheck","Send","CalendarClock","OPDModule","mockPatientData","chiefComplaint","Tab","Group","List","Panels","Component","Panel","OPDLayout","EvaluationSummary","missingRequired","sections","sIndex","items","iIndex","required","hasAllRequired","evaluationTemplates","FormField","inputClassName","ariaAttributes","fullWidth","baseClasses","sizeClasses","sm","md","lg","variantClasses","primary","secondary","outline","danger","stateClasses","widthClasses","buttonClasses","EvaluationContext","createContext","useEvaluation","useContext","EvaluationProvider","isFormSubmitting","setIsFormSubmitting","formError","setFormError","formSuccess","setFormSuccess","updateFormField","useCallback","clearFormData","window","confirm","Provider","savePatientEvaluation","supabase","ProgressStepper","stepIdx","defaultTips","AISidebar","isOpen","onClose","currentSection","AnimatePresence","exit","damping","Lightbulb","tip","li","TNMStaging","getTOptions","getNOptions","getMOptions","ecogScores","ECOGSelector","getScoreDescription","getScoreColor","KarnofskySlider","background","AUTOSAVE_KEY","AUTOSAVE_INTERVAL","PatientEvaluationForm","isAISidebarOpen","setIsAISidebarOpen","setCurrentSection","setTnmStage","performanceStatus","setPerformanceStatus","currentTemplate","getStepStatus","sectionIndex","sectionFields","itemIndex","isComplete","isCurrent","cancerSpecificNotes","handlePrint","printWindow","open","styles","fieldId","write","close","print","savedData","localStorage","getItem","JSON","parse","intervalId","setInterval","autosaveData","setItem","stringify","timestamp","clearInterval","clearAutosavedData","removeItem","handleSubmit","preventDefault","errorMessage","firstMissingId","getElementById","scrollIntoView","behavior","block","focus","handleClearForm","onSubmit","findIndex","notes","note","isRequired","isError","hasRedFlags","idx","Printer","Trash2","Save","OPD","moduleName","Routes","Route","path"],"mappings":"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"}