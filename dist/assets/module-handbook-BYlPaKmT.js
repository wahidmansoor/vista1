import{j as e,L as K,r as v,R as q,M as z,a as W,u as G}from"./react-vendor-B1d8dduC.js";import{c as k,E as Y}from"./module-cdu-BUS-kbPn.js";import{an as T,ao as D,Y as B,q as Q,r as L,u as F,ap as X,aq as Z,y as H,a7 as ee,ar as R,I as te,as as re,at as se,z as M}from"./vendor-COw5p1kA.js";function ae({children:t,componentName:a}){try{return e.jsx(e.Fragment,{children:t})}catch(l){return console.error(`Error in ${a||"component"}:`,l),e.jsxs("div",{className:"p-4 bg-red-50 text-red-600 border border-red-200 rounded mt-4",children:["⚠️ Failed to load ",a||"component","."]})}}const ne=[{id:"medical-oncology",title:"Medical Oncology",description:"Clinical oncology chapters, diagnosis, treatment, supportive care, emergencies, and reference tools.",icon:T,isImage:!1,path:"/handbook/medical-oncology"},{id:"radiation-oncology",title:"Radiation Oncology",description:"Detailed protocols for radiation therapy, treatment planning, dosimetry, and management of radiation-related effects.",icon:D,isImage:!1,path:"/handbook/radiation-oncology"},{id:"palliative-care",title:"Palliative Care",description:"Guidelines for symptom management, pain control, and improving quality of life for patients with advanced cancer.",icon:B,isImage:!1,path:"/handbook/palliative-care"}],ie=()=>e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:to-slate-800",children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-blue-500",children:"OncoVista Handbook"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-12 text-lg max-w-2xl",children:"Select a section to explore detailed oncology guidelines and protocols"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:ne.map(t=>e.jsxs(K,{to:t.path,className:"group block p-6 bg-white dark:bg-slate-800 rounded-xl\r shadow-sm hover:shadow-md transition-all duration-300\r border border-gray-100 dark:border-gray-700\r hover:border-purple-100 dark:hover:border-purple-900/50\r relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-50/50 to-blue-50/50 \r dark:from-purple-900/10 dark:to-blue-900/10\r opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"mb-4 p-3 rounded-lg inline-block \r bg-gradient-to-br from-purple-100 to-blue-100\r dark:from-purple-900/50 dark:to-blue-900/50",children:e.jsx(t.icon,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsx("h2",{className:"text-xl font-semibold mb-3 text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:t.description})]})]},t.id))}),e.jsxs("div",{className:"mt-16 grid md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"p-3 rounded-lg inline-block bg-blue-100 dark:bg-blue-900/30 mb-4",children:e.jsx(T,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Comprehensive Content"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Evidence-based guidelines and protocols for oncology practice"})]}),e.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"p-3 rounded-lg inline-block bg-purple-100 dark:bg-purple-900/30 mb-4",children:e.jsx(D,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Treatment Planning"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Detailed guidance for radiation therapy and palliative care"})]}),e.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"p-3 rounded-lg inline-block bg-rose-100 dark:bg-rose-900/30 mb-4",children:e.jsx(B,{className:"w-5 h-5 text-rose-600 dark:text-rose-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Patient-Centered Care"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Focus on quality of life and holistic patient management"})]})]})]})}),oe=({entry:t,depth:a,isExpanded:l,isActive:h,section:r,activeTopicId:n,onToggle:g,onSelect:u})=>{var m,s,o,w;const d=t.items&&t.items.length>0,c=t.path&&n===t.path,p=d&&((m=t.items)==null?void 0:m.some(f=>{var S;return f.path===n||((S=f.items)==null?void 0:S.some(x=>x.path===n))}));return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>d?g():t.path&&u(t.path),className:k("w-full text-left group flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-200","hover:bg-slate-100 dark:hover:bg-slate-800",(c||p)&&"bg-gradient-to-r from-purple-100 to-indigo-100 dark:from-purple-900/30 dark:to-indigo-900/30",a>0&&"ml-4"),children:[d&&e.jsx(F.div,{initial:!1,animate:{rotate:l?90:0},transition:{duration:.2},className:k("text-slate-400",p&&"text-indigo-500 dark:text-indigo-400"),children:e.jsx(X,{size:16})}),e.jsx("span",{className:k("flex-1 text-sm transition-colors",d?"font-semibold":"font-normal",c||p?"text-indigo-700 dark:text-indigo-300":"text-slate-700 dark:text-slate-300","group-hover:text-indigo-600 dark:group-hover:text-indigo-400"),children:t.title}),((s=t.path)==null?void 0:s.includes("new"))&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded-full",children:"New"}),((o=t.path)==null?void 0:o.includes("updated"))&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 rounded-full",children:"Updated"})]}),d&&e.jsx(Z,{initial:!1,children:l&&e.jsx(F.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsx("div",{className:"relative pl-4 before:absolute before:left-2 before:top-0 before:h-full before:w-px before:bg-slate-200 dark:before:bg-slate-700",children:(w=t.items)==null?void 0:w.map((f,S)=>e.jsx(U,{entry:f,depth:a+1,section:r,activeTopicId:n,onSelect:u},`${f.title}-${S}`))})})})]})},U=({entry:t,depth:a,section:l,activeTopicId:h,onSelect:r})=>{const[n,g]=v.useState(()=>h?t.items?t.items.some(d=>{var c;return d.path===h||((c=d.items)==null?void 0:c.some(p=>p.path===h))}):!1:a===0);t.items&&t.items.length>0;const u=t.path===h;return e.jsx(oe,{entry:t,depth:a,isExpanded:n,isActive:u,section:l,activeTopicId:h,onToggle:()=>g(!n),onSelect:r})},le=({section:t,tocData:a,activeTopicId:l,onTopicClick:h})=>{const[r,n]=v.useState(""),g=v.useCallback(d=>{t&&d&&h(t,d)},[t,h]),u=v.useMemo(()=>{if(!r)return a;const d=r.toLowerCase(),c=p=>p.reduce((m,s)=>{if(s.title.toLowerCase().includes(d))m.push(s);else if(s.items){const o=c(s.items);o.length>0&&m.push({...s,items:o})}return m},[]);return c(a)},[a,r]);return e.jsxs("div",{className:"w-80 flex-shrink-0 border-r border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"sticky top-0 z-10 p-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search topics...",value:r,onChange:d=>n(d.target.value),className:"w-full pl-9 pr-4 py-2 text-sm rounded-lg border border-slate-200 dark:border-slate-700 \r bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100\r placeholder:text-slate-400 dark:placeholder:text-slate-500\r focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400\r transition-all duration-200"})]})}),e.jsx("div",{className:"h-[calc(100vh-4rem)] p-4 space-y-2 overflow-y-auto \r scrollbar-thin scrollbar-track-transparent\r scrollbar-thumb-slate-200 hover:scrollbar-thumb-slate-300\r dark:scrollbar-thumb-slate-700 dark:hover:scrollbar-thumb-slate-600\r scroll-smooth",children:u.length===0?e.jsxs("div",{className:"flex items-center gap-2 p-4 text-sm text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(L,{size:16}),e.jsx("span",{children:"No matching topics found"})]}):u.map((d,c)=>e.jsx(U,{entry:d,depth:0,section:t,activeTopicId:l,onSelect:g},`${d.title}-${c}`))})]})},de=t=>e.jsx("div",{...t,className:k("h-px bg-gray-200 dark:bg-gray-700",t.className)}),ce=t=>e.jsx("table",{...t,className:k("min-w-full border-collapse border border-gray-200 dark:border-gray-700",t.className)}),me=t=>e.jsx("thead",{...t,className:k("bg-gray-50 dark:bg-gray-800",t.className)}),I=t=>e.jsx("tr",{...t,className:k("border-b border-gray-200 dark:border-gray-700",t.className)}),ge=t=>e.jsx("th",{...t,className:k("px-4 py-3 text-left font-medium text-gray-700 dark:text-gray-300",t.className)}),he=t=>e.jsx("tbody",{...t,className:k("divide-y divide-gray-200 dark:divide-gray-700",t.className)}),pe=t=>e.jsx("td",{...t,className:k("px-4 py-3 text-gray-800 dark:text-gray-200",t.className)}),ue=({language:t,value:a,showLineNumbers:l})=>e.jsx("pre",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-md text-sm overflow-auto border border-gray-200 dark:border-gray-700",children:e.jsx("code",{className:k("block whitespace-pre",t?`language-${t}`:""),children:a})}),N=t=>t?e.jsx("div",{className:"prose-sm max-w-none dark:prose-invert",children:e.jsx(z,{remarkPlugins:[se],rehypePlugins:[re],children:t})}):null,j=(t,a,l="content")=>t.id?`${l}-${t.id}-${a}`:`${l}-${a}`,xe=t=>typeof t.content=="string"?t.content:typeof t.text=="string"?t.text:"",O=(t,a,l=!1,h=0)=>{const r=l?"ol":"ul",n=k("space-y-1 my-1",l?"list-decimal":"list-disc",h===0?"pl-6":"pl-4");return e.jsx(r,{className:n,children:t.map((g,u)=>{const d=`${a}-item-${u}`;return typeof g=="string"?e.jsx("li",{className:"pl-1",children:N(g)},d):g&&typeof g=="object"?"text"in g&&"sublist"in g&&Array.isArray(g.sublist)?e.jsxs("li",{className:"pl-1",children:[N(g.text),O(g.sublist,`${d}-sublist`,!1,h+1)]},d):e.jsx("li",{className:"pl-1",children:JSON.stringify(g)},d):e.jsx("li",{className:"pl-1",children:String(g)},d)})})};function fe({content:t,className:a}){const l=(r,n)=>n===0||r.type!=="heading"?!1:r.level&&r.level<=2;if(!t||!Array.isArray(t)||t.length===0)return e.jsx("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200 text-yellow-700 dark:bg-yellow-900/20 dark:border-yellow-800 dark:text-yellow-300",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(H,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsx("p",{children:"No content blocks available to render."})]})});return e.jsx("div",{className:k("handbook-content space-y-4",a),children:t.map((r,n)=>l(r,n)?e.jsxs(q.Fragment,{children:[e.jsx(de,{className:"my-6"}),h(r,n)]},j(r,n)):h(r,n))});function h(r,n){const g=xe(r);switch(r.type){case"heading":{const u=r.level||2,d=Math.min(Math.max(u,1),6),c=`h${d}`,p={1:"text-3xl font-bold tracking-tight mb-4",2:"text-2xl font-semibold tracking-tight mt-8 mb-4",3:"text-xl font-semibold tracking-tight mt-6 mb-3",4:"text-lg font-semibold tracking-tight mt-4 mb-2",5:"text-base font-medium tracking-tight mt-4 mb-2",6:"text-sm font-medium tracking-tight mt-4 mb-2"}[d]||"text-lg font-semibold tracking-tight mt-4 mb-2";return e.jsx(c,{id:r.id||`heading-${n}`,className:p,children:N(g)},j(r,n))}case"paragraph":return e.jsx("div",{className:"text-base leading-7 mb-4 text-gray-800 dark:text-gray-200",children:N(g)},j(r,n));case"list":case"bullets":return!r.items||!Array.isArray(r.items)||r.items.length===0?null:e.jsx("div",{className:"my-4",children:O(r.items,j(r,n),!1)},j(r,n));case"numbers":return!r.items||!Array.isArray(r.items)||r.items.length===0?null:e.jsx("div",{className:"my-4",children:O(r.items,j(r,n),!0)},j(r,n));case"definitions":return!r.items||!Array.isArray(r.items)||r.items.length===0?null:e.jsx("dl",{className:"space-y-4 text-base leading-7 my-4",children:r.items.map((u,d)=>{const c=`${j(r,n)}-def-${d}`;if(typeof u=="string"){const p=u.split(/:\s*(.+)/),m=p[0],s=p.length>=2?p[1]:"";return e.jsxs("div",{className:"mt-2",children:[e.jsx("dt",{className:"font-semibold text-gray-900 dark:text-gray-100",children:N(m)}),e.jsx("dd",{className:"mt-1 pl-4 text-gray-700 dark:text-gray-300",children:N(s)})]},c)}if(u&&typeof u=="object"){const p=u;if("term"in p){const s=String(p.term||"");if("definition"in p){const o=String(p.definition||"");return e.jsxs("div",{className:"mt-2",children:[e.jsx("dt",{className:"font-semibold text-gray-900 dark:text-gray-100",children:N(s)}),e.jsx("dd",{className:"mt-1 pl-4 text-gray-700 dark:text-gray-300",children:N(o)})]},c)}if("sublist"in p&&Array.isArray(p.sublist))return e.jsxs("div",{className:"mt-2",children:[e.jsx("dt",{className:"font-semibold text-gray-900 dark:text-gray-100",children:N(s)}),e.jsx("dd",{className:"mt-1 pl-4",children:O(p.sublist,`${c}-sublist`)})]},c)}const m=Object.entries(p);if(m.length>0){const[s,o]=m[0];return e.jsxs("div",{className:"mt-2",children:[e.jsx("dt",{className:"font-semibold text-gray-900 dark:text-gray-100",children:N(s)}),e.jsx("dd",{className:"mt-1 pl-4 text-gray-700 dark:text-gray-300",children:typeof o=="string"?N(o):Array.isArray(o)?O(o,`${c}-list`):String(o)})]},c)}}return e.jsxs("div",{className:"mt-2 text-red-600 dark:text-red-400",children:[e.jsx("dt",{children:"Invalid definition item"}),e.jsx("dd",{className:"pl-4 text-sm",children:JSON.stringify(u)})]},c)})},j(r,n));case"table":{const u=r.headers&&Array.isArray(r.headers)&&r.headers.length>0;return r.rows&&Array.isArray(r.rows)&&r.rows.length>0?e.jsx("div",{className:"my-6 w-full overflow-auto rounded-md border border-gray-200 dark:border-gray-700",children:e.jsxs(ce,{children:[u&&e.jsx(me,{children:e.jsx(I,{children:r.headers.map((c,p)=>e.jsx(ge,{children:N(c)},`${j(r,n)}-header-${p}`))})}),e.jsx(he,{children:r.rows.map((c,p)=>e.jsx(I,{children:c.map((m,s)=>e.jsx(pe,{children:typeof m=="string"?N(m):String(m)},`${j(r,n)}-cell-${p}-${s}`))},`${j(r,n)}-row-${p}`))})]})},j(r,n)):e.jsx("div",{className:"text-red-500 my-4",children:"Invalid table: missing rows"},j(r,n))}case"code":return e.jsx("div",{className:"my-4",children:e.jsx(ue,{language:r.language,value:g||"",showLineNumbers:!0})},j(r,n));case"note":return e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 my-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-blue-500 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-blue-800 dark:text-blue-200",children:N(g)})]})},j(r,n));case"warning":return e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 my-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"w-5 h-5 text-yellow-500 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-yellow-800 dark:text-yellow-200",children:N(g)})]})},j(r,n));case"clinical_pearl":return e.jsx(F.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/30 dark:to-indigo-950/30 border-l-4 border-primary rounded-lg p-4 my-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-gray-800 dark:text-gray-200",children:N(g)})]})},j(r,n));case"markdown":return e.jsx("div",{className:"my-4 prose dark:prose-invert prose-headings:scroll-mt-8 max-w-none",children:N(g)},j(r,n));case"document":return e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg p-4 my-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ee,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-gray-800 dark:text-gray-200",children:N(g)})]})},j(r,n));default:return console.warn(`Unknown block type: ${r.type||"undefined"}`,r),g?e.jsxs("div",{className:"p-4 border border-amber-200 dark:border-amber-800 rounded-lg bg-amber-50 dark:bg-amber-900/20 my-4",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(L,{className:"w-5 h-5 text-amber-500 flex-shrink-0"}),e.jsxs("p",{className:"text-amber-700 dark:text-amber-300 text-sm font-medium",children:["Unknown content type: ",r.type||"undefined"]})]}),e.jsx("div",{className:"text-gray-800 dark:text-gray-200 mt-2",children:N(g)})]},j(r,n)):e.jsxs("div",{className:"p-4 border border-amber-200 dark:border-amber-800 rounded-lg bg-amber-50 dark:bg-amber-900/20 my-4",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(L,{className:"w-5 h-5 text-amber-500 flex-shrink-0"}),e.jsx("p",{className:"text-amber-700 dark:text-amber-300 text-sm font-medium",children:"Unknown content block structure"})]}),e.jsx("pre",{className:"mt-2 text-xs overflow-auto bg-amber-100 dark:bg-amber-900/40 p-2 rounded text-amber-800 dark:text-amber-200",children:JSON.stringify(r,null,2)})]},j(r,n))}}}function ye({filePath:t}){const[a,l]=v.useState(null),[h,r]=v.useState(null),[n,g]=v.useState(!0),[u,d]=v.useState(null);return v.useEffect(()=>{t&&(async()=>{var p;console.log("📖 JsonHandbookViewer loading:",t),g(!0),r(null),l(null),d(null);try{const m=await fetch(t);if(console.log("📄 Content response:",{status:m.status,ok:m.ok,contentType:m.headers.get("content-type")}),!m.ok)throw new Error(`Failed to load content: ${m.statusText}`);const s=await m.json();console.log("📄 Content structure:",{hasContent:!!s.content,contentIsArray:Array.isArray(s.content),contentLength:((p=s.content)==null?void 0:p.length)||0,hasDefaultSections:!!s.sections&&Array.isArray(s.sections),keys:Object.keys(s)});let o=[],w={};const f=x=>{if(typeof x=="string")return{type:"paragraph",text:x,id:`block-${Math.random().toString(36).substring(2,11)}`};const i={...x};return i.id||(i.id=`block-${Math.random().toString(36).substring(2,11)}`),i.list&&Array.isArray(i.list)&&(i.type=i.type||"list",i.items=i.list,delete i.list),i.type==="bullets"?i.type="list":i.type==="numbers"?i.type="numbers":i.type==="definitions"&&(i.type="definitions"),!i.text&&!i.content&&(typeof i.value=="string"?i.text=i.value:typeof i.body=="string"&&(i.text=i.body)),i.items&&!Array.isArray(i.items)&&(typeof i.items=="string"?i.items=i.items.split(/\r?\n/).filter(Boolean):(console.warn("Invalid items format:",i.items),i.items=[])),i},S=x=>{if(!x)return[];if(Array.isArray(x))return x.map(i=>f(i));if(typeof x=="string")return[f({type:"paragraph",text:x})];if(typeof x=="object"&&x!==null){if(x.list&&Array.isArray(x.list))return[f({type:"list",items:x.list})];if(x.type&&typeof x.type=="string")return[f(x)];const i=[];for(const y in x){const b=x[y];b!==null&&(Array.isArray(b)?i.push(f({type:y==="numbers"?"numbers":"list",items:b})):typeof b=="string"?i.push(f({type:"paragraph",text:b})):typeof b=="object"&&i.push(...S(b)))}if(i.length>0)return i}return[f({type:"code",text:JSON.stringify(x,null,2)})]};if(s.content&&Array.isArray(s.content)){o=s.content.map(f);const{content:x,...i}=s;w=i}else if(s.sections&&Array.isArray(s.sections)){s.sections.forEach((y,b)=>{o.push(f({type:"heading",level:2,text:y.title||"Untitled Section",id:`section-${b}`})),y.content&&(Array.isArray(y.content)?y.content.forEach($=>{o.push(...S($))}):typeof y.content=="string"?o.push(f({type:"paragraph",text:y.content,id:`paragraph-${b}`})):typeof y.content=="object"&&y.content!==null&&o.push(...S(y.content)))});const{sections:x,...i}=s;w=i}else if(s.bullets||s.numbers||s.definitions){[{key:"bullets",type:"list"},{key:"numbers",type:"numbers"},{key:"definitions",type:"definitions"}].forEach(({key:A,type:C})=>{if(s[A]){let E=s[A];typeof E=="string"&&(E=E.split(/\r?\n/).filter(Boolean)),Array.isArray(E)&&E.length>0&&o.push(f({type:C,items:E,id:`${A}-${Math.random().toString(36).substring(2,9)}`}))}});const{bullets:i,numbers:y,definitions:b,...$}=s;w=$}else if(Object.keys(s).length>0){const x=Object.keys(s).filter(i=>!["title","category","section","metadata","version","author"].includes(i));if(x.length>0){x.forEach(y=>{const b=s[y];if(o.push(f({type:"heading",level:2,text:y.charAt(0).toUpperCase()+y.slice(1).replace(/_/g," "),id:`section-${y}`})),typeof b=="string")o.push(f({type:"paragraph",text:b,id:`${y}-text`}));else if(Array.isArray(b)){const $=y.includes("number")||y.includes("steps")?"numbers":"list";o.push(f({type:$,items:b.map(A=>typeof A=="string"?A:JSON.stringify(A)),id:`${y}-list`}))}else if(typeof b=="object"&&b!==null)if(Object.keys(b).every($=>typeof b[$]=="string")){const $=Object.entries(b).map(([A,C])=>`${A}: ${C}`);o.push(f({type:"definitions",items:$,id:`${y}-definitions`}))}else{const $=Object.entries(b).map(([A,C])=>`**${A}**: ${C}`).join(`

`);o.push(f({type:"markdown",text:$,id:`${y}-obj`}))}});const i=["title","category","section","metadata","version","author"];w=Object.fromEntries(Object.entries(s).filter(([y])=>i.includes(y)))}}o.length===0&&(o=[f({type:"code",text:JSON.stringify(s,null,2),id:"raw-json"})]),console.log("✅ Content processed:",{contentBlocks:o.length,metadata:w}),l(o),d(w)}catch(m){console.error("❌ Error loading content:",m),r(m instanceof Error?m.message:"Failed to load content")}finally{g(!1)}})()},[t]),n?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(M,{className:"w-6 h-6 animate-spin text-primary"})}):h?e.jsx("div",{className:"p-4 rounded-lg bg-red-50 border border-red-200 text-red-700",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(H,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Error Loading Content"}),e.jsx("p",{className:"mt-1",children:h}),e.jsxs("p",{className:"mt-4 text-sm",children:["File path: ",e.jsx("code",{className:"bg-red-100 px-1 py-0.5 rounded",children:t})]})]})]})}):!a||a.length===0?e.jsx("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200 text-yellow-700",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(H,{className:"w-5 h-5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"No Content Available"}),e.jsx("p",{className:"mt-1",children:"The document appears to be empty or incorrectly formatted."}),e.jsxs("p",{className:"mt-4 text-sm",children:["File path: ",e.jsx("code",{className:"bg-yellow-100 px-1 py-0.5 rounded",children:t})]})]})]})}):e.jsx(fe,{content:a})}const J="/public",V={"medical-oncology":"medical_oncology_handbook","radiation-oncology":"radiation_handbook","palliative-care":"palliative_handbook"};function _(t){const a=V[t];if(!a)throw new Error(`Invalid handbook section: ${t}`);return a}function be(t){const a=_(t);return`${J}/${a}/toc.json`}function je(t,a){const l=_(t),h=`${J}/${l}`;if(!a)return`${h}/overview.json`;const r=a.replace(/^\/+|\/+$/g,"").replace(/\.json$|\.md$/,""),n=`${h}/${r}.json`;return console.log(`📄 getContentPath generated: ${n} from topic: ${a}`),n}function P(t){return t in V}function Ne(t){if(console.log("🔍 parseHandbookPath input:",t),!t.startsWith("/handbook"))return console.log("❌ Not a handbook path"),{};const a=t.split("/").filter(Boolean);if(a.shift(),a.length===0)return console.log("ℹ️ No section found"),{};const l=a[0],h=a.slice(1).join("/");return console.log("✅ Parsed path:",{section:l,topic:h}),{section:l||void 0,topic:h||void 0}}function ve(t,a){const[l,h]=v.useState(null),[r,n]=v.useState(null),[g,u]=v.useState(!0),[d,c]=v.useState(null);return v.useEffect(()=>{(async()=>{console.log("📚 useHandbookData loading:",{section:t,topic:a}),u(!0),c(null),h(null),n(null);try{if(!t){console.log("ℹ️ No section provided, skipping load"),u(!1);return}if(!P(t)){console.warn("⚠️ Invalid section:",t),c(new Error(`Invalid handbook section: ${t}`)),u(!1);return}const m=be(t);console.log("📑 Loading TOC from:",m);try{const s=await fetch(m);if(!s.ok)throw new Error(`Failed to load TOC: ${s.statusText}`);const o=await s.json();if(!Array.isArray(o))throw new Error(`Invalid TOC format: Expected an array but got ${typeof o}`);console.log("📑 TOC loaded successfully with",o.length,"entries"),h(o)}catch(s){throw console.error("❌ Error loading TOC:",s),new Error(`Failed to load handbook navigation: ${s instanceof Error?s.message:"Unknown error"}`)}if(a){const s=je(t,a);console.log("📄 Content path:",s),n(s)}else console.log("ℹ️ No topic provided, skipping content load")}catch(m){console.error("❌ Error in useHandbookData:",m),c(m instanceof Error?m:new Error("Failed to load handbook data"))}finally{u(!1)}})()},[t,a]),{tocData:l,activeFile:r,isLoading:g,error:d,isValidSection:t?P(t):!1}}function ke(t){if(t instanceof Error)return{message:t.message,stack:t.stack,code:"ERROR"};if(t&&typeof t=="object"){const a=t;return{message:typeof a.message=="string"?a.message:"Unknown error",code:typeof a.code=="string"?a.code:"UNKNOWN",pageViewId:typeof a.pageViewId=="string"?a.pageViewId:"unknown",stack:typeof a.stack=="string"?a.stack:void 0}}return{message:String(t),code:"UNKNOWN"}}const we=[{id:"medical-oncology",title:"Medical Oncology",description:"Clinical oncology chapters, diagnosis, treatment, supportive care, emergencies, and reference tools.",icon:R},{id:"radiation-oncology",title:"Radiation Oncology",description:"Detailed protocols for radiation therapy, treatment planning, dosimetry, and management of radiation-related effects.",icon:T},{id:"palliative-care",title:"Palliative Care",description:"Guidelines for symptom management, pain control, and improving quality of life for patients with advanced cancer.",icon:T}],Ee=()=>{var m,s;const t=W(),a=G(),{section:l,topic:h}=v.useMemo(()=>{const o=Ne(t.pathname);return console.log("📖 Parsed handbook path:",{...o,pathname:t.pathname}),o},[t.pathname]),{tocData:r,activeFile:n,isLoading:g,error:u,isValidSection:d}=ve(l,h),c=v.useMemo(()=>l?we.find(o=>o.id===l):void 0,[l]),p=v.useCallback((o,w)=>{try{console.log("🔍 Navigation request:",{selectedSection:o,selectedTopic:w});const f=w.replace(/^\/+|\/+$/g,"").replace(/\.json$|\.md$/,""),S=`/handbook/${o}/${f}`;a(S)}catch(f){console.error("❌ Navigation error:",f)}},[a]);return t.pathname==="/handbook"?e.jsx(ie,{}):l&&!d?e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"text-red-500 p-4 rounded-lg bg-red-50 border border-red-200",children:["Invalid handbook section: ",l]})}):e.jsxs("div",{className:"flex h-full bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:to-slate-800",children:[g?e.jsx("div",{className:"w-80 flex-shrink-0 flex items-center justify-center p-6",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-primary"})}):u?e.jsx("div",{className:"w-80 flex-shrink-0 p-6",children:e.jsx("div",{className:"text-red-500 p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:typeof u=="string"?u:ke(u).message})}):e.jsx(le,{section:l,tocData:r||[],activeTopicId:h?`${l}/${h}`:l,onTopicClick:p}),e.jsx("div",{className:"flex-1 p-8 overflow-y-auto min-h-screen",id:"handbook-content-area",children:e.jsx(ae,{children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 print:hidden",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:h?(s=(m=h.split("/").pop())==null?void 0:m.replace(/-/g," "))==null?void 0:s.replace(".json",""):(c==null?void 0:c.title)||"Handbook"}),e.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-3 py-1.5 text-sm\r bg-white dark:bg-slate-800 \r text-gray-700 dark:text-gray-300\r border border-gray-200 dark:border-gray-700\r rounded-lg shadow-sm hover:bg-gray-50 dark:hover:bg-slate-700\r transition-colors",children:[e.jsx("span",{role:"img","aria-label":"Print",className:"mr-1",children:"🖨️"})," Print"]})]}),e.jsx(Y,{moduleName:"AI Handbook",children:e.jsx(ye,{filePath:n})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-medium text-muted-foreground",children:"Select a topic from the sidebar to view its content."}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:["You are currently in the ",e.jsx("span",{className:"font-semibold",children:(c==null?void 0:c.title)||"Handbook"})," section."]})]})})})]})};export{Ee as H};
//# sourceMappingURL=module-handbook-BYlPaKmT.js.map
